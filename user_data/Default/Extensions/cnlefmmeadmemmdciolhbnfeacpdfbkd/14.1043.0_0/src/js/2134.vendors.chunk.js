/*! For license information please see 2134.vendors.chunk.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[2134],{46560:(e,t,i)=>{i.d(t,{B:()=>r});var n=i(27378);const r=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.646 7.646a.5.5 0 0 1 .708 0L12 11.293l3.646-3.647a.5.5 0 0 1 .708.708L12.707 12l3.647 3.646a.5.5 0 0 1-.708.708L12 12.707l-3.646 3.647a.5.5 0 0 1-.708-.708L11.293 12 7.646 8.354a.5.5 0 0 1 0-.708Z",fill:"#646B81"}))},17579:(e,t,i)=>{i.d(t,{N:()=>r});var n=i(27378);const r=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 6a2 2 0 0 0-2 2v2h4V8a2 2 0 0 0-2-2Zm3 4V8a3 3 0 1 0-6 0v2H6.5a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5H15Zm-8 1v7h10v-7H7Z",fill:"#646B81"}))},93986:(e,t,i)=>{i.d(t,{z:()=>n});var n,r=i(27378),s=i(64757),o=i(76974),a=i(2844),l=i(77176),c=i(12187),u=i(44361),d=i(33498),m=i(95835),p=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){e.Primary=e=>{var{className:t,compact:i,theme:n,flatUI:h=o.of(!1),children:g,onClick:f,size:v=o.of("large"),style:y=o.of(void 0)}=e,b=p(e,["className","compact","theme","flatUI","children","onClick","size","style"]);return r.createElement(s.zx.Primary,Object.assign({},(0,c.Sh)(a.aj([(0,d.D)(h),(0,d.D)(y),(0,d.D)(v)]).pipe(l.U((([e,t,r])=>(0,m.P)({flatUI:e,compact:i,theme:null!=n?n:"light",size:r,type:"primary",style:t})))),t),b,{onClick:(0,u.m)(f)}),g)},e.Secondary=e=>{var{className:t,compact:i,theme:n,flatUI:h=o.of(!1),children:g,onClick:f,size:v=o.of("large"),style:y=o.of(void 0)}=e,b=p(e,["className","compact","theme","flatUI","children","onClick","size","style"]);return r.createElement(s.zx.Ghost,Object.assign({},(0,c.Sh)(a.aj([(0,d.D)(h),(0,d.D)(y),(0,d.D)(v)]).pipe(l.U((([e,t,r])=>(0,m.P)({flatUI:e,compact:i,theme:null!=n?n:"light",size:r,type:"secondary",style:t})))),t),b,{onClick:(0,u.m)(f)}),g)},e.Tertiary=e=>{var{className:t,compact:i,theme:n,flatUI:h=o.of(!1),children:g,onClick:f,size:v=o.of("large"),style:y=o.of(void 0)}=e,b=p(e,["className","compact","theme","flatUI","children","onClick","size","style"]);return r.createElement(s.zx.Tertiary,Object.assign({},(0,c.Sh)(a.aj([(0,d.D)(h),(0,d.D)(y),(0,d.D)(v)]).pipe(l.U((([e,t,r])=>(0,m.P)({flatUI:e,compact:i,theme:null!=n?n:"light",size:r,type:"tertiary",style:t})))),t),b,{onClick:(0,u.m)(f)}),g)}}(n||(n={}))},95835:(e,t,i)=>{i.d(t,{P:()=>p});var n=i(13578),r=i(62172),s=i(88392),o=i(9546),a=i(89894),l=i(94689),c=i(17430);const u="button",d=e=>({minWidth:a.ux.rem(e),minHeight:a.ux.rem(e),lineHeight:a.ux.rem(e)}),m=e=>{var t,i,m;const p=(t,i)=>{var n;return Object.assign({"& > i":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e.compact?{marginLeft:0}:{marginLeft:a.ux.rem(-.25)}),"small"===e.size?{minWidth:a.ux.rem(1.5)}:{}),"medium"===e.size?{minWidth:a.ux.rem(1.75)}:{}),"large"===e.size?{minWidth:a.ux.rem(2)}:{}),t),"&[data-disabled='true']":Object.assign({opacity:.4,cursor:"not-allowed"},null===(n=e.style)||void 0===n?void 0:n.disabled)},i)};return(0,l.to)(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({borderRadius:a.ux.rem(s.xB),fontSize:null!==(m=null===(i=null===(t=e.style)||void 0===t?void 0:t.base)||void 0===i?void 0:i.fontSize)&&void 0!==m?m:a.ux.rem(.75),textAlign:"center",padding:`0 ${a.ux.rem(o.x)}`,userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center"},e.compact?{padding:0}:{}),"small"===e.size?d(1.5):{}),"medium"===e.size?d(1.75):{}),"large"===e.size?d(2):{}),"primary"===e.type?((e,t)=>Object.assign(Object.assign({color:n.XY.Content.OnPrimary.Default,backgroundColor:c.Z.BrandGreen60,transitionProperty:"border, background, color",fontWeight:"bold"},null==t?void 0:t.base),{$nest:e((null==t?void 0:t.icon)||{},{"&:not([data-disabled='true'])":{$nest:{"&[data-hovered='true']":Object.assign({backgroundColor:c.Z.BrandGreen80},null==t?void 0:t.hovered),"&:focus-visible":Object.assign({boxShadow:`0 0 0 2px ${n.XY.Surface.Primary.Default}, 0 0 0 4px ${c.Z.BrandGreen80}`},null==t?void 0:t.focusVisible),"&[data-active='true'], &:active":Object.assign({backgroundColor:c.Z.BrandGreen60,color:n.XY.Surface.Primary.Default},null==t?void 0:t.active)}}})}))(p,e.style):{}),"secondary"===e.type?((e,t)=>Object.assign(Object.assign({backgroundColor:"transparent",fontWeight:"normal",color:r.BlueGray80,stroke:r.BlueGray80,boxShadow:`inset 0 0 0 1px ${r.BlueGray5}`,transitionProperty:"border, background, color"},null==t?void 0:t.base),{$nest:e(Object.assign({stroke:a.ux.important(r.BlueGray80),fill:a.ux.important(r.BlueGray80)},null==t?void 0:t.icon),{"&:not([data-disabled='true'])":{$nest:{"&[data-hovered='true']":Object.assign({backgroundColor:r.BlueGray0},null==t?void 0:t.hovered),"&:focus-visible":Object.assign({boxShadow:`inset 0 0 0 1px ${r.BlueGray80}, 0 0 0 1px ${r.BlueGray80}, 0 0 0 2px ${n.XY.Surface.Primary.Default}, 0 0 0 4px ${r.BlueGray80}`},null==t?void 0:t.focusVisible),"&[data-active='true'], &:active":Object.assign({backgroundColor:"transparent",color:r.BlueGray80},null==t?void 0:t.active)}}})}))(p,e.style):{}),"tertiary"===e.type?((e,t,i)=>Object.assign(Object.assign({backgroundColor:"transparent",fontWeight:"normal",color:n.XY.Content.Secondary.Default,transitionProperty:"border, background, color"},null==i?void 0:i.base),{$nest:t(Object.assign({stroke:a.ux.important(n.XY.Content.Secondary.Default),fill:a.ux.important(n.XY.Content.Secondary.Default)},null==i?void 0:i.icon),{"&:not([data-disabled='true'])":{$nest:Object.assign(Object.assign({"&[data-hovered='true']":Object.assign(Object.assign({backgroundColor:r.BlueGray0,color:n.XY.Content.Secondary.Default},e.flatUI?{boxShadow:`inset 0 0 0 1px ${c.Z.ButtonBorderTertiaryDefault}`,backgroundColor:c.Z.ButtonBackgroundTertiaryHover}:{}),null==i?void 0:i.hovered),"&[data-active='true'], &:active":Object.assign(Object.assign({backgroundColor:r.BlueGray0,color:n.XY.Content.Secondary.Default},e.flatUI?{boxShadow:`inset 0 0 0 1px ${c.Z.ButtonBorderTertiaryDefault}`,backgroundColor:c.Z.ButtonBackgroundTertiaryActive}:{}),null==i?void 0:i.active)},"dark"===e.theme?{"&[data-hovered='true'], &[data-active='true'], &:active":Object.assign({backgroundColor:a.ux.color(r.BlueGray0).toRGBA().fade(.2).toString()},null==i?void 0:i.active)}:{}),{"&:focus-visible":Object.assign({boxShadow:`0 0 0 2px ${n.XY.Surface.Primary.Default}, 0 0 0 4px ${n.XY.Content.Secondary.Default}`},null==i?void 0:i.focusVisible)})}})}))(e,p,e.style):{}),u,l._7)},p=e=>a.ux.joinClasses([u,a.ux.style(m(e))])},45578:(e,t,i)=>{i.d(t,{x:()=>h});var n=i(27378),r=i(31278),s=i(12187),o=i(93986),a=i(13578),l=i(89894),c=i(94689);const u="closeBtn",d="closeIcon",m=(0,c.dD)({$nest:{[`& .${d}`]:Object.assign(Object.assign({},(0,c.fx)(1.5)),{stroke:l.ux.important(a.S5.Content.Primary.Default)})}},u),p={closeButton:l.ux.joinClasses([u,l.ux.style(m)]),closeIcon:d},h=({name:e,className:t,size:i,onClick:a})=>n.createElement(o.z.Tertiary,Object.assign({},(0,s.Sh)(p.closeButton,t),{onClick:a,compact:!0,size:i,theme:"dark",name:e}),n.createElement(r.JO.Close,{className:p.closeIcon}))},31956:(e,t,i)=>{i.d(t,{d:()=>o});var n=i(27378),r=i(18208),s=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const o=n.forwardRef((function(e,t){var{children:i,rel:o}=e,a=s(e,["children","rel"]);const l=n.useMemo((()=>r.fg(10)),[]);return n.createElement(n.Fragment,null,n.createElement("span",{hidden:!0,id:l},"Opens an external site in a new window"),n.createElement("a",Object.assign({},a,{"aria-describedby":l,target:"_blank",rel:null!=o?o:"noopener noreferrer",ref:t}),i))}))},83538:(e,t,i)=>{i.d(t,{H:()=>u});var n=i(27378),r=i(89894),s=i(31278),o=i(12187),a=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const l=r.ux.keyframes({from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}),c=r.ux.style({animation:`${l} 1s linear infinite`,width:r.ux.rem(1),height:r.ux.rem(1),minWidth:r.ux.rem(1),minHeight:r.ux.rem(1)}),u=e=>{const{className:t}=e,i=a(e,["className"]);return n.createElement(s.a1,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},(0,o.Sh)(c,t),i),n.createElement("circle",{cx:"8",cy:"8",r:"5",stroke:"#C2C6D4",strokeWidth:"2"}),n.createElement("path",{d:"M13 8C13 8.76694 12.8236 9.5236 12.4844 10.2114C12.1452 10.8993 11.6523 11.4999 11.0438 11.9668C10.4354 12.4336 9.72765 12.7543 8.97545 12.9039C8.22325 13.0535 7.44671 13.0281 6.7059 12.8296",stroke:"#05735A",strokeWidth:"2",strokeLinecap:"round"}))}},27995:(e,t,i)=>{i.d(t,{J:()=>c});var n=i(27378),r=i(74204),s=i(13578),o=i(9546),a=i(89894),l=i(24351);const c=({reference:e,children:t,placement:i,offset:s,theme:o,boundaryAreaPadding:a})=>{var c,u;const[p,h]=n.useState(null),[g,f]=n.useState(null),v=(0,l.s)(),{styles:y,attributes:b,state:x}=(0,r.D)(e,p,{placement:null!=i?i:"top",modifiers:[{name:"offset",options:{offset:[0,12+(null!=s?s:0)]}},{name:"arrow",options:{element:g,padding:12}},{name:"preventOverflow",options:{padding:null!=a?a:5}},v]});return e?n.createElement("div",Object.assign({ref:h,style:y.popper},b.popper,{className:d(o)}),n.createElement("div",{ref:f,style:y.arrow,className:m(null==o?void 0:o.bgColor),"data-placement":(null===(c=null==x?void 0:x.placement)||void 0===c?void 0:c.startsWith("bottom"))?"bottom":(null==x?void 0:x.placement.startsWith("top"))?"top":(null==x?void 0:x.placement.startsWith("right"))?"right":(null===(u=null==x?void 0:x.placement)||void 0===u?void 0:u.startsWith("left"))?"left":void 0}),t):null},u=a.ux.keyframes({from:{opacity:0},to:{opacity:1}});function d(e){var t,i,n;return a.ux.style({animation:`${u} linear 0.1s`,background:null!==(t=null==e?void 0:e.bgColor)&&void 0!==t?t:s.S5.Surface.Primary.Default,borderRadius:a.ux.rem(o.x),width:null==e?void 0:e.width,color:null!==(i=null==e?void 0:e.fgColor)&&void 0!==i?i:s.S5.Content.Primary.Default,padding:null!==(n=null==e?void 0:e.padding)&&void 0!==n?n:a.ux.rem(o.mh),fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),display:"flex",flexDirection:"column",gap:a.ux.rem(o.yC),$nest:{"&[data-popper-reference-hidden='true']":{visibility:"hidden"}}})}function m(e=s.S5.Surface.Primary.Default,t=a.ux.rem(.5),i=a.ux.rem(-.5)){return a.ux.style({$nest:{"&[data-placement='bottom']":{top:i,borderLeft:`${t} solid transparent`,borderRight:`${t} solid transparent`,borderBottom:`${t} solid ${e}`},"&[data-placement='top']":{bottom:i,borderLeft:`${t} solid transparent`,borderRight:`${t} solid transparent`,borderTop:`${t} solid ${e}`},"&[data-placement='right']":{left:i,borderTop:`${t} solid transparent`,borderBottom:`${t} solid transparent`,borderRight:`${t} solid ${e}`},"&[data-placement='left']":{right:i,borderTop:`${t} solid transparent`,borderBottom:`${t} solid transparent`,borderLeft:`${t} solid ${e}`}}})}},32207:(e,t,i)=>{i.d(t,{n:()=>r});var n=i(27378);function r(){return n.useMemo((()=>({name:"forcePopperUpdateEffect",phase:"afterMain",enabled:!0,fn:()=>{},effect:({instance:e})=>{const t=setTimeout((()=>e.forceUpdate()),0);return()=>clearTimeout(t)}})),[])}},24351:(e,t,i)=>{i.d(t,{s:()=>n});const n=i(32207).n},24435:(e,t,i)=>{i.d(t,{F:()=>l});var n=i(27378),r=i(90845),s=i(80544),o=i(79692),a=i(60797);function l(e){const{ref:t,onMount:i}=r.P.useElWatcher(),l=n.useMemo((()=>t.pipe(s.QV(o.E),a.oA,e)),[t]);return r.P.useSubscriptionTo(l),{ref:t,onMount:i}}},42636:(e,t,i)=>{i.d(t,{Xy:()=>r,aU:()=>s,pY:()=>n});var n,r,s,o=i(31699),a=i(73975),l=i(45701),c=i(17889),u=i(57050),d=i(22232),m=i(8125),p=i(5114),h=i(87683),g=i(69693);!function(e){let t,i,n;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),function(e){e.create=function(e,t){return{id:e,kind:"string",value:t}}}(i=e.StringValue||(e.StringValue={})),function(e){e.create=function(e,t){return{id:e,kind:"radio",value:t}}}(n=e.RadioValue||(e.RadioValue={}))}(n||(n={})),function(e){e.match=e=>t=>{const i=t.kind;return"string"===i?e.string(t):"radio"===i?e.radio(t):void(0,d.L0)(i)}}(r||(r={})),function(e){function t(e){return"followUpQuestion"===e.kind}function i(e){return"quickAction"===e.kind}function r(e){return"skillAction"===e.kind}let s,d,f,v,y,b,x,k;e.isFollowUpQuestionActionValue=t,e.isQuickActionValue=i,e.isSkillActionValue=r,e.isListableActionValue=(0,m.Kg)(t,i,r),e.isUserPromptActionValue=function(e){return"userPrompt"===e.kind},e.isQuickRewriteActionValue=function(e){return"quickRewrite"===e.kind},e.isFollowUpQuestionActionInput=function(e){return"followUpQuestion"===e.kind},e.isQuickActionInput=function(e){return"quickAction"===e.kind},e.isSkillActionInput=function(e){return"skillAction"===e.kind},e.createFollowUpQuestionActionInputOrQuickActionInput=function(t,i,r,s){var a;const l=Array.from(new Set(i.map((e=>e.group)).filter((0,u.ff)(f.isPinned)))).findIndex((e=>t.group===e)),m=f.isPinned(t.group)?d.knownStores.pinned:d.knownStores.ideas,v={id:e.Id.create(t.id),iconUrl:t.iconUrl,store:{id:m,label:f.isPinned(t.group)?"":g.w.isQuickReply(r)?"Ways to reply":p.isSome(s)?`Work with: ${s.value}`:"Ideas for you",view:f.isPinned(t.group)?e.Store.View.pinned:e.Store.View.normal,rank:null!==(a=d.ranks[m])&&void 0!==a?a:Number.MAX_SAFE_INTEGER,maxCountBeforeClipping:g.w.isQuickReply(r)?p.none:p.some(3)},group:{id:f.Id.create(t.group),label:t.group,rank:l>-1?l:Number.MAX_SAFE_INTEGER},label:(0,o.sanitize)(t.label,{ALLOWED_TAGS:h.ap}),searchLabel:(0,o.sanitize)(t.label,{ALLOWED_TAGS:[]}),searchTags:t.searchTags,generatesTextType:p.fromNullable(t.generatesTextType)};if(1===t.args.length){const e=t.args[0],i={id:n.Id.create(e.name),label:e.label,hints:(0,u.zG)(p.fromNullable(e.hint),p.map((e=>({header:e.header,items:e.text}))))};return"string"===e.valueType?p.some(Object.assign(Object.assign({},v),{kind:"followUpQuestion",args:[Object.assign(Object.assign({},i),{kind:"string"})],generatesTextType:p.fromNullable(t.generatesTextType)})):"radioButtonGroup"===e.valueType?(0,u.zG)(e.radioButtonGroupValues,c.nI,p.map((e=>Object.assign(Object.assign({},v),{kind:"followUpQuestion",args:[Object.assign(Object.assign({},i),{kind:"radio",radioOptions:e})],generatesTextType:p.fromNullable(t.generatesTextType)})))):p.none}return 0===t.args.length?p.some(Object.assign(Object.assign({},v),{kind:"quickAction",args:[]})):p.none},function(e){e.create=function(e){return e},e.eq=a.yv}(s=e.Id||(e.Id={})),function(e){let t,i;!function(e){e.eq=a.yv}(t=e.Id||(e.Id={})),function(e){e.normal="normal",e.pinned="pinned"}(i=e.View||(e.View={})),e.knownStores={ideas:"ideas",pinned:"pinned",appActions:"app-actions"},e.ranks={[e.knownStores.ideas]:0,[e.knownStores.pinned]:1,[e.knownStores.appActions]:2}}(d=e.Store||(e.Store={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=a.yv}(t=e.Id||(e.Id={})),e.isPinned=function(e){return"pinned"===e}}(f=e.Group||(e.Group={})),function(e){e.fromTextInput=function(e,t){return Object.assign(Object.assign({},e),{args:[n.StringValue.create(e.args[0].id,t)]})},e.fromRadioInput=function(e,t){return Object.assign(Object.assign({},e),{args:[n.RadioValue.create(e.args[0].id,t)]})}}(v=e.FollowUpQuestionActionValue||(e.FollowUpQuestionActionValue={})),function(t){t.fromSkill=function(t,i){var n;const r=d.knownStores.appActions;return{kind:"skillAction",id:s.create(t.id),store:{id:r,label:"App actions",view:e.Store.View.normal,rank:null!==(n=d.ranks[r])&&void 0!==n?n:Number.MAX_SAFE_INTEGER,maxCountBeforeClipping:g.w.isQuickReply(i)?p.some(1):p.some(3)},group:{id:f.Id.create("app-actions"),label:"App actions",rank:Number.MAX_SAFE_INTEGER},iconUrl:t.iconUrl,label:(0,o.sanitize)(t.displayName,{ALLOWED_TAGS:h.ap}),searchLabel:(0,o.sanitize)(t.displayName,{ALLOWED_TAGS:[]}),searchTags:t.tags,generatesTextType:p.none,args:[],skill:t}}}(y=e.SkillActionInput||(e.SkillActionInput={})),function(e){e.ordByGroup=l.contramap((e=>e.group.rank))(l.ordNumber)}(b=e.ListableActionInput||(e.ListableActionInput={})),function(e){e.fromInput=function(e,t,i,r){return Object.assign(Object.assign({},e),{arg:n.StringValue.create(e.arg.id,t),useReferences:i,omitReferenceIds:r})}}(x=e.UserPromptActionValue||(e.UserPromptActionValue={})),function(e){e.fromInput=function(e){return Object.assign(Object.assign({},e),{args:[]})}}(k=e.QuickRewriteActionValue||(e.QuickRewriteActionValue={}))}(s||(s={}))},83289:(e,t,i)=>{i.d(t,{i:()=>n});var n,r=i(8125),s=i(22232);!function(e){let t;!function(e){e.mount="mount",e.unmount="unmount",e.headerCloseButtonClick="headerCloseButtonClick",e.headerGoBackButtonClick="headerGoBackButtonClick",e.headerVoiceButtonClick="headerVoiceButtonClick",e.setVoiceButtonClick="setVoiceButtonClick",e.voiceProfileCloseButtonClick="voiceProfileCloseButtonClick",e.voiceProfileUseVoiceButtonClick="voiceProfileUseVoiceButtonClick",e.toneToggleClick="toneToggleClick",e.styleToggleClick="styleToggleClick",e.roleTypeaheadSelectionChange="roleTypeaheadSelectionChange",e.dialectDropdownSelectionChange="dialectDropdownSelectionChange",e.promptFieldTextChange="promptFieldTextChange",e.promptFieldFocusChange="promptFieldFocusChange",e.promptFieldAndMenuFocusChange="promptFieldAndMenuFocusChange",e.actionBrickClick="actionBrickClick",e.promptSubmitButtonClick="promptSubmitButtonClick",e.generateStopButtonClick="generateStopButtonClick",e.promptFieldKeyPressEscape="promptFieldKeyPressEscape",e.promptFieldKeyPressEnter="promptFieldKeyPressEnter",e.promptFieldKeyPressArrowDown="promptFieldKeyPressArrowDown",e.promptFieldKeyPressArrowUp="promptFieldKeyPressArrowUp",e.promptMenuKeyPressArrowDown="promptMenuKeyPressArrowDown",e.promptMenuKeyPressArrowUp="promptMenuKeyPressArrowUp",e.resultCardInsertButtonClick="resultCardInsertButtonClick",e.resultCardRephraseButtonClick="resultCardRephraseButtonClick",e.resultCardDismissButtonClick="resultCardDismissButtonClick",e.resultCardToggleGenericVoiceButtonClick="resultCardToggleGenericVoiceButtonClick",e.errorCardOkButtonClick="errorCardOkButtonClick",e.openFeedbackFormButtonClick="openFeedbackFormButtonClick",e.feedbackFormChange="feedbackFormChange",e.feedbackFormSubmitButtonClick="feedbackFormSubmitButtonClick",e.reportOffensiveResultButtonClick="reportOffensiveResultButtonClick",e.reportOffensiveActionsButtonClick="reportOffensiveActionsButtonClick",e.resultCardHeaderClick="resultCardHeaderClick",e.collapsePromptMenuButtonClick="collapsePromptMenuButtonClick",e.creditsInfoHover="creditsInfoHover",e.creditsInfoClick="creditsInfoClick",e.resultCardHoverChange="resultCardHoverChange",e.resultCardFocusChange="resultCardFocusChange",e.resultCardCopy="resultCardCopy",e.reportMenuVisibilityChange="reportMenuVisibilityChange",e.referencesVisibilityChange="referencesVisibilityChange",e.voiceProfileTabChange="voiceProfileTabChange",e.voiceTagClick="voiceTagClick",e.voiceTagPopoverCloseButtonClick="voiceTagPopoverCloseButtonClick",e.voiceTagPopoverKeepButtonClick="voiceTagPopoverKeepButtonClick",e.voiceTagPopoverRemoveButtonClick="voiceTagPopoverRemoveButtonClick",e.applyVoiceToWritingCheckboxChange="applyVoiceToWritingCheckboxChange",e.voiceDialectDropdownSelectionChange="voiceDialectDropdownSelectionChange",e.voiceRoleDropdownSelectionChange="voiceRoleDropdownSelectionChange",e.voiceSelectionsSaveButtonClick="voiceSelectionsSaveButtonClick",e.voiceSelectionsCancelButtonClick="voiceSelectionsCancelButtonClick",e.voiceSelectionsEditButtonClick="voiceSelectionsEditButtonClick",e.surveyRatingSelectionChange="surveyRatingSelectionChange",e.surveyOpenAnswerChange="surveyOpenAnswerChange",e.surveySubmitButtonClick="surveySubmitButtonClick",e.surveyKeyPressShiftEnter="surveyKeyPressShiftEnter",e.surveyCancelButtonClick="surveyCancelButtonClick",e.surveyCloseButtonClick="surveyCloseButtonClick",e.regenerateWithoutReferenceButtonClick="regenerateWithoutReferenceButtonClick",e.restoreHistoryButtonClick="restoreHistoryButtonClick",e.userPromptSubmit="userPromptSubmit",e.radioOptionsSubmitButtonClick="radioOptionsSubmitButtonClick",e.radioOptionsCancelButtonClick="radioOptionsCancelButtonClick",e.removeSelectionContextClick="removeSelectionContextClick",e.selectionContextInteraction="selectionContextInteraction"}(t=e.Kind||(e.Kind={})),e.is=function(e){return t=>t.kind===e},e.isResultAction=(0,r.Kg)(e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.reportOffensiveResultButtonClick),e.is(e.Kind.regenerateWithoutReferenceButtonClick)),e.isSurveyAction=(0,r.Kg)(e.is(e.Kind.surveyOpenAnswerChange),e.is(e.Kind.surveySubmitButtonClick),e.is(e.Kind.surveyKeyPressShiftEnter),e.is(e.Kind.surveyCancelButtonClick),e.is(e.Kind.surveyCloseButtonClick),e.is(e.Kind.surveyRatingSelectionChange)),e.isSurveyImplicitDismissAction=(0,r.Kg)(e.is(e.Kind.promptSubmitButtonClick),e.is(e.Kind.actionBrickClick),e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.resultCardHeaderClick))}(n||(n={})),(0,s.L0)(void 0)},33148:(e,t,i)=>{i.d(t,{JS:()=>r});var n,r,s=i(69243),o=i(59502),a=i(73915),l=i(8125),c=i(79662);!function(e){e.Codec=s.OT(s.dt({action:s.OT(s.Z_)}))}(n||(n={})),function(e){let t,i,n;!function(e){e.Codec=s.OT(s.dt({action:s.OT(s.i0("error"))})),e.is=function(t){return e.Codec.is(t)}}(t=e.Error||(e.Error={})),function(e){e.Codec=s.OT(s.dt({action:s.OT(s.i0("show_survey"))})),e.is=function(t){return e.Codec.is(t)}}(i=e.ShowSurvey||(e.ShowSurvey={})),function(e){let t,i;!function(e){e.Codec=s.OT(s.dt({action:s.OT(s.i0("cheetah")),id:s.OT(s.pk)})),e.is=e.Codec.is}(t=e.CheetahAck||(e.CheetahAck={})),function(e){e.is=a.n(c.Pb.extend(o.Schemable)({any:o.id(),sensitiveString:o.string,sensitiveDelta:o.id()}))(c.Pb.ServerMessageImplementations).is}(i=e.CheetahProtocolServerMessage||(e.CheetahProtocolServerMessage={})),e.is=(0,l.Kg)(t.is,i.is)}(n=e.CheetahInboundCAPIMessage||(e.CheetahInboundCAPIMessage={})),e.is=function(e){return t.is(e)||i.is(e)||n.is(e)}}(r||(r={}));r.CheetahInboundCAPIMessage.is},27278:(e,t,i)=>{var n;i.d(t,{_:()=>n}),function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),e.isPending=function(e){return"pending"===e.kind},e.isReceived=function(e){return"received"===e.kind}}(n||(n={}))},819:(e,t,i)=>{i.d(t,{_:()=>n});var n,r=i(5114),s=i(57050),o=i(8125);!function(e){let t,i;function n(e){return e.kind===t.activeLimited||e.kind===t.activeUnlimited}function a(e){return e.kind===t.passive}function l(e){return e.kind===t.unknown}function c(e){return n(e)||l(e)}function u(i){if(void 0===i)return{kind:t.unknown,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}};const n=e.Active.parseRefillDate(i.usage.refillDate);return i.usage.promptsRemaining<0?{kind:t.unknown,userSettings:i.settings}:1e4===i.usage.promptsAllocated&&i.usage.promptsRemaining>0?{kind:t.activeUnlimited,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}:i.usage.promptsRemaining>0?{kind:t.activeLimited,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}:{kind:t.passive,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}}!function(e){e.activeLimited="activeLimited",e.activeUnlimited="activeUnlimited",e.passive="passive",e.unavailable="unavailable",e.disabled="disabled",e.pending="pending",e.unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){const t=(0,o.HP)((e=>{const t=Date.parse(e);return isNaN(t)?0:t}));function i(e){const t=e-Date.now();return Math.floor(t/36e5)}e.parseRefillDate=function(e){return t(e)},e.hoursUntilRefillDate=i,e.daysUntilRefillDate=function(e){return Math.floor(i(e)/24)}}(i=e.Active||(e.Active={})),e.isActive=n,e.isActiveUnlimited=function(e){return e.kind===t.activeUnlimited},e.isPassive=a,e.isActiveOrPassive=(0,o.Kg)(n,a),e.isUnknown=l,e.isUsable=c,e.isVisible=function(e){return c(e)||a(e)},e.isDisabled=function(e){return e.kind===t.disabled},e.isUnavailable=function(e){return e.kind===t.pending||e.kind===t.unavailable||e.kind===t.disabled},e.fromUserState=u,e.updateUsage=function(e,t){return u({usage:t,settings:e.userSettings})},e.getPromptsAllocated=function(t){return(0,s.zG)(t,r.fromPredicate(e.isActiveOrPassive),r.map((e=>e.promptsAllocated)))}}(n||(n={}))},98370:(e,t,i)=>{function n(e){return{kind:e.kind,source:e.source,name:e.name,jsonData:JSON.stringify(e.data)}}i.d(t,{L:()=>n})},89727:(e,t,i)=>{function n(e){return{kind:"error",source:"core",name:"assistantCloseFailed",data:e}}function r(e){return{kind:"error",source:"core",name:"unsanitizeTextOnInboundCAPIMessageFailed",data:e}}function s(e){return{kind:"error",source:"core",name:"sanitizeTextOnOutboundCAPIMessageFailed",data:e}}function o(){return{kind:"error",source:"core",name:"getContextFailed",data:null}}function a(){return{kind:"error",source:"core",name:"getHistoryFailed",data:null}}function l(e){return{kind:"error",source:"core",name:"actionFailed",data:e}}function c(e){return{kind:"error",source:"core",name:"waitForContextTimeout",data:e}}function u(){return{kind:"error",source:"core",name:"waitForHistoryTimeout",data:null}}function d(){return{kind:"error",source:"core",name:"waitForResultTimeout",data:null}}function m(e){return{kind:"error",source:"core",name:"waitForAckTimeout",data:e}}function p(e){return{kind:"error",source:"core",name:"setVoiceProfileFailed",data:e}}function h(e){return{kind:"error",source:"core",name:"setNewVoiceProfileFailed",data:e}}function g(e){return{kind:"error",source:"core",name:"capiErrorUnhandled",data:e}}function f(e){return{kind:"error",source:"core",name:"regenerateResultFailed",data:e}}function v(e){return{kind:"error",source:"core",name:"stopInProgressResultFailed",data:e}}function y(e){return{kind:"error",source:"core",name:"getTextFailed",data:e}}function b(e){return{kind:"error",source:"core",name:"reportUphookShowFailed",data:e}}function x(e){return{kind:"error",source:"core",name:"reportUphookClickFailed",data:e}}i.d(t,{$E:()=>o,Ax:()=>u,Jr:()=>h,Lp:()=>v,No:()=>m,TX:()=>p,Z9:()=>g,bE:()=>d,bS:()=>s,eM:()=>n,g0:()=>f,g4:()=>l,gW:()=>c,ix:()=>b,ol:()=>x,q_:()=>y,tD:()=>a,xe:()=>r})},4068:(e,t,i)=>{i.d(t,{H:()=>n});var n,r=i(5114),s=i(64015),o=i(17889),a=i(57050);!function(e){let t,i;e.fromOuterContext=function(e){var i,n,l,c;const u=e=>(0,a.zG)(r.fromNullable(null==e?void 0:e.from),r.chain(s.YM),r.fold((()=>t.empty),t.fromNameAndEmailString)),d=e=>(0,a.zG)(r.fromNullable(null==e?void 0:e.to),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[]))),m=(0,a.zG)(r.fromNullable(e.items),r.chain(s.YM),r.getOrElseW((()=>{})));return{previousMessageInfo:{author:u(null==m?void 0:m.people),directRecipients:d(null==m?void 0:m.people),text:null!==(i=null==m?void 0:m.text)&&void 0!==i?i:""},title:null!==(n=e.title)&&void 0!==n?n:"",author:u(e.people),directRecipients:d(e.people),indirectRecipients:(0,a.zG)(r.fromNullable(null===(l=e.people)||void 0===l?void 0:l.cc),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[]))),undisclosedRecipients:(0,a.zG)(r.fromNullable(null===(c=e.people)||void 0===c?void 0:c.bcc),r.chain(o.c2),r.map(o.UI(t.fromNameAndEmailString)),r.getOrElseW((()=>[])))}},e.toOuterContext=function(t){return{title:t.title,people:{from:[e.Person.extractNameAndEmailString(t.author)],to:t.directRecipients.map(e.Person.extractNameAndEmailString),cc:t.indirectRecipients.map(e.Person.extractNameAndEmailString),bcc:t.undisclosedRecipients.map(e.Person.extractNameAndEmailString)},items:[{text:t.previousMessageInfo.text,people:{from:[e.Person.extractNameAndEmailString(t.previousMessageInfo.author)],to:t.previousMessageInfo.directRecipients.map(e.Person.extractNameAndEmailString)}}]}},e.empty={previousMessageInfo:{author:{name:"",email:""},directRecipients:[],text:""},title:"",author:{name:"",email:""},directRecipients:[],indirectRecipients:[],undisclosedRecipients:[]},function(e){e.empty={name:"",email:""},e.fromNameAndEmailString=function(t){return(0,a.zG)(r.fromNullable(t.match(/^([^<]*)<(.*)>$/)),r.map((e=>{var t,i,n,r;return{name:null!==(i=null===(t=e[1])||void 0===t?void 0:t.trim())&&void 0!==i?i:"",email:null!==(r=null===(n=e[2])||void 0===n?void 0:n.trim())&&void 0!==r?r:""}})),r.getOrElse((()=>e.empty)))},e.extractNameAndEmailString=function(e){const t=""!==e.email?`<${e.email}>`:"";return[e.name,t].filter((e=>""!==e)).join(" ")}}(t=e.Person||(e.Person={})),function(e){e.empty={author:{name:"",email:""},directRecipients:[],text:""}}(i=e.PreviousMessageInfo||(e.PreviousMessageInfo={}))}(n||(n={}))},14047:(e,t,i)=>{i.d(t,{x:()=>n});var n,r=i(73975),s=i(5114),o=i(64015),a=i(17889),l=i(57050),c=i(8709),u=i(8125),d=i(95195),m=i(65602),p=i(3299);!function(e){let t,i,n,h,g,f,v;function y(e){return"complete"===e.kind}function b(e){return"history"===e.kind}function x(e){return"inProgressOngoing"===e.kind}function k(e){return"inProgressPending"===e.kind}!function(e){e.create=function(e){return`${e}`},e.toPrimitive=function(e){return parseInt(e,10)},e.eq=r.yv}(t=e.Id||(e.Id={})),function(e){e.insert="insert",e.reportOffensive="reportOffensive"}(i=e.Feedback||(e.Feedback={})),function(e){e.insert="insert",e.copy="copy"}(n=e.PrimaryAction||(e.PrimaryAction={})),e.hasId=function(e){return"id"in e},e.isComplete=y,e.isHistory=b,e.isAIUsageNotification=function(e){return"aiUsageNotification"===e.kind},e.isStandardCompletedResult=(0,u.Kg)(y,b),e.isInProgressOngoing=x,e.isInProgressPending=k,e.isInProgressInterrupted=function(e){return"inProgressInterrupted"===e.kind},e.isInProgress=(0,u.Kg)(x,k),function(e){e.generic="generic",e.user="user"}(h=e.GeneratedTextVoice||(e.GeneratedTextVoice={})),function(t){t.createFromResultMessage=function(t){return(0,l.zG)(t.withVoiceText,(i=>{var n;const r=(0,l.zG)((0,m.DO)(null===(n=t.text)||void 0===n?void 0:n.delta),s.getOrElse((()=>new c.i)));return(0,l.zG)((0,m.DO)(null==i?void 0:i.delta),d.fromOption((()=>r)),d.map((i=>({generic:r,user:i,preferVoice:!0===(null==t?void 0:t.showVoiceTextByDefault)?e.GeneratedTextVoice.user:e.GeneratedTextVoice.generic}))))}))}}(g=e.ResultDelta||(e.ResultDelta={})),function(t){t.createFromCard=function(t){return{kind:"history",id:e.Id.create(t.id),header:"action"===t.title.kind?{label:t.title.label,iconUrl:""!==t.title.iconUrl.trim()?s.some(t.title.iconUrl):s.none,copiablePrompt:s.none}:{label:t.title.text,iconUrl:s.none,copiablePrompt:""!==t.title.text.trim()?s.some(t.title.text):s.none},replacementDelta:g.createFromResultMessage({text:t.text,withVoiceText:t.text.plain===t.withVoiceText.plain?void 0:t.withVoiceText,showVoiceTextByDefault:t.text.plain===t.withVoiceText.plain?void 0:t.showVoiceTextByDefault}),primaryAction:s.some(e.PrimaryAction.insert),references:(0,l.zG)(t.references,o.UI(p.s.create),a.c2)}}}(f=e.History||(e.History={})),function(e){e.fromInProgressResult=function(e,t){return Object.assign(Object.assign({},e),{kind:"aiUsageNotification",text:t})}}(v=e.AIUsageNotification||(e.AIUsageNotification={}))}(n||(n={}))},7903:(e,t,i)=>{i.d(t,{z:()=>n});var n,r=i(5114);!function(e){let t,i;!function(e){e.restoreDisabled="restoreDisabled",e.unknown="unknown",e.hasHistory="hasHistory",e.noHistory="noHistory",e.historyRequested="historyRequested",e.historyRestored="historyRestored"}(t=e.HistoryStatus||(e.HistoryStatus={})),e.toStarting=function(e){return"starting"===e.kind?r.some(e):r.none},e.toStarted=function(e){return"started"===e.kind?r.some(e):r.none},e.isStartedWithInProgressResult=function(e){return"started"===e.kind&&r.isSome(e.inProgressResult)},function(e){e.initial={kind:"starting",mode:"ideation",selectedRange:r.none,selectedText:r.none,quickReplyContext:r.none,historyStatus:t.unknown,writingExpertContext:r.none,error:r.none,textRevision:0}}(i=e.Starting||(e.Starting={}))}(n||(n={}))},69693:(e,t,i)=>{i.d(t,{w:()=>n});var n,r=i(8125);!function(e){function t(e){return"rewrite"===e}function i(e){return"quickRewrite"===e}e.isIdeation=function(e){return"ideation"===e},e.isRewrite=t,e.isQuickReply=function(e){return"quickReply"===e},e.isQuickRewrite=i,e.isPushRewrite=function(e){return"pushRewrite"===e},e.isRewriteOrQuickRewrite=(0,r.Kg)(t,i)}(n||(n={}))},99877:(e,t,i)=>{var n,r;i.d(t,{e:()=>n,n:()=>r}),function(e){e.initialActionsList="initialActionsList",e.followUpActionsList="followUpActionsList",e.creditsInfoButton="creditsInfoButton",e.promptInput="promptInput",e.promptInputAndMenuContainer="promptInputAndMenuContainer",e.promptMenuContent="promptMenuContent",e.skill="skill",e.referencesList="referencesList",e.historyButton="historyButton"}(n||(n={})),function(e){e.initialPopupAnchor="initialPopupAnchor",e.initialBTSPopupAnchor="initialBTSPopupAnchor",e.rewriteTooltipAnchor="rewriteTooltipAnchor"}(r||(r={}))},42724:(e,t,i)=>{var n;i.d(t,{n:()=>n}),function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(n||(n={}))},79662:(e,t,i)=>{i.d(t,{Pb:()=>s});var n=i(71761),r=i(9090);const s=n;r.i},70367:(e,t,i)=>{i.d(t,{t:()=>x});var n=i(57050),r=i(14601),s=i(32952),o=i(85985),a=i(71032),l=i(12126),c=i(5114),u=i(62965),d=i(33148),m=i(98370),p=i(89727),h=i(36991),g=i(8709),f=i(65602),v=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};function y(e,t){return v(this,void 0,void 0,(function*(){const i=yield(0,n.zG)(e,f.DO,c.map((e=>Promise.all(e.ops.map((e=>h.s.isInsertString(e)?t(e.insert).then((t=>Object.assign(Object.assign({},e),{insert:t}))):e))))),c.getOrElse((()=>Promise.resolve([]))));return new g.i([...i])}))}var b=i(2735);class x{constructor(e){this._params=e,this._sub=new r.w,this._relevantInboundCAPIMessages=new s.xQ,this.relevantInboundCAPIMessages=this._relevantInboundCAPIMessages.asObservable(),this._sub.add(this._getRelevantInboundCAPIMessagesObs().subscribe(this._relevantInboundCAPIMessages))}cheetahGetContext(e){const t=(0,n.zG)(c.fromNullable(this._params.dlpOptions),c.map((({sanitizeText:t})=>function(e,t){return v(this,void 0,void 0,(function*(){const i=e=>v(this,void 0,void 0,(function*(){if(e)return(yield Promise.all(Object.keys(e).map((i=>Promise.all(e[i].map((e=>t(e)))).then((e=>({peopleKey:i,sanitizedPeopleValues:e}))))))).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.peopleKey]:t.sanitizedPeopleValues})),{})}));return void 0===e?Promise.resolve(e):(e.title?t(e.title):Promise.resolve(void 0)).then((n=>v(this,void 0,void 0,(function*(){return e.items?{sanitizedTitle:n,sanitizedItems:yield Promise.all(e.items.map((e=>t(e.text).then((i=>e.title?t(e.title).then((e=>({sanitizedItemText:i,sanitizedItemTitle:e}))):{sanitizedItemText:i,sanitizedItemTitle:void 0})).then((({sanitizedItemText:t,sanitizedItemTitle:n})=>v(this,void 0,void 0,(function*(){return{text:t,title:n,people:yield i(e.people)}})))))))}:{sanitizedTitle:n,sanitizedItems:void 0}})))).then((({sanitizedTitle:t,sanitizedItems:n})=>v(this,void 0,void 0,(function*(){return{title:t,items:n,people:yield i(e.people)}}))))}))}(e.outerContext,t))),c.getOrElse((()=>Promise.resolve(e.outerContext))));return(0,n.zG)(u.Y3((()=>t),(e=>new Error(JSON.stringify(e)))),u.Vn((e=>(this._params.monitoringService.notify((0,m.L)((0,p.bS)({capiMessageAction:"cheetah:getContext",rawError:(0,b.N)(e)}))),e))),u.tS((t=>this._params.sendCAPIMessage({action:"cheetah:getContext",data:Object.assign(Object.assign({},e),{outerContext:t}),shouldInjectRev:!0,shouldInjectSessionId:!1}))))}cheetahAction(e){const t=(0,n.zG)(c.fromNullable(this._params.dlpOptions),c.map((({sanitizeText:t})=>function(e,t){return v(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>t(e.value).then((t=>Object.assign(Object.assign({},e),{value:t}))))))}))}(e.args,t))),c.getOrElse((()=>Promise.resolve(e.args)))),i=(0,n.zG)(c.fromNullable(this._params.dlpOptions),c.map((({sanitizeText:t})=>function(e,t){return v(this,void 0,void 0,(function*(){return void 0===e?Promise.resolve(e):t(e.text).then((t=>Object.assign(Object.assign({},e),{text:t})))}))}(e.previousText,t))),c.getOrElse((()=>Promise.resolve(e.previousText))));return(0,n.zG)(u.Y3((()=>t),(e=>new Error(JSON.stringify(e)))),u.tS((e=>u.Y3((()=>i.then((t=>({sanitizedArgs:e,sanitizedPreviousText:t})))),(e=>new Error(JSON.stringify(e)))))),u.Vn((e=>(this._params.monitoringService.notify((0,m.L)((0,p.bS)({capiMessageAction:"cheetah:action",rawError:(0,b.N)(e)}))),e))),u.tS((({sanitizedArgs:t,sanitizedPreviousText:i})=>this._params.sendCAPIMessage({action:"cheetah:action",data:Object.assign(Object.assign({},e),{args:t,previousText:i}),shouldInjectRev:!0,shouldInjectSessionId:!1}))))}cheetahGetHistory(){return this._params.sendCAPIMessage({action:"cheetah:getHistory",shouldInjectRev:!1,data:{},shouldInjectSessionId:!1})}cheetahGetUserState(){return this._params.sendCAPIMessage({action:"cheetah:getUserState",data:{},shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahInterrupt(e){return this._params.sendCAPIMessage({action:"cheetah:interrupt",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSearchReferences(e){return this._params.sendCAPIMessage({action:"cheetah:searchReferences",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoice(e){return this._params.sendCAPIMessage({action:"cheetah:setVoice",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoiceProfile(e){return this._params.sendCAPIMessage({action:"cheetah:setVoiceProfile",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}user_action(e){return this._params.sendCAPIMessage({action:"user_action",data:e,shouldInjectRev:!1,shouldInjectSessionId:!0})}set_context(e){return this._params.sendCAPIMessage({action:"set_context",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}submit_survey_result(e){return this._params.sendCAPIMessage({action:"submit_survey_result",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}dispose(){this._sub.unsubscribe()}_getRelevantInboundCAPIMessagesObs(){const e=this._params.inboundCAPIMessages.pipe(o.h(d.JS.is));return(0,n.zG)(c.fromNullable(this._params.dlpOptions),c.fold((()=>e),(({unsanitizeText:t})=>e.pipe(a.b((e=>l.D((0,n.zG)(e,(e=>"cheetah:setContext"===e.action&&e.context.intent?function(e,t){return v(this,void 0,void 0,(function*(){return void 0===e.context.intent?Promise.resolve(e):t(e.context.intent).then((t=>Object.assign(Object.assign({},e),{context:Object.assign(Object.assign({},e.context),{intent:t})})))}))}(e,t):"cheetah:chunk"===e.action?function(e,t){return v(this,void 0,void 0,(function*(){return t(e.token).then((t=>Object.assign(Object.assign({},e),{token:t})))}))}(e,t):"cheetah:result"===e.action?function(e,t){return v(this,void 0,void 0,(function*(){const i=e.text;return(i?t(i.plain).then((e=>v(this,void 0,void 0,(function*(){return{unsanitizedTextPlain:e,unsanitizedTextDelta:yield y(i.delta,t)}})))):Promise.resolve({unsanitizedTextPlain:void 0,unsanitizedTextDelta:new g.i})).then((({unsanitizedTextPlain:i,unsanitizedTextDelta:n})=>v(this,void 0,void 0,(function*(){const r=e.withVoiceText;return r?{unsanitizedTextPlain:i,unsanitizedTextDelta:n,unsanitizedWithVoiceTextPlain:yield t(r.plain),unsanitizedWithVoiceTextDelta:yield y(r.delta,t)}:{unsanitizedTextPlain:i,unsanitizedTextDelta:n,unsanitizedWithVoiceTextPlain:void 0,unsanitizedWithVoiceTextDelta:new g.i}})))).then((({unsanitizedTextPlain:t,unsanitizedTextDelta:i,unsanitizedWithVoiceTextPlain:n,unsanitizedWithVoiceTextDelta:r})=>Object.assign(Object.assign({},e),{text:e.text?Object.assign(Object.assign({},e.text),{plain:null!=t?t:e.text.plain,delta:i}):void 0,withVoiceText:e.withVoiceText?Object.assign(Object.assign({},e.withVoiceText),{plain:null!=n?n:e.withVoiceText.plain,delta:r}):void 0})))}))}(e,t):Promise.resolve(e)),(t=>t.catch((t=>(this._params.monitoringService.notify((0,m.L)((0,p.xe)({capiMessageAction:e.action,rawError:(0,b.N)(t)}))),e))))))))))))}}},92627:(e,t,i)=>{i.d(t,{L:()=>p});var n=i(5114),r=i(57050),s=i(9922),o=i(85985),a=i(77176),l=i(60797),c=i(98403),u=i(38983),d=i(33148),m=i(819);class p{constructor(e,t){this._capiService=e,this._genAIFeaturesState=t,this._subs=new s.w.Keeper,this._availability=u.h.create({kind:m._.Kind.pending,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}}),this.availability=this._availability.view(),this._subs.push(this._genAIFeaturesState.subscribe((e=>this._availability.set(e.enabled?m._.fromUserState(e.userState):{kind:m._.Kind.unavailable,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}})))),this._subs.push((0,r.zG)(this._capiService.relevantInboundCAPIMessages,o.h(d.JS.CheetahInboundCAPIMessage.is),a.U((e=>"cheetah:setUserState"===e.action?n.some(e.state):n.none)),l.oA,a.U(m._.fromUserState)).subscribe(c.wW(this._availability))),this._subs.push((0,r.zG)(this._capiService.relevantInboundCAPIMessages,o.h(d.JS.CheetahInboundCAPIMessage.is),a.U((e=>{switch(e.action){case"cheetah:setContext":case"cheetah:result":return n.some(e.usage);default:return n.none}})),l.oA,a.U((e=>m._.updateUsage(this._availability.get(),e)))).subscribe(c.wW(this._availability)))}dispose(){this._subs.dispose()}}},63346:(e,t,i)=>{i.d(t,{W:()=>n});class n{constructor(e){this.namespace=e}static configureAllLoggers(e){n._isEnabled="prod"!==e.env}trace(e,t,i){this._printToConsole("trace",e,t,i)}warn(e,t,i){this._printToConsole("warn",e,t,i)}debug(e,t,i){this._printToConsole("debug",e,t,i)}info(e,t,i){this._printToConsole("info",e,t,i)}error(e,t,i){this._printToConsole("error",e,t,i)}fatal(e,t,i){this._printToConsole("fatal",e,t,i)}_getMsgWithNamespace(e){return`[${n._rootNamespace}.${this.namespace}]: ${e}`}_printToConsole(e,t,i,r){if("fatal"===e)return void console.error(t,i,r);if(!n._isEnabled)return;const s=this._getMsgWithNamespace(t);i&&r?console[e](s,i,r):!i&&r?console[e](s,r):i&&!r?console[e](s,i):console[e](s)}}n._rootNamespace="CheetahWeb",n._isEnabled=!1},35298:(e,t,i)=>{i.d(t,{j:()=>o});var n=i(14601),r=i(98403),s=i(38983);class o{constructor(e){this._hostAvailability=e,this._availability=s.h.create({contextUpdatesClient:!1,contextUpdatesServer:!1}),this.availability=this._availability.view(),this._sub=new n.w,this._sub=e.subscribe(r.wW(this._availability))}augment(e){this._sub.unsubscribe(),this._sub=e(this._hostAvailability).subscribe(r.wW(this._availability))}dispose(){this._sub.unsubscribe()}}},51216:(e,t,i)=>{i.d(t,{Z:()=>xe});var n,r=i(17771),s=i(64015),o=i(17889),a=i(62965),l=i(57050),c=i(28043),u=i(50628),d=i(84966),m=i(9922),p=i(98403),h=i(66310),g=i(55935),f=i(60797),v=i(66081),y=i(2834),b=i(40151),x=i(80900),k=i(5114),S=i(83078),C=i(22232),w=i(8125),_=i(38983),I=i(42636),E=i(27278),A=i(50687);!function(e){let t;function i(e){switch(e){case"sensitiveResult":return{header:"Assistance is unavailable",text:"Assistance is unavailable for that text or prompt.\nTry something else."};case"overload":return{header:"Couldn’t generate text",text:"We’re handling a lot of prompts right now and couldn’t generate that text.\nPlease try again later."};case"unsupportedLanguage":return{header:"Hmm, don’t know that language",text:"Assistance is currently only available for English."};case"critical":case"timeout":case"emptyResult":case"truncatedResult":case"usageExceeded":return{header:"Something went wrong",text:"We’re not sure what happened, but we couldn’t generate that text.\nPlease try again."};default:return(0,l.Rz)(e)}}!function(e){e.create=function(e){switch(e){case A.oS.Generic:return"critical";case A.oS.Overflow:return"truncatedResult";case A.oS.PromptsLimitExceeded:return"usageExceeded";case A.oS.SensitiveContent:return"sensitiveResult";case A.oS.ServerOverloaded:return"overload";case A.oS.UnsupportedLanguage:return"unsupportedLanguage";default:return(0,l.Rz)(e)}}}(t=e.Reason||(e.Reason={})),e.create=function(e){const n=t.create(e.kind),s=(0,l.zG)(r.Y(k.Applicative)({header:(0,l.zG)(k.fromNullable(e.title),k.filter((e=>""!==e.trim()))),text:(0,l.zG)(k.fromNullable(e.text),k.filter((e=>""!==e.trim())))}),k.getOrElse((()=>i(n))));return Object.assign({reason:n},s)},e.createCriticalError=function(e){return{reason:"critical",header:"Something went wrong",text:e?"We’re not sure what happened.\nPlease try again later.":"We’re not sure what happened, but we couldn’t generate that text.\nPlease try again."}},e.createEmptyResultError=function(){return Object.assign({reason:"emptyResult"},i("emptyResult"))}}(n||(n={}));var O=i(98370),R=i(89727);var U=i(14047),T=i(7903),B=i(69693);function P(e){return B.w.isRewriteOrQuickRewrite(e.mode)}function N(e){return B.w.isQuickReply(e.mode)}function z(e){return B.w.isPushRewrite(e.mode)}var G,j=i(95195),F=i(8709);!function(e){const t={"Cheetah/_System/Push/SimplifyRewrite":{copiablePrompt:k.none,iconUrl:k.some("https://assets.grammarly.com/cheetah/v1/actions/simplify.svg"),label:"Simplify your text"},"Cheetah/_System/Push/ImproveParagraph":{copiablePrompt:k.none,iconUrl:k.some("https://assets.grammarly.com/cheetah/v1/actions/improve.svg"),label:"Improve your text"}};e.toPreviousText=function(e){return(0,l.zG)(e,k.fromPredicate((e=>e.alertPname in t)),k.map((e=>({kind:"writerExpert",suggestionId:e.alertId,pname:e.alertPname,text:e.replacementText}))))},e.getInitialResult=function(e){const i=j.left((new F.i).insert(e.replacementText));return(0,l.zG)(k.fromNullable(t[e.alertPname]),k.map((t=>({kind:"complete",id:U.x.Id.create(0),header:t,replacementDelta:i,text:e.replacementText,references:k.none,source:k.none,changesSummary:k.none,timestamp:Date.now(),isRephraseable:!1,primaryAction:k.some(U.x.PrimaryAction.insert),boundaryContextId:k.none}))))}}(G||(G={}));var D=i(2735),M=i(26320),V=i(3299),L=i(41866),H=i(33305),K=i(33290);const $={CheetahFetchSkills:new K.Cc("cheetah_fetch_skills"),CheetahSelectionContextUpdates:new K.Cc("cheetah_selection_context_updates")};var W=i(63346),Z=i(30816),q=i(31699),Y=i(32426),X=i(4068),Q=i(65602),J=i(87683);const ee=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function te(e,t,i,n,r){let s,o,a,l,c,u,d,m,p,h,g,f,v;for(;r>=64;){for(s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=t[6],m=t[7],h=0;h<16;h++)g=n+4*h,e[h]=(255&i[g])<<24|(255&i[g+1])<<16|(255&i[g+2])<<8|255&i[g+3];for(h=16;h<64;h++)p=e[h-2],f=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,p=e[h-15],v=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,e[h]=(f+e[h-7]|0)+(v+e[h-16]|0);for(h=0;h<64;h++)f=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&d)|0)+(m+(ee[h]+e[h]|0)|0)|0,v=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&o^s&a^o&a)|0,m=d,d=u,u=c,c=l+f|0,l=a,a=o,o=s,s=f+v|0;t[0]+=s,t[1]+=o,t[2]+=a,t[3]+=l,t[4]+=c,t[5]+=u,t[6]+=d,t[7]+=m,n+=64,r-=64}return n}class ie{constructor(){this.digestLength=32,this.blockSize=64,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(let e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()}update(e,t=e.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let i=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[i++],t--;64===this.bufferLength&&(te(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(i=te(this.temp,this.state,e,i,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[i++],t--;return this}finish(e){if(!this.finished){const e=this.bytesHashed,t=this.bufferLength,i=e/536870912|0,n=e<<3,r=e%64<56?64:128;this.buffer[t]=128;for(let e=t+1;e<r-8;e++)this.buffer[e]=0;this.buffer[r-8]=i>>>24&255,this.buffer[r-7]=i>>>16&255,this.buffer[r-6]=i>>>8&255,this.buffer[r-5]=i>>>0&255,this.buffer[r-4]=n>>>24&255,this.buffer[r-3]=n>>>16&255,this.buffer[r-2]=n>>>8&255,this.buffer[r-1]=n>>>0&255,te(this.temp,this.state,this.buffer,0,r),this.finished=!0}for(let t=0;t<8;t++)e[4*t+0]=this.state[t]>>>24&255,e[4*t+1]=this.state[t]>>>16&255,e[4*t+2]=this.state[t]>>>8&255,e[4*t+3]=this.state[t]>>>0&255;return this}digest(){const e=new Uint8Array(this.digestLength);return this.finish(e),e}_saveState(e){for(let t=0;t<this.state.length;t++)e[t]=this.state[t]}_restoreState(e,t){for(let t=0;t<this.state.length;t++)this.state[t]=e[t];this.bytesHashed=t,this.finished=!1,this.bufferLength=0}}new Uint8Array(32);function ne(e,t){switch(e.historyStatus){case T.z.HistoryStatus.restoreDisabled:return e.historyStatus;case T.z.HistoryStatus.unknown:case T.z.HistoryStatus.noHistory:case T.z.HistoryStatus.hasHistory:return void 0!==t?t>0?T.z.HistoryStatus.hasHistory:T.z.HistoryStatus.noHistory:T.z.HistoryStatus.unknown;case T.z.HistoryStatus.historyRequested:case T.z.HistoryStatus.historyRestored:return"started"===e.kind&&void 0!==e.results.find(U.x.isHistory)?T.z.HistoryStatus.historyRestored:T.z.HistoryStatus.restoreDisabled;default:(0,C.L0)(e.historyStatus)}}function re(e,t=!1){return(0,l.zG)(e.replacementDelta,j.fold(l.yR,(({preferVoice:e,generic:i,user:n})=>t?e===U.x.GeneratedTextVoice.generic?i:n:i)),(e=>(0,Q.l)(e,"")))}function se(e){return a.fj((()=>"started"===e.kind?j.right(e):j.left(new Error("Session not started"))))}function oe(e,t,i,n){var r;const o=(0,l.zG)(T.z.toStarted(i),k.fold((()=>[]),(e=>e.voiceProfile.roles)));return{kind:"newVoiceProfile",userName:e.userName,title:e.title,subTitle:e.subTitle,profiles:e.profiles,isEnabledByDefault:e.myVoiceIsEnabledByDefault.state,isEnabledByDefaultLabel:e.myVoiceIsEnabledByDefault.label,dialects:H.L.Dialect.all(),roles:(0,l.zG)(null!==(r=t.roles)&&void 0!==r?r:[],s.UI((e=>({id:H.L.Role.Id.create(e),label:e}))),(e=>e.length>0?e:o)),selectedDialect:(0,l.zG)(T.z.toStarted(i),k.fold((()=>H.L.Dialect.Id.create(n)),(e=>e.voiceProfile.selectedDialect))),selectedRole:(0,l.zG)(k.fromNullable(t.selectedRole),k.map((e=>e.trim())),k.filter((e=>""!==e)),k.map(H.L.Role.Id.create)),needsSetup:!1}}function ae(e,t,i){var n,r;const o=(0,l.zG)(T.z.toStarted(t),k.map((e=>e.voiceProfile)),k.chain(H.L.toLegacyVoiceProfile),k.fold((()=>[]),(e=>e.styles))),a=(0,l.zG)(T.z.toStarted(t),k.fold((()=>[]),(e=>e.voiceProfile.roles))),c=(0,l.zG)(null!==(n=e.styles)&&void 0!==n?n:[],s.UI((e=>({id:H.L.Style.Id.create(e.button.label),label:e.button.label,iconUrl:e.button.iconUrl,tones:e.tones.map((e=>({id:H.L.Tone.Id.create(e.label),label:e.label,iconUrl:e.iconUrl,description:e.description}))),maxTones:e.maxTones,description:e.button.description}))),(e=>e.length>0?e:o)),u=H.L.Style.Id.create(e.selectedStyle),d=c.find((e=>H.L.Style.Id.eq.equals(e.id,u)));return{kind:"legacyVoiceProfile",styles:c,roles:(0,l.zG)(null!==(r=e.roles)&&void 0!==r?r:[],s.UI((e=>({id:H.L.Role.Id.create(e),label:e}))),(e=>e.length>0?e:a)),selectedStyle:u,selectedTonesPerStyle:(new Map).set(u,new Set(e.selectedTones.filter((e=>null==d?void 0:d.tones.map((e=>e.id.toString())).includes(e))))),selectedRole:(0,l.zG)(k.fromNullable(e.selectedRole),k.map((e=>e.trim())),k.filter((e=>""!==e)),k.map(H.L.Role.Id.create)),dialects:H.L.Dialect.all(),selectedDialect:(0,l.zG)(T.z.toStarted(t),k.fold((()=>H.L.Dialect.Id.create(i)),(e=>e.voiceProfile.selectedDialect))),needsSetup:e.needSetup}}function le(e,t,i,n){return[...(0,l.zG)(e,s.UI((t=>I.aU.createFollowUpQuestionActionInputOrQuickActionInput(t,e,i,n))),s.oA),...t.map((e=>I.aU.SkillActionInput.fromSkill(e,i)))]}function ce(e,t){const i=(0,l.zG)(e.args,s.YM,k.map((t=>({id:I.aU.Id.create(e.id),kind:"userPrompt",arg:{id:I.pY.Id.create(t.name),kind:"string",label:t.label,hints:(0,l.zG)(k.fromNullable(t.hint),k.map((e=>({header:e.header,items:e.text}))))},generatesTextType:k.some(A.cX.Insertable),useReferences:k.none,omitReferenceIds:k.none}))));return k.isNone(i)&&t.warn("_extractUserPromptAction() - failed to extract user prompt action, received empty action args",{promptAction:e}),i}function ue(e){return{kind:"quickRewrite",id:I.aU.Id.create(e.id),label:(0,q.sanitize)(e.label,{ALLOWED_TAGS:J.ap}),iconUrl:e.iconUrl,generatesTextType:k.fromNullable(e.generatesTextType)}}function de(e){return(0,l.zG)(k.fromNullable(e),k.map((e=>(0,q.sanitize)(e,{ALLOWED_TAGS:[...J.ap,"person"]}))),k.map((e=>e.trim())),k.filter((e=>e.length>0)))}function me(e){return{kind:U.x.isComplete(e)?"regular":U.x.isHistory(e)?"history":(0,C.L0)(e),text:re(e)}}const pe=k.fromNullable;function he(e){switch(e){case"ideation":return A.s2.Ideation;case"rewrite":return A.s2.Rewrite;case"quickRewrite":return A.s2.QuickRewrite;case"quickReply":return A.s2.QuickReply;case"pushRewrite":return A.s2.PushRewrite;default:return(0,C.L0)(e)}}function ge(e){const t=(0,l.zG)(e,k.fromPredicate((e=>function(e){return B.w.isIdeation(e.mode)}(e)&&!!e.documentUrl)),k.map((e=>e.documentUrl)),k.chain(k.fromNullable),k.chain(ve),k.map((e=>({pageIdHash:e})))),i=(0,l.zG)(e,k.fromPredicate(N),k.map((e=>X.H.toOuterContext(e.quickReplyContext))));return k.getMonoid((0,Y.getFirstSemigroup)()).concat(t,i)}function fe(e){return(0,l.zG)(e.quickReplyContext,k.map(X.H.toOuterContext))}function ve(e){var t;return(0,l.zG)(null!==(t=function(e){var t;return null===(t=e.match(/^https:\/\/docs.google.com\/[a-zA-Z0-9-_]+\/d\/([a-zA-Z0-9-_]+)/))||void 0===t?void 0:t[1]}(e))&&void 0!==t?t:function(e){var t;const i=null!==(t=e.match(/^https:\/\/([a-zA-Z0-9-_]+).atlassian.net\/wiki\/spaces\/[a-zA-Z0-9-_]+\/pages\/([0-9]+)/))&&void 0!==t?t:[];return i[1]&&i[2]?`${i[1]}:${i[2]}`:void 0}(e),k.fromNullable,k.map(ye))}function ye(e){const t=(new TextEncoder).encode(e);return Z.Buffer.from(function(e){const t=(new ie).update(e),i=t.digest();return t.clean(),i}(t)).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var be=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};class xe{constructor(e){var t,i,n,r,s;if(this._params=e,this._subs=new m.w.Keeper,this._session=_.h.create(T.z.Starting.initial),this._resultById=new Map,this._contextIdByResultId=new Map,this._contextById=new Map,this._historyResultIdByGetContextMessageId=new Map,this._contextMessageIdsTriggeredBySelectionChanges=new Set,this._stateBlobByContextId=new Map,this._initialReceivedContext=null,this._upstreamDialect=_.h.create(H.L.Dialect.Id.create("american")),this._cheetahAckIds=new Set,this._searchReferencesUrlsById=new Map,this._cheetahAckHandlers=new Array,this._resultTimeout=void 0,this._contextTimeout=void 0,this._historyTimeout=void 0,this._cheetahAckTimeout=void 0,this._historyAckHandler=void 0,this._skills=[],this._resultTimeoutMs=null!==(t=this._params.resultTimeoutMs)&&void 0!==t?t:2e4,this._contextTimeoutMs=null!==(i=this._params.contextTimeoutMs)&&void 0!==i?i:2e4,this._historyTimeoutMs=null!==(n=this._params.historyTimeoutMs)&&void 0!==n?n:2e4,this._cheetahAckTimeoutMs=null!==(r=this._params.cheetahAckTimeoutMs)&&void 0!==r?r:2e4,this._logger=null!==(s=this._params.logger)&&void 0!==s?s:new W.W(xe.name),this.session=this._session.view(),this._handleCAPIMessage=e=>{switch(e.action){case"error":return this._handleError(e);case"cheetah":return this._handleCheetahAck(e);case"cheetah:setContext":return this._handleCheetahSetContext(e);case"cheetah:chunk":return this._handleCheetahChunk(e);case"cheetah:result":return this._handleCheetahResult(e);case"cheetah:error":return this._handleCheetahError(e);case"cheetah:setUserState":return this._handleCheetahSetUserState(e);case"cheetah:searchReferencesResult":return this._handleCheetahSearchReferencesResult(e);case"cheetah:invalidateContext":return this._getContext();case"cheetah:setHistory":return this._handleCheetahSetHistory(e);case"show_survey":return;default:return(0,l.Rz)(e)}},P(this._params.startSessionOptions)){const e=this._params.textEditorService.selectedRange.get();(0,l.zG)(e,k.fold((()=>this._init()),(e=>(0,M.t)("getText",this._params.textEditorService.getText(e),this._logger,void 0,(t=>{this._logger.warn("getText() - failed to get text from host, defaulting to empty text",{selectedRange:e,error:t}),this._params.monitoringService.notify((0,O.L)((0,R.q_)({textRange:e,rawError:(0,D.N)(t)}))),this._init()})))))}else this._init()}_init(e){this._session.set({kind:"starting",mode:this._params.startSessionOptions.mode,selectedRange:k.fromNullable(null==e?void 0:e.selectedRange),selectedText:(0,l.zG)(k.fromNullable(null==e?void 0:e.selectedText),k.filter((e=>e.length>0))),quickReplyContext:k.fromNullable(N(this._params.startSessionOptions)?this._params.startSessionOptions.quickReplyContext:void 0),writingExpertContext:k.fromNullable(z(this._params.startSessionOptions)?this._params.startSessionOptions.writingExpertContext:void 0),historyStatus:T.z.HistoryStatus.unknown,error:k.none,textRevision:0}),this._subs.push(this._params.capiService.relevantInboundCAPIMessages.subscribe((e=>this._handleCAPIMessage(e)))),this._subs.push(this._params.userService.user.view("dialect").subscribe((e=>p.wW(this._upstreamDialect)(H.L.Dialect.Id.create(e))))),this._subs.push(this._upstreamDialect.subscribe((e=>this._handleUpstreamDialectChange(e)))),this._subs.push(this._session.subscribe((e=>this._logger.debug("Session updated:",e)))),this._subs.push(this._session.pipe((0,c.x)(((e,t)=>e.kind===t.kind)),(0,u.P)((e=>"started"===e.kind))).subscribe((()=>{this._params.trackingService.trackReadyToInteract()}))),this._params.selectionContextAvailability&&(this._subs.push(this._params.selectionContextAvailability.view("contextUpdatesClient").pipe(h.w((e=>e?this._params.textEditorService.selectedRange.pipe(g.T(1),f.oA,v.e(500),y.b((e=>{this._handleSelectedRangeUpdate(e)}))):b.E))).subscribe()),this._subs.push(this._params.selectionContextAvailability.view("contextUpdatesClient").pipe(h.w((e=>e?this._params.textEditorService.textUpdated.pipe(y.b((()=>{this._handleTextUpdated()}))):b.E))).subscribe())),this._startSession(this._params.startSessionOptions)}_startSession(e,t){(0,M.t)("flush",this._params.textEditorService.flush(),this._logger,(()=>{const i=P(e)?this._params.textEditorService.selectedRange.get():k.fromNullable(void 0),n=ge(e),s=k.fromNullable(z(e)?e.writingExpertContext:void 0),o={generationMode:he(e.mode),selectedRange:k.toUndefined(i),outerContext:k.toUndefined(n),stateBlob:t,metadata:e.metadata,previousText:(0,l.zG)(s,k.chain(G.toPreviousText),k.toUndefined)};if(this._params.skillService){const e={skills:this._params.skillService.getSkills(),shouldShowSkills:(0,l.zG)(this._params.experimentService?this._params.experimentService.isGateEnabled($.CheetahFetchSkills):a.F2(!1),a.Vn((e=>new Error(e))))};(0,M.t)("getSkills",r.Y(M.L)(e),this._logger,(({skills:e,shouldShowSkills:t})=>{t&&(this._skills=e,(0,l.zG)(T.z.toStarted(this._session.get()),k.filter((e=>!e.activeContext.availableActions.some((e=>"skillAction"===e.kind)))),S.bw((e=>this._session.set(Object.assign(Object.assign({},e),{activeContext:Object.assign(Object.assign({},e.activeContext),{availableActions:e.activeContext.availableActions.concat(this._skills.map((e=>I.aU.SkillActionInput.fromSkill(e,this._session.get().mode))))})}))))))}),(e=>this._params.monitoringService.notify((0,O.L)((0,L.YC)({rawError:(0,D.N)(e)})))))}this._getContext(o)}))}_handleSelectedRangeUpdate(e){this._logger.debug("_handleSelectedRangeUpdate()",{selectedRange:e}),(0,M.t)("getText",this._params.textEditorService.getText(e),this._logger,(t=>{t.length?(this._session.modify((i=>(0,l.zG)(i,T.z.toStarted,k.fold((()=>i),(i=>Object.assign(Object.assign({},i),{mode:"rewrite",activeContext:Object.assign(Object.assign({},i.activeContext),{kind:"pending",isBoundary:!0,textRevision:k.some(i.textRevision)}),selectedRange:k.some(e),selectedText:(0,l.zG)(k.some(t),k.filter((e=>e.length>0)))})))))),this._getContext(void 0,void 0,!0)):this._session.modify((t=>Object.assign(Object.assign({},t),{selectedRange:k.some(e),selectedText:k.none})))}))}_handleTextUpdated(){this._logger.debug("_handleTextUpdated()"),this._session.modify((e=>(0,l.zG)(e,T.z.toStarted,k.fold((()=>e),(e=>Object.assign(Object.assign({},e),{textRevision:e.textRevision+1}))))))}submitAction(e,t){this._logger.debug("submitAction()",{actionValue:e,selectedVoice:t}),this._submitAction(e,void 0,void 0,void 0,void 0,t)}setVoiceProfile(e){return this._logger.debug("setVoiceProfile()",{voiceProfileSelections:e}),(0,l.zG)(se(this._session.get()),a.UI((t=>(this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),e),activeContext:Object.assign(Object.assign({},t.activeContext),{kind:"pending"})})),t))),a.tS((t=>(0,l.zG)(this._params.capiService.cheetahSetVoice({voice:{selectedStyle:e.selectedStyle,selectedTones:Array.from(e.selectedTonesPerStyle.get(e.selectedStyle)||[]),selectedRole:(0,l.zG)(e.selectedRole,k.toUndefined),needSetup:!1}}),a.Pd((e=>new Error(`CAPIService.cheetahSetVoice error: ${e.message}`)),(()=>!H.L.Dialect.Id.eq.equals(t.voiceProfile.selectedDialect,e.selectedDialect))),a.tS((t=>t?r.g(a.qA)((0,l.zG)(this._params.capiService.set_context({documentContext:{dialect:e.selectedDialect}}),a.Vn((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,l.zG)(this._params.userService.setDialect(e.selectedDialect),a.Vn((e=>new Error(`CAPIService.setDialect error: ${e.message}`))))):a.of(null))),a.Pd((e=>(this._params.monitoringService.notify((0,O.L)((0,R.TX)({rawError:(0,D.N)(e)}))),e)),l.Q1)))))}setNewVoiceProfile(e){var{selectedDialect:t}=e,i=be(e,["selectedDialect"]);return this._logger.debug("setNewVoiceProfile()",{dialect:t,voiceProfile:i}),(0,l.zG)(se(this._session.get()),a.UI((e=>(this._session.set(Object.assign(Object.assign({},e),{activeContext:Object.assign(Object.assign({},e.activeContext),{kind:"pending"})})),e))),a.tS((e=>(0,l.zG)(this._params.capiService.cheetahSetVoiceProfile({role:(0,l.zG)(i.selectedRole,k.toUndefined),isEnabledByDefault:i.isEnabledByDefault,profiles:i.profiles}),a.Pd((e=>new Error(`CAPIService.cheetahSetVoice error: ${e.message}`)),(()=>!H.L.Dialect.Id.eq.equals(e.voiceProfile.selectedDialect,t))),a.tS((e=>e?r.g(a.qA)((0,l.zG)(this._params.capiService.set_context({documentContext:{dialect:t}}),a.Vn((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,l.zG)(this._params.userService.setDialect(t),a.Vn((e=>new Error(`CAPIService.setDialect error: ${e.message}`))))):a.of(null))),a.Pd((e=>(this._params.monitoringService.notify((0,O.L)((0,R.Jr)({rawError:(0,D.N)(e)}))),e)),l.Q1)))))}stopInProgressResult(){return this._logger.debug("stopInProgressResult()"),(0,l.zG)(this._session.get(),a.DT(T.z.isStartedWithInProgressResult,(()=>new Error("Session has no in-progress result."))),a.tS((e=>(this._clearResultRelatedTimeouts(),this._session.modify((t=>Object.assign(Object.assign({},t),{activeContext:(0,l.zG)(e.results.length>0?this._extractLatestResultContext(e):this._extractInitialContext(),k.getOrElse((()=>e.activeContext))),inProgressResult:U.x.isInProgressPending(e.inProgressResult.value)?k.some(Object.assign(Object.assign({},e.inProgressResult.value),{kind:"inProgressInterrupted"})):U.x.isInProgressInterrupted(e.inProgressResult.value)?e.inProgressResult:U.x.isInProgressOngoing(e.inProgressResult.value)?k.none:(0,C.L0)(e.inProgressResult.value)}))),(0,l.zG)(e.inProgressResult.value,k.fromPredicate(U.x.isInProgressOngoing),k.fold((()=>a.of(-1)),(e=>this._params.capiService.cheetahInterrupt({promptId:U.x.Id.toPrimitive(e.id)}))))))),a.Pd((e=>(this._params.monitoringService.notify((0,O.L)((0,R.Lp)({rawError:(0,D.N)(e)}))),e)),l.Q1))}regenerateResult(e,t,i){this._logger.debug("regenerateResult()",{resultId:e,options:t,selectedVoice:i}),(0,l.zG)(T.z.toStarted(this._session.get()),S.ew((()=>this._logger.warn("regenerateResult() - trying to regenerate result with a session that is not `started`, skipping",{session:this._session.get(),resultId:e}))),k.chain((t=>(0,l.zG)(k.fromNullable(this._resultById.get(e)),k.filter(U.x.isComplete),k.filter((e=>e.isRephraseable)),k.map((e=>({session:t,result:e}))),S.ew((()=>{this._logger.warn("regenerateResult() - could not find a rephraseable result for provided result ID, skipping",{session:t,resultId:e}),this._params.monitoringService.notify((0,O.L)((0,R.g0)({resultId:e,reason:"not-found"})))}))))),k.chain((({session:t,result:i})=>(0,l.zG)(r.Y(k.option)({resultSource:i.source,boundaryContextId:i.boundaryContextId}),k.map((({resultSource:e,boundaryContextId:n})=>({resultSource:e,boundaryContextId:n,resultText:re(i),session:t}))),S.ew((()=>{this._logger.warn("regenerateResult() - trying to regenerate result without source action or boundaryContext",{session:t,result:i}),this._params.monitoringService.notify((0,O.L)((0,R.g0)({resultId:e,reason:"no-source-action"})))}))))),k.map((({resultSource:n,boundaryContextId:r,resultText:s})=>{const a=n.actionValue,c=k.getMonoid(o.jG()).concat,u=(0,l.zG)(a,k.fromPredicate(I.aU.isUserPromptActionValue),k.fold((0,l.a9)(a),(e=>Object.assign(Object.assign({},e),{omitReferenceIds:c(e.omitReferenceIds,t.omitReferenceIds)})))),d=this._contextIdByResultId.get(e);void 0===d&&this._params.monitoringService.notify((0,O.L)({kind:"warn",source:"core",name:"regenerateResultContextNotFound",data:null})),this._submitAction(u,n.contextId,d,r,{kind:"regular",text:s},i),this._params.trackingService.trackResultRephrase(d)})))}searchReferences(e){const t=this._session.get();"started"===t.kind?t.detectedReferences.has(e)||(this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(e,k.none)})),this._setupCheetahAckHandler("searchReferences",(t=>{this._searchReferencesUrlsById.set(t,e)})),(0,M.t)("cheetahSearchReferences",this._params.capiService.cheetahSearchReferences({url:e}),this._logger)):this._logger.warn("searchReferences() - trying to search a reference with a session that is not `started`, skipping",{session:t})}dismissResult(e){this._logger.debug("dismissResult()",{resultId:e});const t=this._session.get();let i=null;if("started"===t.kind){if(this._resultById.delete(e)){const n=t.results.findIndex((t=>t.id===e));i=t.results[n];let r=t.activeContext,s=t.activeBoundaryContext,o=null;if(0===n&&t.results.length>1){this._logger.debug("dismissResult() - dismissing latest result, will try to restore context from previous result",{session:t,resultId:e});const i=k.toUndefined(this._extractPreviousResultContext(t)),n=(0,l.zG)(this._extractPreviousResultBoundaryContext(t),k.alt((()=>k.fromNullable(this._initialReceivedContext))),k.toUndefined),a=k.toUndefined(this._extractLatestResultBoundaryContext(t));i?n!==a?(this._logger.debug("dismissResult() - previous result was for different boundary context, will keep currently active boundary context",{session:t,resultId:e}),r=t.activeBoundaryContext):(this._logger.debug("dismissResult() - found context for previous result, will restore its context",{session:t,resultId:e,previousResultContext:i}),r=i,n&&(s=n)):t.results[1]&&U.x.isHistory(t.results[1])&&(0,l.zG)(k.fromNullable(this._contextIdByResultId.get(t.results[1].id)),k.chain((e=>k.fromNullable(this._contextById.get(e)))),k.isNone)?o=t.results[1].id:this._logger.warn("dismissResult() - could not find context for previous result, context will not be updated",{session:t,resultId:e})}else 1===t.results.length&&(r=t.activeBoundaryContext);this._session.set(Object.assign(Object.assign({},t),{activeContext:Object.assign(Object.assign({},r),{kind:null!==o?"pending":r.kind,availableActions:o?[]:r.availableActions}),activeBoundaryContext:s,results:t.results.filter((t=>!U.x.Id.eq.equals(t.id,e)))}));const a=this._contextIdByResultId.get(e);this._params.trackingService.trackResultDismiss(a,U.x.isHistory(i)?e:void 0),"aiUsageNotification"===i.kind&&this._params.trackingService.trackAINotificationDismiss("document"),o&&this._getContext(void 0,o)}else this._logger.warn("dismissResult() - could not find result for provided result ID, skipping",{session:t,resultId:e})}else this._logger.warn("dismissResult() - trying to dismiss result with a session that is not `started`, skipping",{session:t,resultId:e})}dismissError(){this._logger.debug("dismissError()"),this._session.lens("error").set(k.none)}restoreHistory(){this._getHistory()}trackResultInsert(e,t=!1){this._logger.debug("trackResultInsert()",{resultId:e});const i=this._resultById.get(e);if(i){const n=this._contextIdByResultId.get(e);this._params.trackingService.trackResultInsert(n,U.x.isHistory(i)?i.id:void 0,t)}else this._logger.warn("trackResultInsert() - could not find result for provided result ID, skipping",{resultId:e})}trackResultCopy(e){this._logger.debug("trackResultCopy()",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.trackingService.trackResultCopy(i,U.x.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultCopy() - could not find result for provided result ID, skipping",{resultId:e})}_trackResultGenerationCompleted(e){this._logger.debug("trackResultGenerationCompleted()",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.trackingService.trackResultGenerationCompleted(i,U.x.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultGenerationCompleted() - could not find result for provided result ID, skipping",{resultId:e})}trackResultOffensive(e){this._logger.debug("trackResultOffensive()",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.trackingService.trackResultOffensive(i,U.x.isHistory(t)?t.id:void 0)}else this._logger.warn("trackResultOffensive() - could not find result for provided result ID, skipping",{resultId:e})}trackActionsOffensive(){this._logger.debug("trackActionsOffensive()");const e=this._session.get();if("started"!==e.kind)return this._logger.warn("trackActionsOffensive() - tracking actions as offensive with a session that is not `started`, skipping");this._params.trackingService.trackActionsOffensive(e.activeContext.id)}getContextById(e){return k.fromNullable(this._contextById.get(e))}dismissActiveBoundaryContext(){if(this._logger.debug("dismissActiveBoundaryContext()"),(0,l.zG)(this._session.get(),T.z.toStarted,k.filter((e=>e.activeContext.id===e.activeBoundaryContext.id)),k.fold(l.W8,l.jv)))return this._logger.warn("dismissActiveBoundaryContext() - there are results within this boundary, can't remove");const e=k.toNullable((0,l.zG)(this._session.get(),T.z.toStarted,k.chain((e=>this._extractLatestResultContext(e))))),t=k.toNullable((0,l.zG)(this._session.get(),T.z.toStarted,k.chain((e=>this._extractLatestResultBoundaryContext(e))),k.alt((()=>this._extractInitialContext()))));this._session.modify((i=>(0,l.zG)(i,T.z.toStarted,k.fold((()=>i),(i=>e&&t?Object.assign(Object.assign({},i),{mode:i.results.length?i.mode:"ideation",activeContext:e,activeBoundaryContext:t}):Object.assign(Object.assign({},i),{kind:"starting",activeContext:Object.assign(Object.assign({},i.activeContext),{selection:k.none,kind:"pending"}),activeBoundaryContext:void 0,selectedRange:k.none,selectedText:k.none})))))),e&&t||this._getContext()}dispose(){this._subs.dispose()}_getContext(e,t,i=!1){this._logger.debug("_getContext()",{data:e,fetchContextForHistoryCardId:t}),this._setupCheetahAckHandler("getContext",(e=>{this._setupContextTimeout("getContext"),void 0!==t&&this._historyResultIdByGetContextMessageId.set(e,t),i&&this._contextMessageIdsTriggeredBySelectionChanges.add(e)}));const n=this._session.get();(0,M.t)("cheetahGetContext",this._params.capiService.cheetahGetContext(null!=e?e:{generationMode:he(i?"rewrite":n.mode),selectedRange:k.toUndefined(n.selectedRange),outerContext:k.toUndefined(fe(n)),stateBlob:(0,l.zG)(T.z.toStarted(n),k.map((e=>e.activeContext)),k.fold(l.r5,(e=>this._stateBlobByContextId.get(e.id)))),previousText:!i&&"started"===n.kind&&n.results.length>0&&U.x.isStandardCompletedResult(n.results[0])?me(n.results[0]):void 0}),this._logger,(()=>this._params.monitoringService.notify((0,O.L)({kind:"info",source:"core",name:"getContextSuccessful",data:null}))),(()=>this._params.monitoringService.notify((0,O.L)((0,R.$E)()))))}_handleCheetahSetContext(e){var t,i;this._logger.debug("_handleCheetahSetContext()",{message:e}),this._clearContextTimeout();const n=this._session.get(),s=(0,l.zG)(k.fromNullable(null===(t=e.context)||void 0===t?void 0:t.voiceProfileSettings),k.fold((()=>ae(e.context.voice,n,this._upstreamDialect.get())),(t=>oe(t,e.context.voice,n,this._upstreamDialect.get())))),o={id:E._.Id.create(e.context.id),availableActions:le(e.context.availableActions,this._skills,n.mode,n.selectedText),userPromptAction:ce(e.context.promptAction,this._logger),quickRewriteAction:ue(e.context.quickRewriteAction),intent:de(e.context.intent),documentOverview:pe(e.context.documentOverview),specialView:k.fromNullable(e.context.specialView),selection:this._historyResultIdByGetContextMessageId.has(e.promptId)?k.none:(0,l.zG)(r.Y(k.option)({text:n.selectedText,range:n.selectedRange})),textRevision:(null===(i=this._params.selectionContextAvailability)||void 0===i?void 0:i.get().contextUpdatesClient)?k.some(n.textRevision):k.none},a=0===this._contextById.size,c=e.progressMessage?Object.assign(Object.assign({},o),{kind:"pending",isBoundary:!1}):Object.assign(Object.assign({},o),{kind:"received",isBoundary:a||this._contextMessageIdsTriggeredBySelectionChanges.has(e.promptId)});if(this._shouldSkipContextUpdate(e))return void this._logger.debug("skipping context update for missing history card");0===this._contextById.size&&E._.isReceived(c)&&(this._initialReceivedContext=c),this._contextById.set(c.id,c),this._stateBlobByContextId.set(c.id,e.context.stateBlob),this._bindContextToHistoryCardIfNeeded(e,c.id);const u=(0,l.zG)(n.writingExpertContext,k.chain(G.getInitialResult),S.bw((e=>{this._resultById.set(e.id,e),this._contextIdByResultId.set(e.id,c.id)})),k.fold((()=>[]),(e=>[e])));if(this._session.set(Object.assign(Object.assign({},n),{kind:"started",voiceProfile:s,activeContext:c,inProgressResult:"started"===n.kind?n.inProgressResult:k.none,results:"started"===n.kind?n.results:u,detectedReferences:"started"===n.kind?n.detectedReferences:new Map,activeBoundaryContext:c.isBoundary?c:"started"===n.kind?n.activeBoundaryContext:c})),a&&B.w.isQuickRewrite(n.mode)){const t=I.aU.QuickRewriteActionValue.fromInput(ue(e.context.quickRewriteAction));this._logger.debug("_handleCheetahSetContext() - received initial context for quick rewrite session, submitting quick rewrite action",{session:n,message:e,quickRewriteAction:t}),this._submitAction(t)}}_shouldSkipContextUpdate(e){return(0,l.zG)(k.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),k.fold(l.jv,(e=>(0,l.zG)(T.z.toStarted(this._session.get()),k.map((e=>e.results)),k.fold(l.W8,(t=>!t.some((t=>t.id===e))))))))}_bindContextToHistoryCardIfNeeded(e,t){(0,l.zG)(k.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),k.filter((e=>(0,l.zG)(k.fromNullable(this._contextIdByResultId.get(e)),k.fold(l.W8,(e=>void 0===this._contextById.get(e)))))),S.bw((e=>this._contextIdByResultId.set(e,t))))}_handleCheetahSetUserState(e){this._logger.debug("_handleCheetahUserState()",{message:e}),this._session.modify((t=>Object.assign(Object.assign({},t),{historyStatus:ne(t,e.state.historyItems)})))}_getHistory(){if(this._logger.debug("_getHistory()"),void 0!==this._historyAckHandler)return this._logger.warn("_getHistory() called when a cheetah:getHistory request hasn't been ack'ed yet, skipping");this._historyAckHandler=()=>{this._historyAckHandler=void 0,this._setupHistoryTimeout()},this._setupCheetahAckHandler("getHistory",this._historyAckHandler),this._session.lens("historyStatus").set(T.z.HistoryStatus.historyRequested),(0,M.t)("cheetahGetHistory",this._params.capiService.cheetahGetHistory(),this._logger,(()=>this._params.monitoringService.notify((0,O.L)({kind:"info",source:"core",name:"getHistorySuccessful",data:null}))),(()=>this._params.monitoringService.notify((0,O.L)((0,R.tD)()))))}_handleCheetahSetHistory(e){void 0!==this._historyAckHandler&&(this._removeCheetahAckHandler(this._historyAckHandler),this._historyAckHandler=void 0),this._clearHistoryTimeout();const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahSetHistory() - trying to handle `cheetah:setHistory` result with a session that is not `started`, skipping",{session:t});(0,l.zG)(e.cards,s.UI(U.x.History.createFromCard),s.GY,o.c2,k.fold((()=>this._session.lens("historyStatus").set(T.z.HistoryStatus.noHistory)),(e=>{e.forEach((e=>this._resultById.set(e.id,e))),this._session.set(Object.assign(Object.assign({},t),{activeContext:Object.assign(Object.assign({},t.activeContext),{kind:"pending",textRevision:k.none,availableActions:[],selection:k.none}),historyStatus:T.z.HistoryStatus.historyRestored,results:[...t.results,...e],selectedRange:k.none,selectedText:k.none})),this._getContext(void 0,e[0].id)})))}_handleCheetahChunk(e){this._logger.debug("_handleCheetahChunk()",{message:e});const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahChunk() - received chunk with a session that is not `started`, skipping",{session:t,message:e});const i=U.x.Id.create(e.promptId);(0,l.zG)(t.inProgressResult,k.filter(U.x.isInProgressOngoing),k.filter((e=>U.x.Id.eq.equals(e.id,i))),k.fold((()=>{const e=(0,l.zG)(t.inProgressResult,k.filter(U.x.isInProgressOngoing),k.map((e=>e.id)),k.toNullable);this._params.monitoringService.notify((0,O.L)(function(e){return{kind:"warn",source:"core",name:"unexpectedChunkReceived",data:e}}({expectedInProgressResultId:e,receivedInProgressResultId:i})))}),(i=>{this._clearResultRelatedTimeouts(),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:k.some(Object.assign(Object.assign({},i),{text:i.text+e.token}))})),this._setupResultTimeout()})))}_handleCheetahResult(e){this._logger.debug("_handleCheetahResult()",{message:e});const t=this._session.get();if("started"!==t.kind)return this._logger.warn("_handleCheetahResult() - received result with a session that is not `started`, skipping",{session:t,message:e});const i=U.x.Id.create(e.promptId);(0,l.zG)(t.inProgressResult,k.filter(U.x.isInProgressOngoing),k.filter((e=>U.x.Id.eq.equals(e.id,i))),k.fold((()=>{const e=(0,l.zG)(t.inProgressResult,k.filter(U.x.isInProgressOngoing),k.map((e=>e.id)),k.toNullable);this._params.monitoringService.notify((0,O.L)(function(e){return{kind:"warn",source:"core",name:"unexpectedResultReceived",data:e}}({expectedInProgressResultId:e,receivedInProgressResultId:i})))}),(i=>{var r,s,o,a;if(this._clearResultRelatedTimeouts(),e.error||!e.text||""===e.text.plain){const i=e.error?n.create(e.error):n.createEmptyResultError();this._logger.warn("_handleCheetahResult() - received result with error, adding error to session",{session:t,message:e,error:i}),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:k.none,error:k.some(i)}))}else if(e.text.interrupted)this._logger.debug("_handleCheetahResult() - received result with interrupted text, skipping",{session:t,message:e});else{let n,c,u,d;if("aiUsageAlert"===(null===(s=null===(r=e.context)||void 0===r?void 0:r.specialView)||void 0===s?void 0:s.kind))n=U.x.AIUsageNotification.fromInProgressResult(i,e.text.plain);else{const t=(0,l.zG)(i.source,k.map((e=>e.actionValue.generatesTextType)),k.filter(S.FX(A.cX.Insertable)),k.map((()=>U.x.PrimaryAction.insert))),r=k.isSome(t);n=Object.assign(Object.assign({},i),{text:e.text.plain,kind:"complete",timestamp:Date.now(),replacementDelta:U.x.ResultDelta.createFromResultMessage(e),primaryAction:t,isRephraseable:r,references:(0,l.zG)(k.fromNullable(e.references),k.map((t=>t.map((t=>{var i;return Object.assign(Object.assign({},t),{id:V.s.Id.create(t.id),url:k.fromNullable(t.url),contextText:(0,l.zG)(k.fromNullable(null===(i=e.metadata)||void 0===i?void 0:i.knowledge_engine_references),k.chainNullableK((e=>{const i=Array.isArray(e)?e.find((e=>e.id===t.id)):void 0,n=null==i?void 0:i.contextText;return"string"==typeof n?n:void 0})))})}))))),changesSummary:k.fromNullable(e.changesSummary)})}this._logger.debug("_handleCheetahResult() - received complete result, saving complete result into history",{session:t,message:e,result:n}),e.context?(u=(null===(o=e.context)||void 0===o?void 0:o.voiceProfileSettings)?oe(null===(a=e.context)||void 0===a?void 0:a.voiceProfileSettings,e.context.voice,t,this._upstreamDialect.get()):ae(e.context.voice,t,this._upstreamDialect.get()),c={kind:"received",id:E._.Id.create(e.context.id),availableActions:le(e.context.availableActions,this._skills,t.mode,t.selectedText),userPromptAction:ce(e.context.promptAction,this._logger),intent:de(e.context.intent),documentOverview:pe(e.context.documentOverview),specialView:k.fromNullable(e.context.specialView),selection:this._historyResultIdByGetContextMessageId.has(e.promptId)?k.none:(0,l.zG)(i.source,k.chain((({contextId:e})=>(0,l.zG)(k.fromNullable(this._contextById.get(e)),k.chain((({selection:e})=>e)))))),isBoundary:!1,textRevision:(0,l.zG)((0,l.zG)(i.boundaryContextId,k.chain((e=>k.fromNullable(this._contextById.get(e)))),k.chain((({textRevision:e})=>e))))},d=e.context.stateBlob,this._logger.debug("_handleCheetahResult() - received result with context, will update voice profile and context accordingly",{session:t,message:e,voiceProfile:u,context:c})):(this._logger.warn("_handleCheetahResult() - received result without context, keeping latest voice profile and context",{session:t,message:e}),u=t.voiceProfile,c=t.activeContext,d=this._stateBlobByContextId.get(t.activeContext.id)),this._contextById.set(c.id,c),void 0!==d&&this._stateBlobByContextId.set(c.id,d),this._resultById.set(n.id,n),this._contextIdByResultId.set(n.id,c.id),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:u,activeContext:c,inProgressResult:k.none,results:[n,...t.results]})),this._trackResultGenerationCompleted(n.id)}})))}_handleCheetahSearchReferencesResult(e){const t=this._session.get();if("started"===t.kind){const i=this._searchReferencesUrlsById.get(e.promptId);if(i){const n=e.references[0];n&&this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(i,k.some(V.s.create(n)))}))}else this._logger.warn("_handleCheetahSearchReferencesResult() - trying to handle a search references result that did not have a corresponding cheetah:searchReferences request, skipping",{message:e})}else this._logger.warn("_handleCheetahSearchReferencesResult() - trying to handle a search references result with a session that is not `started`, skipping",{session:t})}_handleCheetahError(e){this._logger.debug("_handleCheetahError",{message:e}),this._clearAllTimeouts();const t=n.create(e.error);this._logger.warn("_handleCheetahError - received error, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.none,error:k.some(t)})))}_handleUpstreamDialectChange(e){this._logger.debug("_handleUpstreamDialectChange()",{upstreamDialect:e});const t=this._session.get();if("started"===t.kind){const i=H.L.Dialect.Id.create(e);this._logger.debug("_handleUpstreamDialectChange() - dialect changed on upstream services, updating selected dialect on voice profile",{session:t,selectedDialect:i}),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),{selectedDialect:i})}))}}_handleCheetahAck(e){this._logger.debug("_handleCheetahAck()",{message:e}),this._clearCheetahAckTimeout(),this._cheetahAckIds.add(e.id);const t=this._cheetahAckHandlers.length>0?this._cheetahAckHandlers[0]:void 0;t&&(this._logger.debug("_handleCheetahAck() - extracting `cheetah:ack` handler from queue and executing it",{message:e,cheetahAckHandlers:this._cheetahAckHandlers}),this._cheetahAckHandlers=this._cheetahAckHandlers.slice(1),t(e.id))}_handleError(e){if(this._cheetahAckIds.has(e.id))if(this._clearAllTimeouts(),e.error===d.jK.SESSION_NOT_INITIALIZED){const t=(0,l.zG)(T.z.toStarted(this._session.get()),k.map((e=>this._stateBlobByContextId.get(e.activeContext.id))),k.toUndefined);this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.none}))),this._startSession(this._params.startSessionOptions,t),this._params.monitoringService.notify((0,O.L)(function(e){return{kind:"warn",source:"core",name:"capiErrorHandled",data:e}}({capiError:e})))}else{const t=n.createCriticalError((0,l.zG)(T.z.toStarting(this._session.get()),k.isSome));this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.none,error:k.some(t)}))),this._params.monitoringService.notify((0,O.L)((0,R.Z9)({capiError:e})))}else this._params.monitoringService.notify((0,O.L)((0,R.Z9)({capiError:e})))}_submitAction(e,t,i,n,r,s){var c;this._logger.debug("_submitAction()",{actionValue:e,contextId:t,triggerContextId:i,boundaryContextId:n,previousText:r,selectedVoice:s});const u=this._session.get();if("started"===u.kind){const d=null!=t?t:u.activeContext.id,m=null!=n?n:u.activeBoundaryContext.id,p=this._stateBlobByContextId.get(d);if(void 0===p)return this._logger.warn("_submitAction() - cannot find state blob for context ID, skipping",{session:u,contextId:d,triggerContextId:i,contextStateBlob:p});const h="aiUsageNotification"===(null===(c=u.results[0])||void 0===c?void 0:c.kind)?u.results.slice(1):u.results;this._session.set(Object.assign(Object.assign({},u),{results:h,historyStatus:T.z.HistoryStatus.restoreDisabled,activeContext:Object.assign(Object.assign({},u.activeContext),{kind:"pending"}),inProgressResult:k.isSome(e.generatesTextType)?k.some({kind:"inProgressPending",header:{label:I.aU.isUserPromptActionValue(e)?e.arg.value:e.label,iconUrl:I.aU.isUserPromptActionValue(e)||""===e.iconUrl.trim()?k.none:k.some(e.iconUrl),copiablePrompt:I.aU.isUserPromptActionValue(e)&&""!==e.arg.value.trim()?k.some(e.arg.value):k.none},text:"",source:k.some({contextId:d,actionValue:e}),boundaryContextId:k.some(m)}):k.none,error:k.none})),this._setupCheetahAckHandler("action",(e=>{(0,l.zG)(T.z.toStarted(this._session.get()),k.chain((e=>e.inProgressResult)),k.filter((0,w.Kg)(U.x.isInProgressPending,U.x.isInProgressInterrupted)),k.fold((()=>(this._logger.warn("received `cheetah:ack` related to in-progress-pending result but we don't have an in-progress-pending result, skipping",{ackId:e}),a.of(void 0))),(t=>{if(U.x.isInProgressInterrupted(t))return this._logger.info("received `cheetah:ack` related to in-progress-interrupted result, sending `cheetah:interrupt`",{ackId:e}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.none}))),this._params.capiService.cheetahInterrupt({promptId:e});if(U.x.isInProgressPending(t)){this._setupContextTimeout("action"),this._setupResultTimeout();const i=Object.assign(Object.assign({},t),{kind:"inProgressOngoing",id:U.x.Id.create(e)});return this._logger.debug("received `cheetah:ack` related to in-progress-pending result, transitioning result to in-progress-ongoing",{ackId:e,inProgressResult:i}),this._resultById.set(i.id,i),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.some(i)}))),a.of(void 0)}(0,C.L0)(t)})))()}));const g=Object.assign({contextId:d,triggerContextId:null!=i?i:u.activeContext.id,actionId:e.id,args:I.aU.isUserPromptActionValue(e)?[{name:e.arg.id,value:e.arg.value}]:(0,l.zG)(o.c2(e.args),k.fold((()=>[]),(e=>e.map((e=>({name:e.id,value:e.value})))))),stateBlob:p,previousText:null!=r?r:u.results.length>0&&U.x.isStandardCompletedResult(u.results[0])?me(u.results[0]):void 0},s?{metadata:{selectedVoice:s}}:null),f=(0,l.zG)(e,k.fromPredicate(I.aU.isUserPromptActionValue),k.fold((0,l.a9)(g),(e=>Object.assign(Object.assign({},g),{useReferences:k.toUndefined(e.useReferences),omitReferenceIds:k.toUndefined(e.omitReferenceIds)}))));this._logger.debug("_submitAction() - sending `cheetah:action` to CAPI",{data:f}),(0,M.t)("cheetahAction",this._params.capiService.cheetahAction(f),this._logger,(()=>this._params.monitoringService.notify((0,O.L)(function(e){return{kind:"info",source:"core",name:"actionSuccessful",data:e}}({actionId:e.id})))),(()=>this._params.monitoringService.notify((0,O.L)((0,R.g4)({actionId:e.id})))))}else this._logger.warn("_submitAction() - submitting action with a session that is not `started`, skipping",{session:u,actionValue:e,contextId:t})}_extractLatestResultContext(e){return this._extractContextFromResults(e,0)}_extractLatestResultBoundaryContext(e){return this._extractBoundaryContextFromResults(e,0)}_extractPreviousResultContext(e){return this._extractContextFromResults(e,1)}_extractPreviousResultBoundaryContext(e){return this._extractBoundaryContextFromResults(e,1)}_extractContextFromResults(e,t){const i=(0,l.zG)(k.fromNullable(e.results[t]),k.map((e=>e.id)),k.chain((e=>k.fromNullable(this._contextIdByResultId.get(e)))),k.chain((e=>k.fromNullable(this._contextById.get(e)))));return k.isNone(i)&&this._logger.warn("_extractContextFromResults() - could not find context for result",{session:e,resultIndex:t}),i}_extractBoundaryContextFromResults(e,t){return(0,l.zG)(k.fromNullable(e.results[t]),k.filter(U.x.isComplete),k.chain((({boundaryContextId:e})=>e)),k.chain((e=>k.fromNullable(this._contextById.get(e)))),S.ew((()=>{this._logger.warn("_extractBoundaryContext() - could not find boundary context for result index")})))}_extractInitialContext(){return null!==this._initialReceivedContext?k.some(this._initialReceivedContext):(this._logger.warn("_extractInitialContext() - could not find initial context"),k.none)}_setupResultTimeout(){this._clearResultTimeout(),this._resultTimeout=x.H(this._resultTimeoutMs).subscribe((()=>{this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.none,error:k.some(n.createCriticalError((0,l.zG)(T.z.toStarting(this._session.get()),k.isSome)))}))),this._params.monitoringService.notify((0,O.L)((0,R.bE)()))}))}_setupContextTimeout(e){this._logger.debug("_setupContextTimeout()",{sourceCommand:e}),this._clearContextTimeout(),this._contextTimeout=x.H(this._contextTimeoutMs).subscribe((()=>{const t=n.createCriticalError((0,l.zG)(T.z.toStarting(this._session.get()),k.isSome));this._logger.warn("waited too long to receive `cheetah:setContext`, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.none,error:k.some(t)}))),this._params.monitoringService.notify((0,O.L)((0,R.gW)({sourceCommand:e})))}))}_setupHistoryTimeout(){this._clearHistoryTimeout(),this._historyTimeout=x.H(this._historyTimeoutMs).subscribe((()=>{const e=n.createCriticalError((0,l.zG)(T.z.toStarting(this._session.get()),k.isSome));this._logger.warn("waited too long to receive `cheetah:setHistory`, adding error to session",{error:e}),this._session.modify((t=>Object.assign(Object.assign({},t),{inProgressResult:k.none,error:k.some(e)}))),this._params.monitoringService.notify((0,O.L)((0,R.Ax)()))}))}_setupCheetahAckTimeout(e){this._logger.debug("_setupCheetahAckTimeout()",{sourceCommand:e}),this._clearCheetahAckTimeout(),this._cheetahAckTimeout=x.H(this._cheetahAckTimeoutMs).subscribe((()=>{const t=n.createCriticalError((0,l.zG)(T.z.toStarting(this._session.get()),k.isSome));this._logger.warn("waited too long to receive an ACK for a `cheetah:*` command, adding error to session",{error:t}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:k.none,error:k.some(t)}))),this._params.monitoringService.notify((0,O.L)((0,R.No)({sourceCommand:e})))}))}_clearResultTimeout(){var e;null===(e=this._resultTimeout)||void 0===e||e.unsubscribe(),this._resultTimeout=void 0}_clearContextTimeout(){var e;null===(e=this._contextTimeout)||void 0===e||e.unsubscribe(),this._contextTimeout=void 0}_clearHistoryTimeout(){var e;null===(e=this._historyTimeout)||void 0===e||e.unsubscribe(),this._historyTimeout=void 0}_clearCheetahAckTimeout(){var e;null===(e=this._cheetahAckTimeout)||void 0===e||e.unsubscribe(),this._cheetahAckTimeout=void 0}_clearResultRelatedTimeouts(){this._clearContextTimeout(),this._clearResultTimeout(),this._clearCheetahAckTimeout()}_clearAllTimeouts(){this._clearResultTimeout(),this._clearContextTimeout(),this._clearHistoryTimeout(),this._clearCheetahAckTimeout()}_setupCheetahAckHandler(e,t){this._setupCheetahAckTimeout(e),this._cheetahAckHandlers.push(t)}_removeCheetahAckHandler(e){this._cheetahAckHandlers=this._cheetahAckHandlers.filter((t=>t!==e)),0===this._cheetahAckHandlers.length&&this._clearCheetahAckTimeout()}}},84403:(e,t,i)=>{i.d(t,{c:()=>u});var n,r=i(57050),s=i(22232),o=i(5114),a=i(71249);!function(e){let t,i,n,l,c,u,d,m,p;!function(e){let t;!function(e){e.rephrase="rephrase",e.dismiss="dismiss",e.insert="insert",e.offensive="offensive",e.copy="copy",e.generationCompleted="generationCompleted"}(t=e.UserAction||(e.UserAction={}))}(t=e.Result||(e.Result={})),function(e){let t;!function(e){e.open="open",e.skip="skip",e.openFromBanner="openFromBanner",e.keepVoiceTag="keepTag",e.removeVoiceTag="removeTag",e.toggleToMyVoice="toggleToMyVoice",e.toggleToNeutral="toggleToNeutral"}(t=e.UserAction||(e.UserAction={}))}(i=e.VoiceProfile||(e.VoiceProfile={})),function(e){let t;!function(e){e.openStore="openStore",e.offensive="offensive"}(t=e.UserAction||(e.UserAction={}))}(n=e.Actions||(e.Actions={})),function(e){let t;!function(e){e.search="search"}(t=e.UserAction||(e.UserAction={}))}(l=e.Prompt||(e.Prompt={})),function(e){let t;!function(e){e.hover="hover",e.click="click"}(t=e.UserAction||(e.UserAction={}))}(c=e.UsageInfo||(e.UsageInfo={})),function(e){let t;!function(e){e.view="view"}(t=e.UserAction||(e.UserAction={}))}(u=e.HistoryButton||(e.HistoryButton={})),function(e){let t;!function(e){e.view="view",e.skip="skip",e.next="next"}(t=e.UserAction||(e.UserAction={}))}(d=e.Onboarding||(e.Onboarding={})),function(e){let t;!function(e){e.close="close",e.readyToInteract="readyToInteract"}(t=e.UserAction||(e.UserAction={}))}(m=e.Assistant||(e.Assistant={})),function(e){let t;!function(e){e.dontShowOnDocument="dontShowOnDocument",e.dontShowForever="dontShowForever"}(t=e.UserAction||(e.UserAction={}))}(p=e.AIUsageNotification||(e.AIUsageNotification={})),e.getComponentId=function(e,t,i,l={}){const c=(0,r.zG)(e.kind,(t=>{switch(t){case"result":return"card";case"voiceProfile":return"voice";case"actions":return e.userAction===n.UserAction.openStore?"group":"card";case"assistant":return"widget";case"onboardingPromptsTooltip":return"onboardingPromptTooltip";case"onboardingReviewTooltip":return"onboardingReviewtextTooltip";case"usageInfo":case"historyButton":case"prompt":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":return t;default:return(0,s.L0)(t)}}));return(0,r.zG)(o.fromNullable(i),o.map((e=>`cheetah:history-card:${e}`)),o.getOrElse((()=>`cheetah:${c}${t?`:${t}`:""}`)),(u=l,e=>(0,r.zG)(Object.entries(u),a.u4(e,((e,[t,i])=>{const n=e.includes("?")?"&":"?";return e+`${n}${t}=${i}`})))));var u},e.getUserAction=function(e){return(0,r.zG)(e.kind,(t=>{switch(t){case"actions":return e.userAction===n.UserAction.openStore?"All Ideas":e.userAction;case"assistant":return e.userAction===m.UserAction.close?"dismiss":e.userAction;case"result":case"voiceProfile":case"prompt":case"usageInfo":case"historyButton":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingPromptsTooltip":case"onboardingReviewTooltip":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":return e.userAction;default:return(0,s.L0)(t)}}))}}(n||(n={}));var l=i(26320),c=i(63346);class u{constructor(e,t=new c.W(u.name)){this._capiService=e,this._logger=t}trackResultInsert(e,t,i=!1){this._logger.debug("trackResultInsert()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultInsert() - tracking result insert without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.insert},e,t,{withVoiceProfile:i})}trackResultOffensive(e,t){this._logger.debug("trackResultOffensive()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultOffensive() - tracking result offensive without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.offensive},e,t)}trackResultDismiss(e,t){this._logger.debug("trackResultDismiss()",{contextId:e,historyResultId:t}),e||this._logger.warn("trackResultDismiss() - tracking result dismiss without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.dismiss},e,t)}trackResultRephrase(e){this._logger.debug("trackResultRephrase()",{contextId:e}),e||this._logger.warn("trackResultRephrase() - tracking result rephrase without context"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.rephrase},e)}trackResultCopy(e,t){this._logger.debug("trackCopy()"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.copy},e,t)}trackResultGenerationCompleted(e,t){this._logger.debug("trackResultGenerationCompleted()"),this._trackUxInteraction({kind:"result",userAction:n.Result.UserAction.generationCompleted},e,t)}trackVoiceProfileOpen(e){this._logger.debug("trackVoiceProfileOpen()",{source:e}),this._trackUxInteraction({kind:"voiceProfile",userAction:"toolbar"===e?n.VoiceProfile.UserAction.open:n.VoiceProfile.UserAction.openFromBanner})}trackVoiceProfileSkip(){this._logger.debug("trackVoiceProfileSkip()"),this._trackUxInteraction({kind:"voiceProfile",userAction:n.VoiceProfile.UserAction.skip})}trackActionsOpenStore(){this._logger.debug("trackActionsOpenStore()"),this._trackUxInteraction({kind:"actions",userAction:n.Actions.UserAction.openStore})}trackActionsOffensive(e){this._logger.debug("trackActionsOffensive()"),e||this._logger.warn("trackActionsOffensive() - tracking actions offensive without context"),this._trackUxInteraction({kind:"actions",userAction:n.Actions.UserAction.offensive},e)}trackPromptSearch(){this._logger.debug("trackPromptSearch()"),this._trackUxInteraction({kind:"prompt",userAction:n.Prompt.UserAction.search})}trackUsageInfoClick(){this._logger.debug("trackUsageInfoClick()"),this._trackUxInteraction({kind:"usageInfo",userAction:n.UsageInfo.UserAction.click})}trackUsageInfoHover(){this._logger.debug("trackUsageInfoHover()"),this._trackUxInteraction({kind:"usageInfo",userAction:n.UsageInfo.UserAction.hover})}trackHistoryButtonView(){this._logger.debug("trackHistoryButtonView()"),this._trackUxInteraction({kind:"historyButton",userAction:n.HistoryButton.UserAction.view})}trackOnboardingPopupView(){this._logger.debug("trackOnboardingPopupView()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:n.Onboarding.UserAction.view})}trackOnboardingPopupSkip(){this._logger.debug("trackOnboardingPopupSkip()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:n.Onboarding.UserAction.skip})}trackOnboardingPopupNext(){this._logger.debug("trackOnboardingPopupNext()"),this._trackUxInteraction({kind:"onboardingPopup",userAction:n.Onboarding.UserAction.next})}trackBTSOnboardingPopupView(){this._logger.debug("trackBTSOnboardingPopupView()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:n.Onboarding.UserAction.view})}trackBTSOnboardingPopupSkip(){this._logger.debug("trackBTSOnboardingPopupSkip()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:n.Onboarding.UserAction.skip})}trackBTSOnboardingPopupNext(){this._logger.debug("trackBTSOnboardingPopupNext()"),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:n.Onboarding.UserAction.next})}trackOnboardingPromptsTooltipView(){this._logger.debug("trackOnboardingPromptsTooltipView()"),this._trackUxInteraction({kind:"onboardingPromptsTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingReviewTooltipView(){this._logger.debug("trackOnboardingReviewTooltipView()"),this._trackUxInteraction({kind:"onboardingReviewTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingRewriteTooltipView(){this._logger.debug("trackOnboardingRewriteTooltipView()"),this._trackUxInteraction({kind:"onboardingRewriteTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingKnowledgeHubTooltipView(){this._logger.debug("trackOnboardingRewriteTooltipView()"),this._trackUxInteraction({kind:"onboardingKnowledgeHubTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingReferencesTooltipView(){this._logger.debug("trackOnboardingReferencesTooltipView()"),this._trackUxInteraction({kind:"onboardingReferencesTooltip",userAction:n.Onboarding.UserAction.view})}trackOnboardingHistoryTooltipView(){this._logger.debug("trackOnboardingHistoryTooltipView()"),this._trackUxInteraction({kind:"onboardingHistoryTooltip",userAction:n.Onboarding.UserAction.view})}trackAssistantClose(){this._logger.debug("trackAssistantClose()"),this._trackUxInteraction({kind:"assistant",userAction:n.Assistant.UserAction.close})}trackVoiceProfileRemoveTag(){this._logger.debug("trackVoiceProfileRemoveTag()"),this._trackUxInteraction({kind:"voiceProfile",userAction:n.VoiceProfile.UserAction.removeVoiceTag})}trackVoiceProfileKeepTag(){this._logger.debug("trackVoiceProfileKeepTag()"),this._trackUxInteraction({kind:"voiceProfile",userAction:n.VoiceProfile.UserAction.keepVoiceTag})}trackAINotificationDismiss(e){this._logger.debug("trackAINotificationDismiss()"),this._trackUxInteraction({kind:"aiUsageNotification",userAction:"document"===e?n.AIUsageNotification.UserAction.dontShowOnDocument:n.AIUsageNotification.UserAction.dontShowForever})}trackReadyToInteract(){this._logger.debug("trackReadyToInteract()"),this._trackUxInteraction({kind:"assistant",userAction:n.Assistant.UserAction.readyToInteract})}trackMyVoiceCardToggle(e){this._logger.debug("trackMyVoiceCardToggle"),this._trackUxInteraction({kind:"voiceProfile",userAction:e?n.VoiceProfile.UserAction.toggleToMyVoice:n.VoiceProfile.UserAction.toggleToNeutral})}_trackUxInteraction(e,t,i,r={}){const s=n.getComponentId(e,t,i,r),o=n.getUserAction(e);this._logger.debug("_trackUxInteraction() - sending `user_action` to CAPI",{componentId:s,userAction:o,uxInteraction:e,contextId:t}),(0,l.t)("sendUserAction",this._capiService.user_action({componentId:s,userAction:o}),this._logger)}}},94689:(e,t,i)=>{i.d(t,{Ki:()=>l,_7:()=>a,dD:()=>c,fx:()=>r,s4:()=>s,to:()=>o});var n=i(89894);function r(e,t){return Object.assign(Object.assign({},function(e){return{width:n.ux.rem(e),minWidth:n.ux.rem(e)}}(e)),function(e){return{height:n.ux.rem(e),minHeight:n.ux.rem(e)}}(null!=t?t:e))}function s(e,t){return`.${e}`.repeat(t)}function o(e,t,i){return{$nest:{[`&${s(t,i)}`]:e}}}const a=6,l=a+1;function c(e,t){return o(e,t,l)}},65602:(e,t,i)=>{i.d(t,{DO:()=>c,l:()=>u});var n=i(5114),r=i(57050),s=i(69243),o=i(8709),a=i(36991);const l=s.OT(s.dt({ops:s.Bk(s.G0([s.dt({insert:s.OT(s.Z_)}),s.dt({retain:s.OT(s.pk)}),s.dt({delete:s.OT(s.pk)})]))}));function c(e){return(0,r.zG)(e,n.fromPredicate(l.is),n.map((e=>new o.i([...e.ops]))))}function u(e,t){return e.reduce(((e,t)=>(a.s.isInsertString(t)?(e.text=`${e.text.substring(0,e.index)}${t.insert}${e.text.substring(e.index)}`,e.index+=t.insert.length):a.s.isDelete(t)?e.text=`${e.text.substring(0,e.index)}${e.text.substring(e.index+t.delete)}`:a.s.isRetain(t)?e.index+=t.retain:function(e){var t;return a.s.isInsertEmbed(e)&&!0===(null===(t=e.insert)||void 0===t?void 0:t.linebreak)}(t)&&(e.text=`${e.text.substring(0,e.index)}\n${e.text.substring(e.index)}`,e.index+=1),e)),{text:t,index:0}).text}},17430:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(62172);const r=Object.assign(Object.assign({},n),{BrandGreen60:"#018374",BrandGreen80:"#017467",BorderBaseSubduedColor:"#CDD1DC",TextBaseSubduedColor:"#646B81",TextBaseDefault:"#161719",BorderBaseInverse:"#ffffff",BackgroundNeutralDefault:"#646B81",ButtonBorderTertiaryDefault:"#878DA2",ButtonBackgroundTertiaryHover:"#E2E4E9",ButtonBackgroundTertiaryActive:"#CDD1DC"})},87683:(e,t,i)=>{i.d(t,{$Q:()=>o,E:()=>u,Jj:()=>s,Re:()=>l,ap:()=>c,vY:()=>a});var n=i(31699),r=i(77176);function s(e){const t=function(e){const t=e.ownerDocument;if(t)return t;throw new Error("target does not have ownerDocument")}(e).defaultView;if(t)return t;throw new Error("active document is detached from a window")}function o(e,t=3){if(e&&t>0){const i=function(e){const t=(null===(r=null===(n=(i=e).ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===r?void 0:r.getComputedStyle(i))||null;var i,n,r;return t?"auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowY||"scroll"===t.overflowY||"auto"===t.overflowX||"scroll"===t.overflowX:null}(e);return i?e:null===i?null:o(null==e?void 0:e.parentElement,t-1)}return null}function a(e){var t,i;return null===(i=(null===(t=e.activeElement)||void 0===t?void 0:t.shadowRoot)||e)||void 0===i?void 0:i.activeElement}function l(e){return e instanceof HTMLElement}const c=["b","i"];function u(e,t=c){return"string"==typeof e?{dangerouslySetInnerHTML:{__html:(0,n.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}}:{dangerouslySetInnerHTML:e.pipe(r.U((e=>({__html:(0,n.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}))))}}},2735:(e,t,i)=>{function n(e){const t=e;return null!=t&&(void 0!==t.message&&void 0!==t.name||void 0!==t.stack)}function r(e){return n(e)?e:{message:String(e),name:"",stack:void 0}}i.d(t,{N:()=>r,x:()=>n})},44361:(e,t,i)=>{function n(e){return t=>{(null==t?void 0:t.isTrusted)&&(null==e||e(t))}}i.d(t,{m:()=>n})},54596:(e,t,i)=>{var n;i.d(t,{e:()=>n}),function(e){e.set=function(e,t){return i=>Object.assign(Object.assign({},i),{[e]:t})}}(n||(n={}))},33498:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(44586),r=i(76974);function s(e){return e instanceof n.y?e:(0,r.of)(e)}},26320:(e,t,i)=>{i.d(t,{L:()=>c,t:()=>l});var n=i(95195),r=i(62965),s=i(57050),o=i(2735),a=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};function l(e,t,i,r,s){return a(this,void 0,void 0,(function*(){try{const o=yield t();n.isLeft(o)?(null==i||i.error("runTaskEither() - error running task",{taskName:e,result:o}),null==s||s(o.left)):(null==i||i.debug("runTaskEither() - task successful",{taskName:e,result:o.right}),null==r||r(o.right))}catch(t){null==i||i.error("runTaskEither() - promise rejection running task",(0,o.x)(t)?t:new Error(String(t)),{taskName:e})}}))}const c={URI:r.ov,map:r.dO.map,ap:(e,t)=>(0,s.zG)(e,r.ap(t))}},63501:(e,t,i)=>{i.d(t,{G:()=>L,K:()=>V});var n=i(27378),r=i(95195),s=i(77176),o=i(22232),a=i(12187),l=i(5739),c=i(34217),u=i(93986),d=i(13578),m=i(31278);const p=e=>n.createElement(m.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),n.createElement("path",{d:"M14 11.5H16.7929L8.92289 19.37L10.4851 13.1213L10.6404 12.5H10H7.20711L15.0771 4.62999L13.5149 10.8787L13.3596 11.5H14Z",stroke:d.XY.Content.Secondary.Default,strokeMiterlimit:"4.25735"})),h=e=>n.createElement(m.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),n.createElement("rect",{x:"4.5",y:"4.5",width:"6",height:"6",rx:"1.5",stroke:d.XY.Content.Secondary.Default}),n.createElement("rect",{x:"4.5",y:"13.5",width:"6",height:"6",rx:"1.5",stroke:d.XY.Content.Secondary.Default}),n.createElement("rect",{x:"13.5",y:"4.5",width:"6",height:"6",rx:"1.5",stroke:d.XY.Content.Secondary.Default}),n.createElement("path",{d:"M14.5513 15.8162L12.9269 16.3577C12.7902 16.4033 12.7902 16.5967 12.9269 16.6423L14.5513 17.1838C15.1485 17.3828 15.6172 17.8515 15.8162 18.4487L16.3577 20.0731C16.4033 20.2098 16.5967 20.2098 16.6423 20.0731L17.1838 18.4487C17.3828 17.8515 17.8515 17.3828 18.4487 17.1838L20.0731 16.6423C20.2098 16.5967 20.2098 16.4033 20.0731 16.3577L18.4487 15.8162C17.8515 15.6172 17.3828 15.1485 17.1838 14.5513L16.6423 12.9269C16.5967 12.7902 16.4033 12.7902 16.3577 12.9269L15.8162 14.5513C15.6172 15.1485 15.1485 15.6172 14.5513 15.8162Z",fill:d.XY.Content.Secondary.Default,stroke:d.XY.Content.Secondary.Default}));var g=i(83289),f=i(87683),v=i(9546),y=i(62172),b=i(89894),x=i(94689),k=i(17430);const S="brick",C=(0,x.dD)({padding:`0 ${b.ux.rem(v.x)} 0 ${b.ux.rem(v.F2)}`},S),w={display:"flex",alignItems:"center",gap:b.ux.rem(v.x)},_=(0,x.dD)({minHeight:b.ux.rem(1.75),fontSize:b.ux.rem(.75),lineHeight:b.ux.rem(1.125),color:y.BlueGray80},S),I=(0,x.dD)({minHeight:b.ux.rem(2),fontSize:b.ux.rem(.875),lineHeight:b.ux.rem(1.375),color:d.XY.Content.Primary.Default},S),E=(0,x.dD)({boxShadow:`inset 0 0 0 ${b.ux.rem(.125)} ${k.Z.BrandGreen60}`},S),A=(0,x.dD)({boxShadow:"none",color:y.NeutralGray70,$nest:{"&:not([data-disabled='true'])[data-hovered='true'], &:not([data-disabled='true'])[data-active='true']":{color:k.Z.BlueGray80,boxShadow:`inset 0 0 0 1px ${k.Z.BlueGray40}`,backgroundColor:k.Z.BlueGray5}}},S),O={textAlign:"left",whiteSpace:"initial",lineHeight:b.ux.rem(1.125),margin:`${b.ux.rem(.25)} 0 ${b.ux.rem(.25)} 0`},R=Object.assign({},(0,x.fx)(1.5)),U=b.ux.joinClasses([S,b.ux.style(C)]),T=b.ux.style(w),B=b.ux.style(_),P=b.ux.style(I),N=b.ux.style(E),z=b.ux.style(A),G=b.ux.style(O),j=b.ux.style(R),F=b.ux.style(R),D=(0,a.xb)(u.z.Secondary),M="actionBrick",V=".actionBrick",L=c.UI.Node.make((({view:e,notify:t})=>n.createElement(D,Object.assign({onClick:e("action").pipe(s.U((e=>t({kind:g.i.Kind.actionBrickClick,action:e})))),name:"actionBrick"},(0,a.Sh)(M,U,e("action").pipe(s.U((({kind:e})=>"go"===e?N:null))),e("mode").pipe(s.U((e=>"compact"===e?B:"standard"===e?P:(0,o.L0)(e)))),e("customViewOpts").pipe(s.U((e=>(null==e?void 0:e.isPinned)?z:null))))),n.createElement(l.F.div,{className:T},e("icon").pipe(s.U(r.fold((({kind:e})=>{switch(e){case"allResults":return n.createElement(h,{className:j});case"go":return n.createElement(p,{className:F});default:return(0,o.L0)(e)}}),(({url:e})=>n.createElement("img",{src:e,style:{width:20,height:20}}))))),n.createElement(l.F.span,Object.assign({className:G},(0,f.E)(e("label"))))))))},90238:(e,t,i)=>{i.d(t,{I:()=>fu});var n=i(27378),r=i(34217),s=i(64015),o=i(9546),a=i(89894),l=i(13578),c=i(88392),u=i(77176),d=i(22232),m=i(5739),p=i(45578),h=i(62172),g=i(31278);const f=e=>n.createElement(g.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:h.Green30},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM18.2071 9.20711C18.5976 8.81658 18.5976 8.18342 18.2071 7.79289C17.8166 7.40237 17.1834 7.40237 16.7929 7.79289L10 14.5858L8.20711 12.7929C7.81658 12.4024 7.18342 12.4024 6.79289 12.7929C6.40237 13.1834 6.40237 13.8166 6.79289 14.2071L10 17.4142L18.2071 9.20711Z",stroke:"none"}));var v=i(94689),y=i(75552);const b=r.UI.Node.make((({view:e,notify:t})=>n.createElement(m.F.div,{className:k,"data-id":e("id")},e("kind").pipe(u.U((e=>{switch(e){case y.C.Kind.feedbackSubmitted:return n.createElement(n.Fragment,null,n.createElement(f,{className:S}),n.createElement("div",null,"Thanks for the feedback!"));case y.C.Kind.voiceTagRemoved:return n.createElement(n.Fragment,null,n.createElement(f,{className:S}),n.createElement("div",null,"Removed"));default:return(0,d.L0)(e)}}))),e("id").pipe(u.U((e=>n.createElement(p.x,{name:"notificationClose",onClick:t({kind:"dismissNotification",id:e}),size:"small"}))))))),x=a.ux.keyframes({from:{transform:`translateY(${a.ux.rem(.25)})`,opacity:0},to:{transform:"translateY(0)",opacity:1}}),k=a.ux.style({background:l.S5.Surface.Primary.Default,color:l.S5.Content.Primary.Default,borderRadius:a.ux.rem(c.xB+c.fe),display:"flex",flexDirection:"row",alignItems:"center",padding:`${a.ux.rem(o.x)} ${a.ux.rem(o.qp)}`,gap:a.ux.rem(o.qp),fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),animation:`${x} 0.1s ease-in`}),S=a.ux.style(Object.assign({},(0,v.fx)(1.5))),C=r.UI.List.make(s.bw,b),w=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:I},e.content))),_=r.UI.Knot.make(w,{content:C}),I=a.ux.style({display:"flex",flexDirection:"column",gap:a.ux.rem(o.x),transition:"top 0.1s ease-in"});var E=i(5114),A=i(57050),O=i(90845),R=i(2834),U=i(9223),T=i(2844),B=i(24435),P=i(83289),N=i(99877),z=i(87683);const G=n.createContext({notifyUnmount:A.Q1});var j=i(93986),F=i(17430);const D=e=>n.createElement(g.a1,Object.assign({width:"18",height:"18",viewBox:"0 0 18 18",fill:F.Z.BrandGreen60},e),n.createElement("path",{d:"M17.1056 9.44721L0.992696 17.5037C0.607324 17.6963 0.174955 17.3439 0.285972 16.9276L1.83393 11.1228C1.93505 10.7436 2.24864 10.4586 2.63576 10.394L9.52041 9.2466C9.79894 9.20018 9.79894 8.79982 9.52041 8.7534L2.63576 7.60596C2.24864 7.54144 1.93505 7.25644 1.83393 6.87723L0.285971 1.07239C0.174955 0.656082 0.607322 0.303661 0.992694 0.496347L17.1056 8.55279C17.4741 8.73705 17.4741 9.26295 17.1056 9.44721Z",stroke:"none"})),M=e=>n.createElement(g.a1,Object.assign({width:"32",height:"32",fill:l.XY.Content.Secondary.Default,viewBox:"0 0 32 32"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 16a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm1 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-11-3a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-4Z",stroke:"none"}));var V=i(31542),L=i(15073),H=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const K="#161719",$="#646B81",W=e=>{var{children:t,style:i,dataGrammarlyPart:r="ui-kit-iframe"}=e,s=H(e,["children","style","dataGrammarlyPart"]);const[o,a]=n.useState(null),l=n.useCallback((e=>{var t,i;let n=null;"contentDocument"in e.target&&(n=null!==(i=null===(t=e.target.contentDocument)||void 0===t?void 0:t.body)&&void 0!==i?i:null),a(n),n&&(n.style.margin="0",n.style.height="100vh",n.style.overflowY="hidden")}),[]),c=n.useContext(L.u.Context);return n.useEffect((()=>{const e=c.subscribe((e=>{o&&L.u.setRootCssVar(o,E.some(e))}));return()=>e.unsubscribe()}),[o]),n.createElement("iframe",Object.assign({},s,{style:Object.assign({},i),onLoad:l,srcDoc:"<html><body></body></html>","data-grammarly-part":r}),o&&(0,V.createPortal)(t,o))},Z=1.375,q=({fitContentHeight:e,text:t,ariaLabel:i,onChange:r,placeholder:s,disabled:o,className:l,onFocus:u,onBlur:d,onKeyDownEnter:m,autofocus:p,onKeyUpEscape:h,onKeyDownArrowUp:g,onKeyDownArrowDown:f,onKeyDownShiftEnter:v,theme:y})=>{var b,x,k,S,C,w,_,I,E,A,O,R,U,T,B;const P=Z*(s?s.length:1)+(null!==(x=null===(b=null==y?void 0:y.paddingRems)||void 0===b?void 0:b.top)&&void 0!==x?x:0)+(null!==(S=null===(k=null==y?void 0:y.paddingRems)||void 0===k?void 0:k.bottom)&&void 0!==S?S:0),[N,z]=n.useState({kind:"rem",value:P}),[G,j]=n.useState(null);return n.useEffect((()=>{G&&void 0!==p&&(G.focus(),G.selectionStart=t.length,G.selectionEnd=t.length)}),[p,G]),n.useLayoutEffect((()=>{if(""===t)z({kind:"rem",value:P});else{const e=null==G?void 0:G.scrollHeight;z(e?{kind:"px",value:e}:{kind:"rem",value:P})}}),[t,G,s]),n.createElement(W,{className:l,style:{height:e?"rem"===N.kind?a.ux.rem(N.value):a.ux.px(N.value):void 0,maxHeight:(null==y?void 0:y.maxHeightRems)?a.ux.rem(y.maxHeightRems):"none",minHeight:(null==y?void 0:y.minHeightRems)?a.ux.rem(y.minHeightRems):"none"},title:`${i} container`},n.createElement("style",{dangerouslySetInnerHTML:{__html:`\n      .container {\n        position: relative;\n        width: 100%;\n        height: 100%;\n      }\n      .textarea {\n        box-sizing: border-box;\n        border-radius: ${a.ux.rem(c.xB)};\n        overflow-y: auto;\n        padding: ${a.ux.rem(null!==(w=null===(C=null==y?void 0:y.paddingRems)||void 0===C?void 0:C.top)&&void 0!==w?w:0)} ${a.ux.rem(null!==(I=null===(_=null==y?void 0:y.paddingRems)||void 0===_?void 0:_.right)&&void 0!==I?I:0)} ${a.ux.rem(null!==(A=null===(E=null==y?void 0:y.paddingRems)||void 0===E?void 0:E.bottom)&&void 0!==A?A:0)} ${a.ux.rem(null!==(R=null===(O=null==y?void 0:y.paddingRems)||void 0===O?void 0:O.left)&&void 0!==R?R:0)};\n        width: 100%;\n        height: 100%;\n        border: none;\n        background: transparent;\n        resize: none;\n        font-family: Inter, sans-serif;\n        font-size: ${null!==(U=null==y?void 0:y.fontSize)&&void 0!==U?U:a.ux.rem(.875)};\n        font-weight: 400;\n        color: ${null!==(T=null==y?void 0:y.color)&&void 0!==T?T:K};\n      }\n      .textarea::placeholder {\n        color: ${$};\n      }\n      .textarea:focus {\n        outline: none;\n      }\n      .placeholder {\n        position: absolute;\n        top: 0px;\n        left: 0px;\n        width: 100%;\n        height: 100%;\n        background: transparent;\n        font-family: Inter, sans-serif;\n        font-size: ${a.ux.rem(.875)};\n        font-weight: 400;\n        z-index: -1;\n        color: ${$};\n      }\n      `}}),n.createElement("div",{className:"container"},n.createElement("textarea",{"aria-label":i,className:"textarea",style:{lineHeight:null!==(B=null==y?void 0:y.lineHeight)&&void 0!==B?B:a.ux.rem(Z)},value:t,ref:j,onChange:e=>r(e.target.value),placeholder:1===(null==s?void 0:s.length)?s[0]:void 0,disabled:o,onFocus:()=>null==u?void 0:u(),onBlur:()=>null==d?void 0:d(),onKeyDown:e=>{var t;m&&"Enter"===e.key&&!e.shiftKey?(e.preventDefault(),e.stopPropagation(),m()):"ArrowUp"===e.key&&g&&(Y(t=e.currentTarget)&&0===t.selectionStart)?(e.preventDefault(),e.stopPropagation(),g()):"ArrowDown"===e.key&&f&&function(e){return Y(e)&&e.selectionStart===e.value.length}(e.currentTarget)?(e.preventDefault(),e.stopPropagation(),f()):"Enter"===e.key&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),null==v||v())},onKeyUp:e=>{h&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),h())}}),((null==s?void 0:s.length)||0)>1&&""===t?n.createElement("div",{className:"placeholder",style:{lineHeight:a.ux.rem(Z)}},(s||[]).map(((e,t)=>n.createElement(n.Fragment,{key:t},e,n.createElement("br",null))))):null))};function Y(e){return e.selectionStart===e.selectionEnd}var X=i(819);const Q="goBtn",J="stopBtn",ee={top:o.x,right:3.5*o.qp,bottom:o.x,left:o.qp},te=a.ux.style({display:"flex",position:"relative",alignItems:"flex-start",padding:0,gap:a.ux.rem(o.F2),justifyContent:"space-between"}),ie=a.ux.style({flexGrow:1,$nest:{"&[data-hasheader='false']":{paddingTop:a.ux.rem(o.F2+o.W9)}}}),ne=a.ux.style({width:a.ux.percent(100),border:"none"}),re={position:"absolute",bottom:a.ux.rem(o.x),right:a.ux.rem(o.qp)},se=(0,v.dD)(re,J),oe=(0,v.dD)(Object.assign(Object.assign({},re),{$nest:{"&[data-disabled='true']":{opacity:1,$nest:{"& svg":{fill:h.BlueGray30}}}}}),Q),ae=a.ux.joinClasses([Q,a.ux.style(oe)]),le=a.ux.joinClasses([J,a.ux.style(se)]),ce=r.UI.Node.make((({state:e,view:t,notify:i})=>{const{onMount:r}=(0,B.F)(R.b((e=>i({kind:P.i.Kind.mount,name:N.e.promptInput,element:e})())));return n.createElement(m.F.div,{className:te,mount:r},n.createElement(m.F.div,{className:ie,"data-hasheader":t("hasHeader")},e.pipe(u.U((({placeholder:e,kind:t,text:r,autofocusToken:s,genAIAvailability:o})=>n.createElement(q,{text:r,theme:{paddingRems:ee,maxHeightRems:18.25,minHeightRems:2},ariaLabel:"custom prompt",className:ne,placeholder:"ready"===t?E.toUndefined(e):void 0,fitContentHeight:!0,autofocus:s,onChange:e=>i({kind:P.i.Kind.promptFieldTextChange,text:e})(),onKeyDownEnter:"ready"===t?i({kind:P.i.Kind.promptFieldKeyPressEnter,text:r}):A.Q1,onKeyUpEscape:i({kind:P.i.Kind.promptFieldKeyPressEscape}),onFocus:i({kind:P.i.Kind.promptFieldFocusChange,focused:!0}),onBlur:i({kind:P.i.Kind.promptFieldFocusChange,focused:!1}),onKeyDownArrowUp:i({kind:P.i.Kind.promptFieldKeyPressArrowUp}),onKeyDownArrowDown:i({kind:P.i.Kind.promptFieldKeyPressArrowDown}),disabled:X._.isUnavailable(o)}))))),e.pipe(u.U((({kind:e,text:t,genAIAvailability:r})=>"waitingForResult"===e?n.createElement(j.z.Tertiary,{className:le,onClick:i({kind:P.i.Kind.generateStopButtonClick}),name:"generateStop",compact:!0,size:"large"},n.createElement(M,null)):"ready"===e?n.createElement(j.z.Tertiary,{className:ae,onClick:i({kind:P.i.Kind.promptSubmitButtonClick,text:t}),disabled:""===t.trim()||X._.isUnavailable(r),name:"promptSend",compact:!0,size:"large"},n.createElement(D,null)):null))))})),ue=({children:e,customStyle:t})=>n.createElement(m.F.h1,{className:a.ux.style(de,t)},e),de={color:l.XY.Content.Secondary.Default,margin:0,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},me=e=>n.createElement(g.a1,Object.assign({width:"12",height:"15",viewBox:"0 0 12 15",fill:"#99A0B3"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.5 0.5C3.67157 0.5 3 1.17157 3 2V3H0.5C0.223858 3 0 3.22386 0 3.5C0 3.77614 0.223858 4 0.5 4H1.04536L1.82983 12.237C1.95203 13.5201 3.02968 14.5 4.31857 14.5H7.68143C8.97032 14.5 10.048 13.5201 10.1702 12.237L10.9546 4H11.5C11.7761 4 12 3.77614 12 3.5C12 3.22386 11.7761 3 11.5 3H9V2C9 1.17157 8.32843 0.5 7.5 0.5H4.5ZM8 3V2C8 1.72386 7.77614 1.5 7.5 1.5H4.5C4.22386 1.5 4 1.72386 4 2V3H8ZM2.04988 4H9.95012L9.17467 12.1422C9.10135 12.9121 8.45476 13.5 7.68143 13.5H4.31857C3.54524 13.5 2.89865 12.9121 2.82533 12.1422L2.04988 4Z",stroke:"none"}));var pe=i(42636);const he=({style:e,contentStyle:t,children:i,header:r})=>n.createElement("div",{className:a.ux.style(ge,e)},r,n.createElement("div",{className:a.ux.style(fe,t)},i)),ge={background:"white",display:"flex",flexDirection:"column",gap:a.ux.rem(o.x)},fe={display:"flex",flexDirection:"row",flexWrap:"wrap",gap:a.ux.rem(o.x)};var ve=i(63501);const ye=r.UI.List.make(s.bw,ve.G);var be=i(12187),xe=i(32952),ke=i(55721),Se=i(28043),Ce=i(60797),we=i(85985);function _e(e,t=0){const i=function(e){return e.trim().replace(/\s+/g," ")}(e).split(" ").reduce(((e,i,n,r)=>Object.assign(Object.assign({},e),{head:n<r.length-t?e.head.concat(i):e.head,tail:n>=r.length-t?e.tail.concat(i):e.tail})),{head:[],tail:[]});return{head:i.head.join(" "),tail:i.tail.join(" ")}}const Ie=({children:e,maxTailWordsCount:t=0})=>{const i=_e(e,t);return n.createElement("div",{className:Ae},n.createElement("span",{className:Oe},i.head,i.head.length&&i.tail.length?" ":null),i.tail.length?i.tail:null)},Ee=({children:e,maxTailWordsCount:t=0})=>{const[i,r]=n.useState(t),{onMount:s,rect:o}=O.P.useRectWatcher(),a=n.useRef(null),l=n.useMemo((()=>_e(e,i)),[i]),c=n.useMemo((()=>new xe.xQ),[]);O.P.useSubscriptionTo(n.useMemo((()=>c.pipe(ke.p(100),Se.x(),R.b((e=>{r(e)})))),[]));const u=n.useMemo((()=>{return e=a.current,parseInt((null===(n=null===(i=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===i?void 0:i.getComputedStyle(e))||void 0===n?void 0:n.fontSize)||(null===(s=null===(r=null==e?void 0:e.ownerDocument)||void 0===r?void 0:r.defaultView)||void 0===s?void 0:s.getComputedStyle(e.ownerDocument.body).fontSize)||Re,10);var e,t,i,n,r,s}),[a.current]);return O.P.useSubscriptionTo(n.useMemo((()=>o.pipe(Ce.oA,Se.x(),we.h((e=>Boolean(e.width&&e.height))),R.b((e=>{if(e.width<9*u)c.next(0);else if(a.current&&a.current.clientWidth<a.current.scrollWidth){const n=a.current.clientWidth/(e.width||1/0);i&&n<.4?c.next(i-1):n>.6&&i<t&&c.next(i+1)}})))),[o])),n.createElement("div",{className:Ae,ref:s},n.createElement("span",{className:Oe,ref:a},l.head,l.head.length&&l.tail.length?" ":null),l.tail.length?l.tail:null)},Ae=a.ux.style({display:"flex",flexDirection:"row",whiteSpace:"nowrap",maxWidth:"100%",minWidth:0}),Oe=a.ux.style({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",flexShrink:10}),Re="16px";const Ue=(0,be.xb)((({dynamic:e=!1,maxTailWordsCount:t=0,children:i})=>e?n.createElement(Ee,{maxTailWordsCount:t},i):n.createElement(Ie,{maxTailWordsCount:t},i))),Te=({active:e,children:t})=>n.createElement("h1",{className:Pe},e?n.createElement("svg",{viewBox:"0 0 16 16",fill:"none",className:Be,"aria-hidden":"true"},n.createElement("rect",{width:"16",height:"16",rx:"5",fill:"#018374"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 13.5C9.5 13.7761 9.72386 14 10 14H11C12.6569 14 14 12.6569 14 11V10C14 9.72386 13.7761 9.5 13.5 9.5C13.2239 9.5 13 9.72386 13 10V11C13 12.1046 12.1046 13 11 13H10C9.72386 13 9.5 13.2239 9.5 13.5ZM9.5 2.5C9.5 2.77614 9.72386 3 10 3H11C12.1046 3 13 3.89543 13 5V6C13 6.27614 13.2239 6.5 13.5 6.5C13.7761 6.5 14 6.27614 14 6V5C14 3.34315 12.6569 2 11 2H10C9.72386 2 9.5 2.22386 9.5 2.5ZM6 2C6.27614 2 6.5 2.22386 6.5 2.5C6.5 2.77614 6.27614 3 6 3H5C3.89543 3 3 3.89543 3 5V6C3 6.27614 2.77614 6.5 2.5 6.5C2.22386 6.5 2 6.27614 2 6V5C2 3.34315 3.34315 2 5 2H6ZM6 13C6.27614 13 6.5 13.2239 6.5 13.5C6.5 13.7761 6.27614 14 6 14H5C3.34315 14 2 12.6569 2 11V10C2 9.72386 2.22386 9.5 2.5 9.5C2.77614 9.5 3 9.72386 3 10V11C3 12.1046 3.89543 13 5 13H6ZM5.5 6.5C5.5 6.22386 5.72386 6 6 6H10C10.2761 6 10.5 6.22386 10.5 6.5C10.5 6.77614 10.2761 7 10 7H6C5.72386 7 5.5 6.77614 5.5 6.5ZM6 9C5.72386 9 5.5 9.22386 5.5 9.5C5.5 9.77614 5.72386 10 6 10H8.5C8.77614 10 9 9.77614 9 9.5C9 9.22386 8.77614 9 8.5 9H6Z",fill:"white"})):n.createElement("svg",{viewBox:"0 0 16 16",fill:"none",className:Be,"aria-hidden":"true"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 13.5C9.5 13.7761 9.72386 14 10 14H11C12.6569 14 14 12.6569 14 11V10C14 9.72386 13.7761 9.5 13.5 9.5C13.2239 9.5 13 9.72386 13 10V11C13 12.1046 12.1046 13 11 13H10C9.72386 13 9.5 13.2239 9.5 13.5ZM9.5 2.5C9.5 2.77614 9.72386 3 10 3H11C12.1046 3 13 3.89543 13 5V6C13 6.27614 13.2239 6.5 13.5 6.5C13.7761 6.5 14 6.27614 14 6V5C14 3.34315 12.6569 2 11 2H10C9.72386 2 9.5 2.22386 9.5 2.5ZM6 2C6.27614 2 6.5 2.22386 6.5 2.5C6.5 2.77614 6.27614 3 6 3H5C3.89543 3 3 3.89543 3 5V6C3 6.27614 2.77614 6.5 2.5 6.5C2.22386 6.5 2 6.27614 2 6V5C2 3.34315 3.34315 2 5 2H6ZM6 13C6.27614 13 6.5 13.2239 6.5 13.5C6.5 13.7761 6.27614 14 6 14H5C3.34315 14 2 12.6569 2 11V10C2 9.72386 2.22386 9.5 2.5 9.5C2.77614 9.5 3 9.72386 3 10V11C3 12.1046 3.89543 13 5 13H6ZM5.5 6.5C5.5 6.22386 5.72386 6 6 6H10C10.2761 6 10.5 6.22386 10.5 6.5C10.5 6.77614 10.2761 7 10 7H6C5.72386 7 5.5 6.77614 5.5 6.5ZM6 9C5.72386 9 5.5 9.22386 5.5 9.5C5.5 9.77614 5.72386 10 6 10H8.5C8.77614 10 9 9.77614 9 9.5C9 9.22386 8.77614 9 8.5 9H6Z",fill:"#646B81"})),n.createElement(Ue,{dynamic:!0,maxTailWordsCount:3},t)),Be=a.ux.style({width:a.ux.rem(1),height:a.ux.rem(1)}),Pe=a.ux.style({display:"grid",gridTemplateColumns:`${a.ux.rem(1)} auto`,justifyItems:"start",alignItems:"center",gap:a.ux.rem(o.x),color:l.XY.Content.Secondary.Default,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",fontWeight:"normal",margin:0}),Ne=r.UI.Grid.make((({slots:e,state:t})=>n.createElement(m.F.Fragment,null,t.pipe(u.U((({label:t,view:i})=>i===pe.aU.Store.View.normal?n.createElement(he,{header:e.header,style:Me,key:t},e.actions):i===pe.aU.Store.View.pinned?n.createElement(he,{style:Ke,key:t},e.actions):(0,d.L0)(i))))))),ze=r.UI.Node.make((({view:e})=>n.createElement(ue,null,e("label")))),Ge=r.UI.Node.make((({view:e,notify:t})=>n.createElement("div",{className:Ve},n.createElement(Te,{active:!0},e("label")),n.createElement(j.z.Tertiary,{onClick:t({kind:P.i.Kind.removeSelectionContextClick}),compact:!0,size:"small",name:"removeContext",title:"Delete"},n.createElement(me,{className:He}))))),je=r.UI.Union.make("kind",{default:ze,withSelectionContext:Ge}),Fe=r.UI.Knot.make(Ne,{actions:ye,header:je}),De=r.UI.List.make(s.bw,Fe),Me={background:"transparent",padding:`${a.ux.rem(o.x)} 0`},Ve=a.ux.style({display:"grid",gridTemplateColumns:`auto ${a.ux.rem(1)}`,justifyItems:"start",alignItems:"center",alignContent:"center",gap:a.ux.rem(o.x),paddingRight:a.ux.rem(o.x),height:a.ux.rem(1)}),Le="ignoreIcon",He=a.ux.joinClasses([Le,a.ux.style((0,v.dD)((0,v.fx)(1.5),Le))]),Ke=Object.assign(Object.assign({},Me),{padding:`${a.ux.rem(o.x)} 0`,marginTop:a.ux.rem(-1*o.x),borderTop:`1px solid ${h.NeutralGray0}`}),$e=r.UI.Union.asOption(r.UI.Composite.make(r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:We},e.content))),(0,A.zG)(De,r.UI.patch("header")((()=>r.UI.Union.make("kind",{default:ze,withSelectionContext:ze})))))),We=a.ux.style({padding:`${a.ux.rem(o.F2)} ${a.ux.rem(o.qp)}`}),Ze=r.UI.List.make(s.bw,ve.G),qe=r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Xe},e.customPromptGo,n.createElement("div",{className:Qe},e.searchResults)))),Ye=r.UI.Knot.make(qe,{searchResults:Ze,customPromptGo:ve.G}),Xe=a.ux.style({background:"transparent",padding:a.ux.rem(o.qp),display:"flex",flexDirection:"column",alignItems:"flex-start",gap:a.ux.rem(o.x)}),Qe=a.ux.style({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:a.ux.rem(o.x)}),Je=r.UI.Union.make("kind",{searchResults:Ye,actionsStore:$e}),et=r.UI.Knot.make(r.UI.Grid.make((({slots:e,notify:t})=>n.createElement(m.F.div,{className:it},n.createElement(j.z.Tertiary,{compact:!0,className:nt,onClick:t({kind:P.i.Kind.collapsePromptMenuButtonClick}),name:"collapsePromptMenu",size:"small"},n.createElement(g.JO.Arrow,{direction:g.n4.down,className:ot})),n.createElement("div",{ref:e=>e&&t({kind:P.i.Kind.mount,name:N.e.promptMenuContent,element:e})(),onKeyDown:e=>{"ArrowDown"===e.key?t({kind:P.i.Kind.promptMenuKeyPressArrowDown})():"ArrowUp"===e.key&&t({kind:P.i.Kind.promptMenuKeyPressArrowUp})()}},e.content)))),{content:Je}),tt=r.UI.Union.asOption(et),it=a.ux.style({overflowY:"scroll",borderBottom:`0.5px solid ${l.XY.Boundaries.Secondary.Default}`}),nt=a.ux.style({position:"absolute",top:a.ux.rem(o.x),right:a.ux.rem(o.x),zIndex:1,$nest:{"&:not(:hover)":{backgroundColor:a.ux.important(h.White)}}}),rt="arrowIcon",st=(0,v.dD)((0,v.fx)(1.5),rt),ot=a.ux.joinClasses([rt,a.ux.style(st)]),at=r.UI.Grid.make((({slots:e,view:t,notify:i})=>{const{onMount:r,rect:s}=O.P.useRectWatcher(),{notifyUnmount:o}=n.useContext(G),{ref:a,onMount:l}=(0,B.F)((0,A.ls)(R.b((e=>i({kind:P.i.Kind.mount,name:N.e.promptInputAndMenuContainer,element:e})())),U.x((()=>o({kind:P.i.Kind.unmount,name:N.e.promptInputAndMenuContainer})))));return n.createElement(m.F.div,{className:ut},n.createElement(m.F.div,{mount:l,className:mt,"data-expanded":t("menuExpanded"),onFocus:()=>{var e;return i({kind:P.i.Kind.promptFieldAndMenuFocusChange,focused:(null===(e=E.toNullable(a.get()))||void 0===e?void 0:e.contains((0,z.vY)(document)))||!1})()},onBlur:()=>{var e;return i({kind:P.i.Kind.promptFieldAndMenuFocusChange,focused:(null===(e=E.toNullable(a.get()))||void 0===e?void 0:e.contains((0,z.vY)(document)))||!1})()}},e.promptMenu,n.createElement("div",{ref:r},e.promptField)),T.aj([s,t("menuExpanded")]).pipe(u.U((([e,t])=>(0,A.zG)(e,E.filter((()=>t)),E.fold(A.gn,(({height:e})=>n.createElement("div",{className:pt,style:{height:e},role:"presentation"}))))))))})),lt=r.UI.Knot.make(at,{promptField:ce,promptHeader:r.UI.Node.empty,promptMenu:tt}),ct=r.UI.Union.asOption(lt),ut=a.ux.style({position:"relative",margin:`${a.ux.rem(o.x)} ${a.ux.rem(o.x)} 0 ${a.ux.rem(o.x)}`}),dt=e=>a.ux.color(h.BlueGray40).toRGBA().fade(e).toString(),mt=a.ux.style({background:"white",boxShadow:`0px 0px 0px 0.5px ${h.BlueGray40}, 0px 0px 2px 0.5px ${dt(.5)}, 0px 1px 6px 0.5px ${dt(.25)}`,borderRadius:a.ux.rem(c.xB+c.fe),$nest:{"&[data-expanded='true']":{position:"absolute",bottom:0,width:"100%",display:"grid",gridTemplateRows:"1fr auto"}}}),pt=a.ux.style({opacity:0,pointerEvents:"none",visibility:"hidden"});var ht=i(99094),gt=i(76974),ft=i(93508),vt=i(8125),yt=i(38983),bt=i(66310),xt=i(85089);function kt(e){return n.useMemo((()=>e.pipe(bt.w(E.fold((()=>gt.of(E.none)),(e=>xt.YC(e).pipe(ft.O(e),u.U((()=>E.some(e.getBoundingClientRect()))))))))),[e])}var St=i(73975),Ct=i(12271),wt=i(19751),_t=i(66081);var It=i(33498);const Et=e=>{var t,i,r;const s=n.useMemo((()=>{var t;return(0,It.D)(null!==(t=e.menuRef)&&void 0!==t?t:gt.of(E.none))}),[e.menuRef]),o=n.useMemo((()=>{var t;return(0,It.D)(null!==(t=e.scrollContentToBottomToken)&&void 0!==t?t:gt.of(E.none))}),[e.scrollContentToBottomToken]),{onMount:l,ref:c}=O.P.useElWatcher(),{onMount:d,ref:p}=O.P.useElWatcher();!function(e,t){const i=n.useMemo((()=>T.aj([t.pipe(Ce.oA,u.U((e=>E.fromNullable((0,z.$Q)(e,3)))),Ce.oA),e.pipe(wt.skipBy(E.getEq(St.w4)))]).pipe(_t.e(0),u.U(Ct.li),R.b((e=>{e.scrollTop=e.scrollHeight-e.clientHeight})))),[t]);O.P.useSubscriptionTo(i)}(o,p);const h=kt(c),g=kt(s),f=n.useMemo((()=>yt.h.create(!1)),[]),v=n.useMemo((()=>p.pipe(u.U(E.fold((()=>{f.set(!1)}),(e=>{f.set(e.scrollTop>0)}))))),[p]),y=n.useMemo((()=>T.aj([g,(0,It.D)(e.maxHeight),(0,It.D)(e.menuVerticalMargin)]).pipe(u.U((([e,t,i])=>(0,A.zG)(e,E.fold((()=>({sentinelHeight:void 0,menuMaxHeight:void 0})),(e=>{const n=e.height+(null!=i?i:0);return{sentinelHeight:(0,A.zG)(t,E.fold((()=>n),(e=>Math.min(e,n)))),menuMaxHeight:(0,A.zG)(t,E.map((e=>e-(null!=i?i:0))),E.toUndefined)}}))))),ft.O({sentinelHeight:void 0,menuMaxHeight:void 0}))),[g,h]),b=n.useMemo((()=>s.pipe(Ce.cp((e=>y.pipe(R.b((({menuMaxHeight:t})=>{e.style.setProperty("max-height",`${t}px`)}))))))),[y,s]);return O.P.useSubscriptionTo(v),O.P.useSubscriptionTo(y),O.P.useSubscriptionTo(b),n.createElement(m.F.div,{dir:"ltr","data-grammarly-part":"assistant","data-dragging":e.dragging,onFocus:e.onFocus,onBlur:e.onBlur,className:(0,It.D)(null!==(t=e.containerClassName)&&void 0!==t?t:gt.of(void 0)).pipe(u.U((e=>a.ux.joinClasses([Ut,e])))),style:T.aj([(0,It.D)(null!==(i=e.containerStyle)&&void 0!==i?i:gt.of(void 0)),(0,It.D)(e.maxHeight).pipe(u.U(E.toUndefined),ft.O(void 0))]).pipe(u.U((([e,t])=>Object.assign(Object.assign({},e),{maxHeight:t})))),mount:t=>{var i;l(t),null===(i=e.onMountContainer)||void 0===i||i.call(e,t)}},n.createElement(m.F.header,{className:f.view((t=>a.ux.joinClasses([Dt,e.headerClassName,t?Mt:void 0,e.draggingEnabled?Vt:void 0]))),mount:e.onMountHeader},e.header),n.createElement("div",{className:Bt},n.createElement(m.F.div,{className:f.view((0,vt.RN)(zt,Nt))},e.notifications)),n.createElement(m.F.main,{mount:d,className:a.ux.joinClasses([Tt,e.contentClassName]),onScroll:e=>f.set(e.currentTarget.scrollTop>0),style:{overflowY:(0,It.D)(null!==(r=e.canScrollContent)&&void 0!==r?r:gt.of(!0)).pipe(u.U((0,vt.RN)("auto","hidden")))}},e.content),n.createElement("footer",{className:a.ux.joinClasses([jt,e.footerClassName])},e.footer),n.createElement(m.F.Fragment,null,y.pipe(u.U((({sentinelHeight:e})=>e?n.createElement("div",{key:"sentinel",className:Ft,role:"presentation",style:{height:e}}):null)))))},At="content",Ot="header",Rt="#FCFCFC",Ut=a.ux.style({fontFamily:"Inter, sans-serif",padding:0,margin:0,display:"grid",gridTemplateColumns:"1fr 0",gridTemplateRows:"auto 0 1fr auto",gridTemplateAreas:'"header sentinel" "notifications sentinel" "content sentinel" "footer sentinel"',background:"linear-gradient(180deg, #FCFCFC 0%, #FCFCFC 100%)",$nest:{"&[data-dragging='true']":{cursor:"grabbing",$nest:{[`.${At}`]:{pointerEvents:"none"},[`.${Ot}`]:{pointerEvents:"none"}}}}}),Tt=a.ux.joinClasses([At,a.ux.style({gridArea:"content",padding:`0 ${a.ux.rem(o.x)}`,display:"flex",flexDirection:"column",gap:a.ux.rem(o.x)})]),Bt=a.ux.style({position:"relative",gridArea:"notifications"}),Pt={zIndex:1e3,position:"absolute",right:a.ux.rem(o.x)},Nt=a.ux.style(Object.assign(Object.assign({},Pt),{top:0})),zt=a.ux.style(Object.assign(Object.assign({},Pt),{top:a.ux.rem(o.F2)})),Gt=o.x,jt=a.ux.style({gridArea:"footer",paddingBottom:a.ux.rem(Gt)}),Ft=a.ux.style({gridArea:"sentinel",visibility:"hidden"}),Dt=a.ux.joinClasses([Ot,a.ux.style({gridArea:"header",display:"flex",alignItems:"center",justifyContent:"space-between",gap:a.ux.rem(o.F2),padding:`0 ${a.ux.rem(o.x)}`,height:a.ux.rem(2.5),boxSizing:"content-box",position:"relative","--grammarly-app-region":"drag",$nest:{button:{"--grammarly-app-region":"no-drag"}}})]),Mt=a.ux.style({borderBottom:`0.5px solid ${h.BlueGray10}`}),Vt=a.ux.style({cursor:"grab"}),Lt=n.createContext({portalContainer:yt.h.create(E.none)});var Ht=i(74204),Kt=i(32207),$t=i(34530);function Wt(e,t,i){const[r,s]=n.useState(null),[o,a]=n.useState(null),l="initial"===(null==r?void 0:r.kind)?r:void 0,c=(u=i,n.useMemo((()=>({name:"maxSize",phase:"main",enabled:!0,requiresIfExists:["offset","preventOverflow","flip"],fn({state:e,name:t}){const i=(0,$t.Z)(e),{x:n,y:r}=e.modifiersData.preventOverflow||{x:0,y:0},{width:s,height:o}=e.rects.popper,[a]=e.placement.split("-"),l="top"===a?"top":"bottom",c={width:s-i["left"===a?"left":"right"]-n,height:o-i[l]-r};e.modifiersData[t]=c,null==u||u(c)}})),[]));var u;const d=(0,Kt.n)(),m=n.useMemo((()=>yt.h.create({})),[]),{styles:p}=(0,Ht.D)(null==l?void 0:l.referenceElement,o,{placement:null==l?void 0:l.placement,modifiers:[c,{name:"preventOverflow",options:{padding:5,mainAxis:!0,altAxis:!0,tether:!1}},d,...(0,A.zG)((null==l?void 0:l.offset)||E.none,E.fold((()=>[]),(e=>[{name:"offset",options:{offset:e}}])))]});return n.useEffect((()=>{m.set(null===r?{}:"initial"===r.kind?p.popper:{position:"fixed",top:r.referencePosition.top,left:r.referencePosition.left,bottom:r.referencePosition.bottom,right:r.referencePosition.right,transform:`translate(${r.translation.x}px, ${r.translation.y}px)`})}),[p,r]),O.P.useSubscriptionTo(t.pipe(R.b(s))),O.P.useSubscriptionTo(e.pipe(R.b((0,A.ls)(E.toNullable,a)))),{styles:m}}const Zt=e=>a.ux.color(h.BlueGray40).toRGBA().fade(e).toString(),qt={width:a.ux.rem(26.875),borderRadius:a.ux.rem(c.ze)},Yt=Object.assign(Object.assign({},qt),{boxShadow:`0px 0px 0px 0.5px ${h.BlueGray40}, 0px 0px 2px 0.5px ${Zt(.5)}, 0px 1px 8px 0.5px ${Zt(.1)}, 0px 2px 12px 0.5px ${Zt(.1)}, 0px 4px 20px 0.5px ${Zt(.25)}`,backdropFilter:`blur(${a.ux.rem(.34375)})`}),Xt={maxWidth:a.ux.rem(40),minWidth:a.ux.rem(18),width:a.ux.percent(100)},Qt=a.ux.style(Yt),Jt=(a.ux.style(Yt,Xt),a.ux.style(qt,Xt),r.UI.Grid.make((({slots:e,state:t,notify:i})=>{const{ref:r,onMount:s}=O.P.useElWatcher(),{styles:o}=Wt(r,t.pipe(u.U((e=>"none"===e.kind?null:e))),(e=>i({kind:"maxSize",maxSize:e})())),a=n.useContext(L.u.Context);return n.createElement(Lt.Provider,{value:{portalContainer:r}},n.createElement(ht.f.Context.Provider,{value:ht.f.emptyWithName("cheetahAssistant")},n.createElement(m.F.Fragment,null,t.pipe(u.U((e=>e.kind)),Se.x(),u.U((r=>"none"===r?null:n.createElement(Et,{key:"assistant-container",onFocus:i({kind:"focus",focused:!0}),onBlur:i({kind:"focus",focused:!1}),draggingEnabled:!0,dragging:t.pipe(u.U((e=>"dragged"===e.kind&&e.dragging))),maxHeight:t.pipe(u.U((e=>e.maxHeight))),menuRef:t.pipe(u.U((e=>e.menuRef))),containerStyle:o,menuVerticalMargin:a.pipe(u.U((e=>(2.5+Gt)*e))),scrollContentToBottomToken:t.pipe(u.U((e=>e.scrollContentToBottomToken))),canScrollContent:t.pipe(u.U((e=>e.canScrollContent))),containerClassName:Qt,onMountContainer:e=>{e&&(i({kind:"mount",element:e})(),s(e))},onMountHeader:e=>e&&i({kind:"dragHandleMount",element:e})(),header:e.header,content:e.content,footer:e.footer,notifications:e.notifications})))))))})));var ei=i(18208),ti=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const ii=n.forwardRef((function(e,t){var{children:i,style:r}=e,s=ti(e,["children","style"]);return n.createElement("section",Object.assign({className:a.ux.style({display:"flex",flexDirection:"column",padding:a.ux.rem(o.qp),gap:a.ux.rem(o.x),background:"transparent",border:`0.5px solid ${h.BlueGray10}`,borderRadius:a.ux.rem(c.xB+c.fe),backgroundColor:l.XY.Surface.Primary.Default,color:l.XY.Content.Primary.Default},r)},s,{ref:t}),i)}));var ni=i(72004);const ri=e=>n.createElement(g.a1,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),n.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_4506_11023_disheartening_emoji)",stroke:"none"}),n.createElement("path",{d:"M8.97126 19.5491C10.9569 18.1193 14.0431 18.1193 16.0295 19.5491C16.3344 19.7674 16.5155 19.5315 16.4184 19.3455C14.4879 15.6555 10.5121 15.6555 8.58164 19.3455C8.48451 19.5315 8.66564 19.7674 8.97126 19.5491Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M19.895 12.8239C17.9806 13.5491 15.4865 12.8809 14.1909 11.2954C13.9925 11.0531 13.7945 11.2046 13.8328 11.376C14.5936 14.775 17.807 15.6364 20.1654 13.0721C20.2839 12.9435 20.1886 12.7133 19.895 12.8239Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M10.8091 11.2954C9.51351 12.8813 7.01976 13.5491 5.10501 12.8239C4.81176 12.7133 4.71614 12.9431 4.83464 13.0721C7.19301 15.6364 10.4064 14.775 11.1673 11.376C11.2059 11.2046 11.0079 11.0531 10.8091 11.2954Z",fill:"#302C3B",stroke:"none"}),n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_4506_11023_disheartening_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFA027"}),n.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),n.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),n.createElement("stop",{offset:"1",stopColor:"#FFE261"})))),si=e=>n.createElement(g.a1,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),n.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_4506_11027_neutral_emoji)",stroke:"none"}),n.createElement("path",{d:"M17.3266 17.25H7.6726C6.7336 17.25 6.7336 15.75 7.6726 15.75H17.3266C18.2656 15.75 18.2656 17.25 17.3266 17.25Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M8.7496 12.1875C9.68158 12.1875 10.4371 11.1801 10.4371 9.9375C10.4371 8.69486 9.68158 7.6875 8.7496 7.6875C7.81762 7.6875 7.0621 8.69486 7.0621 9.9375C7.0621 11.1801 7.81762 12.1875 8.7496 12.1875Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M16.2496 12.1875C17.1816 12.1875 17.9371 11.1801 17.9371 9.9375C17.9371 8.69486 17.1816 7.6875 16.2496 7.6875C15.3176 7.6875 14.5621 8.69486 14.5621 9.9375C14.5621 11.1801 15.3176 12.1875 16.2496 12.1875Z",fill:"#302C3B",stroke:"none"}),n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_4506_11027_neutral_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFA027"}),n.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),n.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),n.createElement("stop",{offset:"1",stopColor:"#FFE261"})))),oi=e=>n.createElement(g.a1,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),n.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_11994_841_smiling_emoji)",stroke:"none"}),n.createElement("path",{d:"M5.82085 15.8453C7.89191 15.8453 9.57085 14.1663 9.57085 12.0953C9.57085 10.0242 7.89191 8.34528 5.82085 8.34528C3.74978 8.34528 2.07085 10.0242 2.07085 12.0953C2.07085 14.1663 3.74978 15.8453 5.82085 15.8453Z",fill:"url(#paint1_radial_11994_841_smiling_emoji)",stroke:"none"}),n.createElement("path",{d:"M19.1792 15.75C21.2502 15.75 22.9292 14.0711 22.9292 12C22.9292 9.92893 21.2502 8.25 19.1792 8.25C17.1081 8.25 15.4292 9.92893 15.4292 12C15.4292 14.0711 17.1081 15.75 19.1792 15.75Z",fill:"url(#paint2_radial_11994_841_smiling_emoji)",stroke:"none"}),n.createElement("path",{d:"M14.0844 9.3015C15.5 7.72425 17.7012 7.7235 19.1176 9.3015C19.3344 9.543 19.4634 9.282 19.3944 9.07725C18.0181 5.0055 15.1831 5.0055 13.8069 9.07725C13.7379 9.282 13.8669 9.54262 14.0844 9.3015Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M5.88312 9.3015C7.29949 7.72425 9.49999 7.7235 10.9164 9.3015C11.1331 9.543 11.2629 9.282 11.1931 9.07725C9.81687 5.0055 6.98187 5.0055 5.60562 9.07725C5.53699 9.282 5.66562 9.54262 5.88312 9.3015Z",fill:"#302C3B",stroke:"none"}),n.createElement("path",{d:"M17.1961 13.647C14.3352 15.7061 10.6614 15.705 7.802 13.647C7.397 13.356 7.15512 13.6706 7.28487 13.9178C9.4805 18.1151 15.5187 18.1144 17.7147 13.9178C17.8437 13.6703 17.6026 13.3556 17.1961 13.647Z",fill:"#302C3B",stroke:"none"}),n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_11994_841_smiling_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#FFA027"}),n.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),n.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),n.createElement("stop",{offset:"1",stopColor:"#FFE261"})),n.createElement("radialGradient",{id:"paint1_radial_11994_841_smiling_emoji",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.82103 12.0952) scale(3.75 3.75)"},n.createElement("stop",{stopColor:"#F18D84"}),n.createElement("stop",{offset:"0.2514",stopColor:"#F29180",stopOpacity:"0.7486"}),n.createElement("stop",{offset:"0.5118",stopColor:"#F49E73",stopOpacity:"0.4882"}),n.createElement("stop",{offset:"0.7755",stopColor:"#F8B25F",stopOpacity:"0.2245"}),n.createElement("stop",{offset:"1",stopColor:"#FDCA47",stopOpacity:"0"})),n.createElement("radialGradient",{id:"paint2_radial_11994_841_smiling_emoji",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(19.179 12) scale(3.75)"},n.createElement("stop",{stopColor:"#F18D84"}),n.createElement("stop",{offset:"0.2514",stopColor:"#F29180",stopOpacity:"0.7486"}),n.createElement("stop",{offset:"0.5118",stopColor:"#F49E73",stopOpacity:"0.4882"}),n.createElement("stop",{offset:"0.7755",stopColor:"#F8B25F",stopOpacity:"0.2245"}),n.createElement("stop",{offset:"1",stopColor:"#FDCA47",stopOpacity:"0"})))),ai=(e,t)=>(0,be.Sh)(ci,e===t&&ui),li=a.ux.style({display:"flex",flexDirection:"row",justifyContent:"space-between",paddingLeft:a.ux.rem(o.mh),paddingRight:a.ux.rem(o.mh)}),ci=a.ux.style({width:a.ux.rem(5),height:a.ux.rem(5),cursor:"pointer",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",gap:a.ux.rem(o.x),borderRadius:a.ux.rem(c.HP),fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),$nest:{"&:hover":{backgroundColor:l.XY.Surface.Secondary.Default}}}),ui=a.ux.style({backgroundColor:h.Blue10,$nest:{"&:hover":{backgroundColor:h.Blue10}}}),di=a.ux.style(Object.assign({},(0,v.fx)(1.5))),mi="submitBtn",pi={padding:a.ux.rem(o.mh),gap:a.ux.rem(o.mh)},hi={color:l.XY.Content.Primary.Default,fontWeight:700,fontSize:a.ux.rem(1.25),lineHeight:a.ux.rem(1.5),margin:0},gi={border:`${a.ux.px(1)} solid ${h.NeutralGray20}`,borderRadius:a.ux.rem(c.xB),padding:`${a.ux.rem(o.x+o.yC)} ${a.ux.rem(o.x)}`,height:a.ux.rem(8)},fi={display:"flex",alignItems:"flex-start",$nest:{"& input[type='checkbox']":{margin:`${a.ux.rem(o.W9)} ${a.ux.rem(o.x)} 0 0`,minWidth:a.ux.rem(1),minHeight:a.ux.rem(1)},"& label":{color:l.XY.Content.Primary.Default,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125)}}},vi=Object.assign({width:a.ux.percent(100)},(0,v.dD)({fontSize:a.ux.rem(.875)},mi)),yi={display:"flex",flexDirection:"column",gap:a.ux.rem(o.x)},bi=pi,xi=a.ux.style(hi),ki=a.ux.style(gi),Si=a.ux.style(fi),Ci=(a.ux.style({fontWeight:700}),a.ux.joinClasses([mi,a.ux.style(vi)])),wi=a.ux.style(yi),_i=(0,be.xb)((({selectedScore:e,onSelectScore:t})=>n.createElement("div",{className:li},n.createElement("div",Object.assign({},ai(ni.x.Mood.dissatisfied,e),{onClick:()=>t(ni.x.Mood.dissatisfied)}),n.createElement(ri,{className:di}),"I dislike it"),n.createElement("div",Object.assign({},ai(ni.x.Mood.ok,e),{onClick:()=>t(ni.x.Mood.ok)}),n.createElement(si,{className:di}),"It′s OK"),n.createElement("div",Object.assign({},ai(ni.x.Mood.satisfied,e),{onClick:()=>t(ni.x.Mood.satisfied)}),n.createElement(oi,{className:di}),"I like it!")))),Ii=(0,be.xb)(q),Ei=(0,be.xb)(ii),Ai=r.UI.Node.make((({state:e,view:t,notify:i})=>{const r="domainCheckbox"+ei.fg(5);return n.createElement(Ei,{style:bi},n.createElement("h1",{className:xi},"How do you like Grammarly?"),n.createElement(_i,{selectedScore:t("formData").pipe(u.U((e=>e.mood))),onSelectScore:e=>i({kind:P.i.Kind.feedbackFormChange,feedbackData:{mood:e}})()}),n.createElement(Ii,{ariaLabel:"tell us why",className:ki,placeholder:["How can we improve?"],fitContentHeight:!1,text:t("formData").pipe(u.U((({message:e})=>null!=e?e:""))),onChange:e=>i({kind:P.i.Kind.feedbackFormChange,feedbackData:{message:e}})()}),e.pipe(u.U((({formData:e,domain:t,source:s})=>n.createElement("div",{className:wi},(0,A.zG)(t,E.fold(A.gn,(t=>n.createElement("div",{className:Si},n.createElement("input",{type:"checkbox",id:r,checked:void 0!==e.domain,onChange:i({kind:P.i.Kind.feedbackFormChange,feedbackData:{domain:void 0!==e.domain?void 0:t}})}),n.createElement("label",{htmlFor:r},"Include the domain ",n.createElement("b",null,t)," with my feedback to help improve Grammarly."))))),(0,A.zG)(E.fromNullable(void 0!==e.mood?Object.assign(Object.assign({},e),{mood:e.mood,source:s}):null),E.fold((()=>n.createElement(j.z.Primary,{disabled:!0,className:Ci,onClick:A.Q1},"Submit")),(e=>n.createElement(j.z.Primary,{disabled:!1,className:Ci,onClick:i({kind:P.i.Kind.feedbackFormSubmitButtonClick,feedbackData:e})},"Submit")))))))))}));var Oi=i(17889);const Ri=e=>n.createElement(g.a1,{className:e.className,viewBox:"0 0 20 20",width:20,height:20},n.createElement("path",{d:"M8.58541 3.37143C9.36646 2.59038 10.6328 2.59038 11.4138 3.37143L16.6283 8.5859C17.4094 9.36695 17.4094 10.6333 16.6283 11.4143L11.4138 16.6288C10.6328 17.4098 9.36646 17.4098 8.58541 16.6288L3.37094 11.4143C2.58989 10.6333 2.58989 9.36695 3.37094 8.5859L8.58541 3.37143ZM11.4371 6.25011C11.4371 5.4562 10.7935 4.81261 9.99962 4.81261C9.20571 4.81261 8.56212 5.4562 8.56212 6.25011V10.6251C8.56212 11.3163 9.04996 11.8936 9.70011 12.0314C9.04996 12.1692 8.56212 12.7464 8.56212 13.4376C8.56212 14.2315 9.20571 14.8751 9.99962 14.8751C10.7935 14.8751 11.4371 14.2315 11.4371 13.4376C11.4371 12.7464 10.9493 12.1692 10.2991 12.0314C10.9493 11.8936 11.4371 11.3163 11.4371 10.6251V6.25011Z",fill:"#D31332",stroke:"#D31332"})),Ui=({options:e,onSubmit:t,onCancel:i})=>{const[r,o]=n.useState(E.none),[l,c]=n.useState(!1);return n.createElement(m.F.form,{id:"radioOptionsForm",onSubmit:e=>{(0,A.zG)(r,E.fold((()=>c(!0)),t)),e.preventDefault()},className:a.ux.style(Ti)},n.createElement("fieldset",{className:Gi,style:{borderColor:l?h.Red60:"transparent"}},(0,A.zG)(e,s.UI((e=>n.createElement("span",{key:e,className:Bi},n.createElement("input",{type:"radio",id:e,value:e,name:e,checked:(0,A.zG)(r,E.filter((t=>t===e)),E.isSome),onChange:()=>{c(!1),o(E.some(e))},style:{margin:`0 ${a.ux.rem(.5)} 0 0`}}),n.createElement("label",{htmlFor:e},e)))))),l&&n.createElement("div",{className:zi},n.createElement(Ri,{className:Ni})," Make a selection"),n.createElement("div",{className:Pi},n.createElement(j.z.Primary,{type:"submit",form:"radioOptionsForm",name:"submitSelectedRadioOption",style:{base:Ti}},"Submit"),"  ",n.createElement(j.z.Tertiary,{onClick:i,name:"cancelRadioOptionSelection",style:{base:Ti}},"Cancel")))},Ti={fontSize:a.ux.rem(.875)},Bi=a.ux.style({display:"inline-flex",alignItems:"center"}),Pi=a.ux.style({paddingTop:a.ux.rem(.5)}),Ni=a.ux.style({minWidth:"unset",minHeight:"unset"}),zi=a.ux.style({color:h.Red60,lineHeight:a.ux.rem(1.5)}),Gi=a.ux.style({marginLeft:`calc(-1 * ${a.ux.rem(.25)})`,padding:a.ux.rem(.25),display:"flex",flexDirection:"column",gap:a.ux.rem(.5),width:"fit-content",border:"1px solid transparent",borderRadius:a.ux.rem(.25),margin:0}),ji=r.UI.Node.make((({view:e,notify:t})=>n.createElement(ii,{style:Di},n.createElement("div",{className:Mi},n.createElement(m.F.img,{src:e("iconUrl"),style:{width:16,height:16}}),n.createElement(m.F.span,Object.assign({},(0,z.E)(e("header"))))),n.createElement(m.F.div,null,e("hintsHeader")),n.createElement(m.F.Fragment,null,e("hintsItems").pipe(u.U((0,A.ls)(s.UI((e=>n.createElement("li",{key:e},e))),Oi.c2,E.fold(A.gn,(e=>n.createElement("ul",{key:"action-followup-radio-list",className:Vi},e)))))),e("radioOptions").pipe(u.U(E.fold(A.gn,(e=>n.createElement(Ui,{key:"radioOptions",options:e,onSubmit:e=>t({kind:P.i.Kind.radioOptionsSubmitButtonClick,selectedOption:e})(),onCancel:t({kind:P.i.Kind.radioOptionsCancelButtonClick})}))))))))),Fi=r.UI.Union.asOption(ji),Di={fontWeight:400,fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.3125)},Mi=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.x),color:l.XY.Content.Secondary.Default,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125)}),Vi=a.ux.style({padding:`0 0 0 ${a.ux.rem(o.sD+o.yC)}`,margin:0});var Li=i(16118),Hi=i(83538);const Ki=e=>n.createElement(g.a1,Object.assign({width:"18",height:"18",viewBox:"0 0 18 18",fill:"#99A0B3"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0607 3.64286C9.5893 2.78571 8.4107 2.78571 7.93926 3.64286L3.16592 12.3214C2.69448 13.1786 3.28378 14.25 4.22667 14.25H13.7733C14.7162 14.25 15.3055 13.1786 14.8341 12.3214L10.0607 3.64286ZM8.25 6C8.25 5.58579 8.58579 5.25 9 5.25C9.41421 5.25 9.75 5.58579 9.75 6V9.75C9.75 10.1642 9.41421 10.5 9 10.5C8.58579 10.5 8.25 10.1642 8.25 9.75V6ZM9.75 12C9.75 12.4142 9.41421 12.75 9 12.75C8.58579 12.75 8.25 12.4142 8.25 12C8.25 11.5858 8.58579 11.25 9 11.25C9.41421 11.25 9.75 11.5858 9.75 12Z",stroke:"none"})),$i={padding:0,height:a.ux.rem(14.625),overflow:"hidden",boxSizing:"border-box",maxHeight:"inherit"},Wi=a.ux.style({height:"100%",borderRadius:a.ux.rem(c.xB+c.fe)}),Zi=a.ux.style({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}),qi=a.ux.style({border:"none",borderRadius:a.ux.rem(c.xB+c.fe),margin:"0",height:"100%",width:"100%"}),Yi=a.ux.style({color:l.XY.Content.Secondary.Default,fontSize:a.ux.rem(.75),fontFamily:"Inter",fontWeight:700,lineHeight:a.ux.rem(1.125)}),Xi=a.ux.style({color:l.XY.Content.Secondary.Default,fontSize:a.ux.rem(.75),fontFamily:"Inter",lineHeight:a.ux.rem(1.125)}),Qi=a.ux.style({visibility:"hidden",position:"absolute"}),Ji=r.UI.Node.make((({view:e,notify:t})=>{const{notifyUnmount:i}=n.useContext(G),{ref:r,onMount:s}=(0,B.F)((0,A.ls)(R.b((e=>t({kind:P.i.Kind.mount,name:N.e.skill,element:e})())),U.x((()=>i({kind:P.i.Kind.unmount,name:N.e.skill}))))),o=n.useMemo((()=>e("status").pipe(Li.G(),we.h((([e,t])=>"loading"===e&&"ready"===t)),bt.w((()=>r.pipe(Ce.oA,R.b((e=>e.focus()))))))),[r]);return O.P.useSubscriptionTo(o),n.createElement(m.F.Fragment,null,e("size").pipe(u.U((t=>n.createElement(ii,{style:Object.assign(Object.assign({},$i),{height:t.height})},n.createElement(m.F.Fragment,null,e("status").pipe(u.U((t=>"loading"===t||"ready"===t?n.createElement(n.Fragment,null,n.createElement("div",Object.assign({},(0,be.Sh)(Wi,Zi,"ready"===t?Qi:void 0)),n.createElement(Hi.H,null),n.createElement("span",{className:Xi},"Loading...")),n.createElement(m.F.Fragment,null,e("srcUrl").pipe(u.U((e=>n.createElement("iframe",Object.assign({key:e,src:e,ref:s,allow:`clipboard-write ${e}`},(0,be.Sh)(qi,"loading"===t?Qi:void 0)))))))):"error"===t?n.createElement("div",Object.assign({},(0,be.Sh)(Wi,Zi)),n.createElement(Ki,null),n.createElement("span",{className:Yi},"Something went wrong"),n.createElement("span",{className:Xi},"Please try again.")):(0,A.Rz)(t))))))))))})),en=r.UI.Union.asOption(Ji);var tn=i(45930),nn=i(78674),rn=i(44361);const sn={border:`1px solid ${l.S5.InteractiveNeutral.Primary.Default}`,borderRadius:a.ux.rem(c.xB),width:a.ux.rem(15),height:a.ux.rem(2),boxSizing:"border-box",position:"relative"},on={padding:`${a.ux.rem(o.F2)} ${a.ux.rem(o.F2+o.Ze)} ${a.ux.rem(o.F2)} ${a.ux.rem(o.qp)}`,width:"100%",height:"100%",border:"none",background:"transparent",position:"relative",cursor:"pointer",display:"flex",alignItems:"center"},an={fontWeight:400,fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),color:l.XY.Content.Primary.Default},ln=Object.assign(Object.assign({position:"absolute",top:a.ux.rem(o.F2),right:a.ux.rem(o.x)},(0,v.fx)(1.5)),{$nest:{"& svg":{stroke:l.XY.Content.Secondary.Default}}}),cn=e=>a.ux.color(h.BlueGray40).toRGBA().fade(e).toString(),un={padding:a.ux.rem(o.F2),background:"white",boxShadow:`0px 0px 0px 0.5px ${h.BlueGray40}, 0px 0px 2px 0.5px ${cn(.5)}, 0px 1px 6px 0.5px ${cn(.25)}`,borderRadius:a.ux.rem(c.xB),width:a.ux.rem(15),boxSizing:"border-box",overflowY:"auto",maxHeight:a.ux.rem(8.125),zIndex:9999,$nest:{"& > ul":{listStyle:"none",padding:0,margin:0,$nest:{"& > li":{padding:0,margin:0}}}}},dn={border:"none",background:"transparent",width:"100%",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),color:l.XY.Content.Primary.Default,padding:`${a.ux.rem(.1875)} ${a.ux.rem(o.qp)}`,borderRadius:a.ux.rem(c.xB),display:"flex",justifyContent:"flex-start",$nest:{"&:hover":{background:h.Blue0}}},mn=a.ux.style(sn),pn=a.ux.style(on),hn=a.ux.style(an),gn=a.ux.style(un),fn=a.ux.style(dn),vn=a.ux.style(ln),yn=new tn.X(999999);function bn({label:e,selection:t,className:i,placeholder:r,options:s,onSelectionChange:o,renderOption:a}){const[l,c]=n.useState(!1),u=n.useRef(yn.newId().toString()),d=n.useRef(yn.newId().toString()),m=n.useRef(null),[p,h]=n.useState(null),[f,v]=n.useState(null),{styles:y,attributes:b}=(0,Ht.D)(p,f,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}}]}),x=n.useMemo((()=>new xe.xQ),[]),k=n.useMemo((()=>x.pipe(nn.b(100),we.h((e=>!e)),R.b((()=>{c(!1)})))),[x,c]);return O.P.useSubscriptionTo(k),n.createElement("div",Object.assign({},(0,be.Sh)(mn,i),{ref:h}),n.createElement("button",{ref:m,className:pn,onClick:()=>{var e;c(!0),x.next(!0),null===(e=m.current)||void 0===e||e.focus()},onFocus:()=>{c(!0),x.next(!0)},onBlur:()=>x.next(!1),type:"button","aria-haspopup":"listbox","aria-owns":u.current,"aria-expanded":l,"aria-labelledby":d.current},n.createElement("div",{id:d.current,className:hn},t?a?a(t):e(t):r),n.createElement(g.JO.Arrow,{direction:g.n4.down,className:vn})),l&&n.createElement("div",Object.assign({ref:v,style:y.popper},b.popper,{className:gn,onFocus:()=>x.next(!0),onBlur:()=>x.next(!1)}),n.createElement("ul",{"aria-label":"menu-options",role:"listbox",id:u.current},s.map(((t,i)=>{const r=e(t);return n.createElement("li",{key:i,"aria-label":r,role:"option"},n.createElement("button",{className:fn,onClick:(0,rn.m)((()=>{o(t),c(!1)}))},a?a(t):e(t)))})))))}var xn=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const kn=e=>{var{text:t,onChange:i,placeholder:r,disabled:s,className:o,onFocus:l,onBlur:u,onKeyPressEnter:d,autofocus:m,onKeyUpEscape:p}=e,h=xn(e,["text","onChange","placeholder","disabled","className","onFocus","onBlur","onKeyPressEnter","autofocus","onKeyUpEscape"]);const[g,f]=n.useState(null);return n.useEffect((()=>{g&&void 0!==m&&g.focus()}),[m,g]),n.createElement(W,{className:o,style:{height:a.ux.rem(1.375)}},n.createElement("style",{dangerouslySetInnerHTML:{__html:`\n      .textBox {\n        box-sizing: border-box;\n        border-radius: ${a.ux.rem(c.xB)};\n        overflow-y: auto;\n        width: 100%;\n        height: 100%;\n        border: none;\n        padding: 0;\n        background: transparent;\n        resize: none;\n        font-family: Inter, sans-serif;\n        font-size: ${a.ux.rem(.875)};\n        font-weight: 400;\n        color: ${K};\n      }\n      .textBox::placeholder {\n        color: ${$};\n      }\n      .textBox:focus {\n        outline: none;\n      }\n      `}}),n.createElement("input",Object.assign({},h,{className:"textBox",style:{lineHeight:a.ux.rem(1.375)},value:t,ref:f,onChange:e=>i(e.target.value),placeholder:r,disabled:s,onFocus:()=>null==l?void 0:l(),onBlur:()=>null==u?void 0:u(),onKeyPress:e=>{d&&"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),e.stopPropagation(),d())},onKeyDown:e=>{p&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),p())}})))},Sn={padding:`${a.ux.rem(o.F2)} ${a.ux.rem(o.F2+o.Ze)} ${a.ux.rem(o.F2)} ${a.ux.rem(o.qp)}`,border:`1px solid ${l.S5.InteractiveNeutral.Primary.Default}`,borderRadius:a.ux.rem(c.xB),width:a.ux.rem(15),height:a.ux.rem(2),boxSizing:"border-box",position:"relative"},Cn={position:"absolute",right:a.ux.rem(o.x),top:a.ux.rem(.1875),border:"none",background:"transparent",display:"flex",alignItems:"center",cursor:"pointer",width:a.ux.rem(1.5),height:a.ux.rem(1.5),padding:0},wn=Object.assign(Object.assign({},(0,v.fx)(1.5)),{$nest:{"& svg":{stroke:l.XY.Content.Secondary.Default}}}),_n=e=>a.ux.color(h.BlueGray40).toRGBA().fade(e).toString(),In={padding:a.ux.rem(o.F2),background:"white",boxShadow:`0px 0px 0px 0.5px ${h.BlueGray40}, 0px 0px 2px 0.5px ${_n(.5)}, 0px 1px 6px 0.5px ${_n(.25)}`,borderRadius:a.ux.rem(c.xB),width:a.ux.rem(15),boxSizing:"border-box",overflowY:"auto",maxHeight:a.ux.rem(8.125),zIndex:9999,$nest:{"& > ul":{listStyle:"none",padding:0,margin:0,$nest:{"& > li":{padding:0,margin:0}}}}},En={border:"none",background:"transparent",width:"100%",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),color:l.XY.Content.Primary.Default,padding:`${a.ux.rem(.1875)} ${a.ux.rem(o.qp)}`,borderRadius:a.ux.rem(c.xB),display:"flex",justifyContent:"flex-start",$nest:{"&:hover":{background:h.Blue0},"& mark":{backgroundColor:"unset",fontWeight:"bold"}}},An={width:a.ux.percent(100),border:"none"},On=a.ux.style(Sn),Rn=a.ux.style(Cn),Un=a.ux.style(wn),Tn=a.ux.style(In),Bn=a.ux.style(En),Pn=a.ux.style({whiteSpace:"pre"}),Nn=a.ux.style(An),zn=new tn.X(999999);function Gn({text:e,placeholder:t,clearButton:i,selectOnBlur:r,label:s,options:o,className:a,filterBy:l=((e,t)=>s(e).toLowerCase().includes(t.toLowerCase())),onInputChange:c,onSelectionChange:u}){const[d,m]=n.useState(!1),p=n.useRef(zn.newId().toString()),[h,f]=n.useState(null),[v,y]=n.useState(null),{styles:b,attributes:x}=(0,Ht.D)(h,v,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}}]}),k=o.filter((t=>l(t,e.trim()))),S=d&&k.length>0,C=n.useMemo((()=>new xe.xQ),[]);return O.P.useSubscriptionTo(C.pipe(nn.b(50),we.h((e=>!e)),R.b((()=>{m(!1),r&&""!==e.trim()&&u(k.length>0?k[0]:null)})))),n.createElement("div",Object.assign({},(0,be.Sh)(On,a),{ref:f}),n.createElement(kn,{className:Nn,placeholder:t,onChange:c,text:e,onFocus:()=>{m(!0),C.next(!0)},onBlur:()=>C.next(!1),role:"combobox","aria-haspopup":"listbox","aria-owns":p.current,"aria-expanded":S}),""!==e.trim()&&!!i&&n.createElement("button",{onClick:(0,rn.m)((()=>u(null))),className:Rn,"aria-label":"Clear",type:"button"},n.createElement(g.JO.Close,{className:Un})),S&&n.createElement("div",Object.assign({ref:y,style:b.popper},x.popper,{className:Tn,onFocus:()=>C.next(!0),onBlur:()=>C.next(!1)}),n.createElement("ul",{"aria-label":"menu-options",role:"listbox",id:p.current},k.map((t=>{const i=s(t);return n.createElement("li",{key:i,"aria-label":i,role:"option"},n.createElement("button",{className:Bn,onClick:(0,rn.m)((()=>{u(t),m(!1)}))},n.createElement(jn,{label:i,pattern:e})))})))))}const jn=({label:e,pattern:t})=>{if(""===t.trim())return n.createElement(n.Fragment,null,e);const i=t.trim(),r=e.split(new RegExp(i,"i")),o=(0,A.zG)(r.map(((e,t)=>({token:e,mark:!1,end:t*i.length+r.slice(0,t).join("").length+e.length}))),s.iD({token:"",mark:!0,end:0})).map(((t,n,r)=>t.mark&&n>0?{token:e.slice(r[n-1].end,r[n-1].end+i.length),mark:!0}:{token:t.token,mark:!1})).filter((e=>e.token.length>0));return n.createElement(n.Fragment,null,o.map(((e,t)=>e.mark?n.createElement("mark",{key:t,className:Pn},e.token):n.createElement("span",{key:t,className:Pn},e.token))))};var Fn=i(33305),Dn=i(65223);const Mn=e=>n.createElement(g.a1,Object.assign({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},e),n.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeWidth:".857",d:"m4 4 2 2m2 2L6 6m0 0 2-2M6 6 4 8"})),Vn=({kind:e,label:t,description:i,iconUrl:r,isUnselectable:s,onToggle:o})=>n.createElement(Dn.u,{title:i},n.createElement("button",{disabled:"disabled"===e,className:Ln,"data-kind":e,"data-unselectable":s,onClick:(0,rn.m)((()=>{"disabled"!==e&&o("selected"!==e&&("unselected"===e||(0,d.L0)(e)))}))},r?n.createElement("img",{src:r,style:{width:20,height:20}}):null,n.createElement("span",null,t),s&&"selected"===e?n.createElement(Mn,{className:Hn}):null)),Ln=a.ux.style({display:"flex",alignItems:"center",justifyContent:"center",gap:a.ux.rem(o.x),padding:`${a.ux.rem(o.F2)} ${a.ux.rem(.625)} ${a.ux.rem(o.F2)} ${a.ux.rem(o.x)}`,background:l.XY.Surface.Primary.Default,border:`${a.ux.px(1)} solid transparent`,borderRadius:a.ux.rem(1.875),fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),boxSizing:"border-box",$nest:{"&[data-kind='unselected']":{border:`${a.ux.px(1)} solid ${h.BlueGray5}`,color:l.XY.Content.Primary.Default,cursor:"pointer"},"&[data-kind='disabled']":{border:`${a.ux.px(1)} solid ${h.BlueGray5}`,color:h.BlueGray40,cursor:"default"},"&[data-kind='selected']":{border:`${a.ux.px(2)} solid ${F.Z.BrandGreen60}`,padding:`${a.ux.rem(.1875)} ${a.ux.rem(.5625)} ${a.ux.rem(.1875)} ${a.ux.rem(.4375)}`,position:"relative",$nest:{"&[data-unselectable='true']":{cursor:"pointer"}}}}}),Hn=a.ux.style(Object.assign(Object.assign({position:"absolute",top:a.ux.rem(-(o.F2+o.W9)),right:a.ux.rem(-(o.F2+o.W9)),boxSizing:"content-box"},(0,v.fx)(.75)),{border:`${a.ux.rem(.125)} solid white`,borderRadius:"50%",background:F.Z.BrandGreen60,display:"flex",alignItems:"center",justifyContent:"center"})),Kn=({chips:e,className:t,onToggle:i})=>n.createElement(m.F.div,Object.assign({},(0,be.Sh)($n,t)),e.pipe(u.U(s.UI((e=>n.createElement(Vn,Object.assign({},e,{onToggle:t=>i(e,t),key:e.label}))))))),$n=a.ux.style({display:"flex",flexWrap:"wrap",gap:a.ux.rem(o.F2),$nest:{div:{marginTop:a.ux.rem(o.F2)}}}),Wn={margin:0,padding:a.ux.rem(o.mh),gap:a.ux.rem(o.mh)},Zn={color:l.XY.Content.Primary.Default,fontWeight:700,fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),margin:0},qn={color:l.XY.Content.Secondary.Default,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125)},Yn={marginTop:a.ux.rem(o.x)},Xn={color:h.BlueGray60,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125)},Qn={display:"flex",justifyContent:"flex-end",gap:a.ux.rem(o.x)},Jn={fontSize:a.ux.important(a.ux.rem(.875))},er={marginTop:a.ux.rem(o.x)},tr={marginTop:a.ux.rem(o.x)},ir={display:"flex",alignItems:"center",gap:a.ux.rem(o.x)},nr={width:a.ux.rem(1.5),height:a.ux.rem(1.5),display:"flex",alignItems:"center",justifyContent:"center"},rr=Wn,sr=a.ux.style(Zn),or=a.ux.style(Yn),ar=a.ux.style(qn),lr=a.ux.style(Xn),cr=a.ux.style(Qn),ur=a.ux.style(Jn),dr=a.ux.style(Jn),mr=a.ux.style(er),pr=a.ux.style(tr),hr=a.ux.style(ir),gr=a.ux.style(nr),fr=r.UI.Node.make((({view:e,state:t,notify:i})=>n.createElement(ii,{style:rr},n.createElement("section",null,n.createElement("h2",{className:sr},"Formality"),n.createElement(Kn,{className:or,chips:e("styles").pipe(u.U(s.UI((e=>Object.assign(Object.assign({},e),{isUnselectable:!1}))))),onToggle:e=>i({kind:P.i.Kind.styleToggleClick,id:e.id})()})),n.createElement("section",null,n.createElement("h2",{className:sr},"Tone"),n.createElement(m.F.div,{className:ar},"Select up to"," ",e("maxSelectableTones").pipe(u.U((e=>{return t=e,Number.isInteger(t)&&t>=0&&t<10?function(e){return["zero","one","two","three","four","five","six","seven","eight","nine"][e]}(e):`${e}`;var t})))),n.createElement(Kn,{className:or,chips:e("tones").pipe(u.U(s.UI((e=>Object.assign(Object.assign({},e),{isUnselectable:!0}))))),onToggle:(e,t)=>i({kind:P.i.Kind.toneToggleClick,selected:t,id:e.id})()})),n.createElement(m.F.Fragment,null,t.pipe(u.U((e=>(0,A.zG)(e.roles,Oi.c2,E.fold(A.gn,(t=>n.createElement("section",null,n.createElement("h2",{className:sr},"Your profession"),n.createElement(Gn,{className:mr,placeholder:"Product designer",text:e.roleTypeaheadText,onInputChange:e=>i({kind:"updateRoleTypeaheadText",text:e})(),onSelectionChange:e=>i({kind:P.i.Kind.roleTypeaheadSelectionChange,role:E.fromNullable(e)})(),options:t,label:e=>e.label,clearButton:!0,selectOnBlur:!0}))))))))),n.createElement("section",null,n.createElement("h2",{className:sr},"I write in"),n.createElement(m.F.Fragment,null,t.pipe(u.U((({dialects:e,selectedDialect:t})=>n.createElement(bn,{className:pr,options:e.filter((e=>!Fn.L.Dialect.Id.eq.equals(e.id,t.id))),selection:t,onSelectionChange:e=>i({kind:P.i.Kind.dialectDropdownSelectionChange,dialect:e})(),label:e=>e.label,renderOption:e=>n.createElement("div",{className:hr},n.createElement("div",{className:gr},n.createElement("img",{src:e.iconUrl,style:{width:a.ux.rem(1),height:a.ux.rem(1)}})),e.label)})))))),n.createElement(m.F.Fragment,null,e("description").pipe(u.U((e=>""!==e.trim()?n.createElement("div",{className:lr},e):null)))),n.createElement(m.F.div,{className:cr},n.createElement(j.z.Tertiary,{className:dr,onClick:i({kind:P.i.Kind.voiceProfileCloseButtonClick}),name:"closeVoiceProfile"},"Close"),e("applyButtonEnabled").pipe(u.U((e=>n.createElement(j.z.Primary,{className:ur,onClick:i({kind:P.i.Kind.voiceProfileUseVoiceButtonClick}),disabled:!e,name:"applyVoiceProfile"},"Use this voice")))))))),vr=({className:e})=>n.createElement("div",Object.assign({role:"separator"},(0,be.Sh)(yr,e))),yr=a.ux.style({position:"relative",width:"100%",borderBottom:`0.5px solid ${h.BlueGray10}`});var br,xr=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(br||(br={}));const kr=({tabs:e,activeTabId:t,onActiveTabChange:i,children:r})=>n.createElement(n.Fragment,null,n.createElement("div",{className:Cr,role:"tablist"},e.map((e=>n.createElement("button",{key:e.id,onClick:()=>i(e.id),tabIndex:0,className:wr,id:`tab-${e.id}`,"aria-label":`${e.label} ${e.id===t?"Selected.":""}`,"aria-controls":`tabpanel-${e.id}`,"aria-selected":t===e.id,role:"tab",type:"button"},e.label)))),r),Sr=e=>{var{id:t,isActive:i,children:r,className:s,style:o}=e,a=xr(e,["id","isActive","children","className","style"]);return n.createElement("div",Object.assign({role:"tabpanel",id:`tabpanel-${t}`,"aria-labelledby":`tab-${t}`,hidden:!i,style:i?o:void 0,className:i?s:void 0},a),r)},Cr=a.ux.style({display:"flex",alignContent:"flex-start",gap:a.ux.rem(o.x)}),wr=a.ux.style({cursor:"pointer",border:"none",display:"flex",alignItems:"center",background:"transparent",borderBottom:`${a.ux.rem(o.yC)} solid transparent`,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),height:a.ux.rem(1.5),color:F.Z.TextBaseSubduedColor,$nest:{'&[aria-selected="true"]':{borderBottomColor:F.Z.TextBaseSubduedColor,fontWeight:700},'&[aria-selected="false"]:hover':{borderBottomColor:h.BlueGray10}}});function _r({label:e,enabled:t,onChange:i}){return n.createElement("div",{className:Ir},n.createElement("input",{type:"checkbox",id:"voice-checkbox",checked:t,onChange:i}),n.createElement("label",{htmlFor:"voice-checkbox"},e))}const Ir=a.ux.style({display:"flex",alignItems:"flex-start",$nest:{"& input[type='checkbox']":{margin:`${a.ux.rem(o.W9)} ${a.ux.rem(o.x)} 0 0`,minWidth:a.ux.rem(1),minHeight:a.ux.rem(1),accentColor:h.Green80,cursor:"pointer"},"& label":{color:l.XY.Content.Primary.Default,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),cursor:"pointer"}}});var Er=i(17579);const Ar={editBtn:"editBtn",cancelBtn:"cancelBtn",saveBtn:"saveBtn"},Or={base:{backgroundColor:F.Z.BlueGray0}},Rr={gap:0,backgroundImage:"url(https://assets.grammarly.com/cheetah/v1/voice-profile/cheetah-my-voice-bg.svg)",backgroundPosition:"right",backgroundRepeat:"no-repeat",backgroundSize:"auto 100%",$nest:{[`.${Ar.editBtn}`]:{opacity:0,pointerEvents:"none",$nest:{"&:focus":{opacity:1,pointerEvents:"auto"}}},[`&:hover .${Ar.editBtn}, &:focus .${Ar.editBtn}`]:{opacity:1,pointerEvents:"auto"}}},Ur=e=>a.ux.style({display:"flex",justifyContent:"space-between",marginBottom:e?a.ux.rem(o.x):a.ux.rem(o.yC+o.F2)}),Tr=a.ux.style({margin:0,fontSize:a.ux.rem(1.25),lineHeight:a.ux.rem(1.5),fontWeight:700}),Br=a.ux.style({display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between"}),Pr=a.ux.style({display:"flex",flexDirection:"column",gap:a.ux.rem(o.x)}),Nr=a.ux.style({display:"flex",flexDirection:"column",gap:a.ux.rem(o.F2)}),zr=a.ux.style({color:F.Z.TextBaseSubduedColor,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),margin:0}),Gr=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.x)}),jr=a.ux.style({width:a.ux.rem(1.5),height:a.ux.rem(1.5),display:"flex",alignItems:"center",justifyContent:"center",$nest:{"& img":{width:a.ux.rem(1),height:a.ux.rem(1)}}}),Fr=a.ux.style({display:"flex",flexDirection:"column",gap:a.ux.rem(o.F2)}),Dr=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.F2),height:a.ux.rem(1.5),color:F.Z.TextBaseSubduedColor,fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.3125),fontWeight:500}),Mr=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.x)});var Vr=i(27995);const Lr=({children:e,theme:t,body:i,placement:r,active:s,onCloseButtonClick:o})=>{const a=n.useRef(null);return n.createElement(n.Fragment,null,n.createElement(Vr.J,{placement:r,reference:s&&a.current||void 0,theme:t},n.createElement(p.x,{onClick:o,name:"tooltipClose",className:Hr,size:"small"}),i),n.cloneElement(e,{ref:a}))},Hr=a.ux.style({position:"absolute",top:a.ux.rem(o.x),right:a.ux.rem(o.x)}),Kr=n.forwardRef((function({name:e,active:t,onClick:i},r){return n.createElement("button",{role:"button",tabIndex:0,"aria-label":e,"aria-pressed":t,"data-active":t,onClick:i,ref:r,className:$r},e)})),$r=a.ux.style({display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",height:a.ux.rem(2),borderRadius:a.ux.rem(c.xB),border:`${a.ux.rem(o.yC)} solid transparent`,padding:`${a.ux.rem(o.yC+o.F2)} ${a.ux.rem(o.x)}`,backgroundColor:F.Z.Green0,color:F.Z.Green90,lineHeight:a.ux.rem(1.3125),fontSize:a.ux.rem(.875),$nest:{"&:hover":{backgroundColor:a.ux.color(F.Z.Green10).mix(a.ux.color(F.Z.BlueGray5)).toRGBA().toString(),color:F.Z.Green80},'&[data-active="true"]':{outline:`${a.ux.rem(o.yC)} solid ${F.Z.Green80}`}}}),Wr=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{d:"M18.5 11.25a.958.958 0 0 1-.064.34l-2.248 4.267a1.009 1.009 0 0 1-.938.643H9.5c-.554 0-1-.446-1-1V10a1 1 0 0 1 .294-.706l4.586-4.587.432.432a.664.664 0 0 1 .188.433l-.016.175-.654 3.151a.5.5 0 0 0 .49.602H18c.274 0 .5.226.5.5v1.25ZM6 9.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h1Z",stroke:"#646B81",strokeLinejoin:"round"})),Zr=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{d:"M5 12.75c0-.114.023-.233.065-.34l2.247-4.267.01-.017.007-.017c.155-.357.51-.609.921-.609H14c.554 0 1 .446 1 1V14a1 1 0 0 1-.294.706l-4.586 4.587-.432-.432a.664.664 0 0 1-.188-.433l.016-.175.654-3.151.124-.602H5.5A.503.503 0 0 1 5 14v-1.25Zm12.5 1.75a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5h-1Z",stroke:"#646B81"})),qr=({onKeepClick:e,onRemoveClick:t})=>n.createElement("div",{className:Yr},n.createElement("h1",{className:Xr},"Does this sound like you?"),n.createElement("div",{className:Qr},n.createElement(j.z.Primary,{onClick:e,style:Jr},n.createElement(Wr,null),"Yes, keep it"),n.createElement(j.z.Primary,{onClick:t,style:Jr},n.createElement(Zr,null),"No, remove it"))),Yr=a.ux.style({display:"flex",flexDirection:"column",alignItems:"flex-start"}),Xr=a.ux.style({fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),fontWeight:700,margin:`0 0 ${a.ux.rem(o.mh)} 0`}),Qr=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.x)}),Jr={base:{gap:a.ux.rem(o.F2),padding:`0 ${a.ux.rem(o.x)} 0 ${a.ux.rem(o.F2)}`,color:F.Z.TextBaseDefault,backgroundColor:l.XY.Surface.Primary.Default},hovered:{color:F.Z.TextBaseDefault,backgroundColor:F.Z.BlueGray5},active:{color:F.Z.TextBaseDefault,backgroundColor:F.Z.BlueGray5}},es=({profile:e,activeProfileName:t,activeTagId:i,onCloseButtonClick:r,onKeepClick:s,onRemoveClick:o,onVoiceTagClick:a})=>n.createElement(Sr,{id:br.Id.create(e.name),isActive:e.name===E.toNullable(t),className:ts},e.summary,n.createElement("div",{className:ns},e.sections.map((t=>n.createElement("div",{key:t.name},t.name,n.createElement("div",{className:rs},0===t.tags.length?n.createElement("div",{className:is},"Detected qualities will appear here"):t.tags.map((l=>n.createElement(Lr,{key:l.name,active:(0,A.zG)(i,E.fold(A.jv,(i=>i===Fn.b.createId({tagName:l.name,sectionName:t.name,profileName:e.name})))),onCloseButtonClick:r,body:n.createElement(qr,{onKeepClick:s,onRemoveClick:()=>o(l.name,e.name,t.name)})},n.createElement(Kr,{name:l.name,active:(0,A.zG)(i,E.fold(A.jv,(i=>i===Fn.b.createId({tagName:l.name,sectionName:t.name,profileName:e.name})))),onClick:()=>a(l.name,e.name,t.name)})))))))))),ts=a.ux.style({fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.3125),display:"flex",flexDirection:"column",gap:a.ux.rem(o.qp),paddingTop:a.ux.rem(o.x)}),is=a.ux.style({padding:`0 ${a.ux.rem(o.x)}`,background:F.Z.BlueGray0,color:F.Z.TextBaseSubduedColor,borderRadius:a.ux.rem(c.xB),height:a.ux.rem(2),fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.3125),display:"flex",justifyContent:"center",alignItems:"center"}),ns=a.ux.style({display:"flex",flexDirection:"column",gap:a.ux.rem(o.qp)}),rs=a.ux.style({marginTop:a.ux.rem(o.x),display:"flex",flexWrap:"wrap",gap:a.ux.rem(o.F2)}),ss=(0,be.xb)((({onEditButtonClick:e,onSaveButtonClick:t,onCancelButtonClick:i,onDialectDropdownChange:r,onRoleDropdownChange:s,userName:o,isEditing:a,selectedRole:l,roles:c,dialects:u,selectedDialect:d})=>n.createElement(ii,{style:Rr},n.createElement("div",{className:Ur(a)},n.createElement("h1",{className:Tr},o),a?null:n.createElement(j.z.Secondary,{onClick:e,className:Ar.editBtn,style:Or,size:"small"},"Edit")),a?n.createElement("div",{className:Br},n.createElement("div",{className:Pr},0!==c.length&&n.createElement("div",{className:Nr},n.createElement("h2",{className:zr},"My role"),n.createElement(bn,{placeholder:"Select a role...",options:c,selection:E.toUndefined(l),onSelectionChange:s,label:e=>e.id,renderOption:e=>e.id})),n.createElement("div",{className:Nr},n.createElement("h2",{className:zr},"I write in"),n.createElement(bn,{options:u,selection:d,onSelectionChange:r,label:e=>e.label,renderOption:e=>n.createElement("div",{className:Gr},n.createElement("div",{className:jr},n.createElement("img",{src:e.iconUrl,alt:""})),e.label)}))),n.createElement("div",{className:Mr},n.createElement(j.z.Tertiary,{onClick:i},"Cancel"),n.createElement(j.z.Primary,{onClick:t},"Save"))):n.createElement("div",{className:Fr},(0,A.zG)(l,E.fold(A.gn,(e=>n.createElement("div",{className:Dr},n.createElement(Er.N,null),n.createElement("span",null,e.label))))),n.createElement("div",{className:Dr},n.createElement("div",{className:jr},n.createElement("img",{src:d.iconUrl,alt:""})),n.createElement("span",null,d.label)))))),os=r.UI.Node.make((({view:e,state:t,notify:i})=>n.createElement("div",{className:as},n.createElement(ss,{onEditButtonClick:i({kind:P.i.Kind.voiceSelectionsEditButtonClick}),onDialectDropdownChange:e=>i({kind:P.i.Kind.voiceDialectDropdownSelectionChange,dialect:e})(),onRoleDropdownChange:e=>i({kind:P.i.Kind.voiceRoleDropdownSelectionChange,role:e})(),onSaveButtonClick:i({kind:P.i.Kind.voiceSelectionsSaveButtonClick}),onCancelButtonClick:i({kind:P.i.Kind.voiceSelectionsCancelButtonClick}),userName:e("userName"),isEditing:e("isEditing"),selectedRole:e("selectedRole"),selectedDialect:e("selectedDialect"),roles:e("roles"),dialects:e("dialects")}),n.createElement(ii,{style:ls},n.createElement(m.F.div,null,t.pipe(u.U((e=>n.createElement(n.Fragment,null,n.createElement("div",{className:cs},n.createElement("div",null,n.createElement("h1",{className:us},e.title),n.createElement("h2",{className:ds},e.subTitle)),n.createElement(kr,{key:"Tabs",tabs:e.profiles.map((e=>({id:br.Id.create(e.name),label:e.name}))),activeTabId:br.Id.create(E.toNullable(e.activeProfileName)||""),onActiveTabChange:e=>i({kind:P.i.Kind.voiceProfileTabChange,profileName:e})()})),e.profiles.map((t=>n.createElement(es,{key:t.name,profile:t,activeProfileName:e.activeProfileName,activeTagId:e.activeTagId,onCloseButtonClick:i({kind:P.i.Kind.voiceTagPopoverCloseButtonClick}),onKeepClick:i({kind:P.i.Kind.voiceTagPopoverKeepButtonClick}),onRemoveClick:(e,t,n)=>i({kind:P.i.Kind.voiceTagPopoverRemoveButtonClick,tagName:e,profileName:t,sectionName:n})(),onVoiceTagClick:(e,t,n)=>i({kind:P.i.Kind.voiceTagClick,tagName:e,profileName:t,sectionName:n})()})))))))),n.createElement(vr,null),n.createElement(m.F.Fragment,null,t.pipe(u.U((({isEnabledByDefault:e,isEnabledByDefaultLabel:t})=>n.createElement(_r,{enabled:e,label:t,onChange:i({kind:P.i.Kind.applyVoiceToWritingCheckboxChange,checked:!e})}))))))))),as=a.ux.style({display:"flex",flexDirection:"column",gap:a.ux.rem(o.x),maxHeight:a.ux.rem(35),overflowY:"scroll"}),ls={gap:a.ux.rem(o.mh)},cs=a.ux.style({display:"flex",justifyContent:"space-between",alignItems:"flex-start"}),us=a.ux.style({fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.3125),fontWeight:700,margin:0}),ds=a.ux.style({color:F.Z.TextBaseSubduedColor,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),margin:0}),ms=r.UI.Node.make((({view:e,notify:t})=>n.createElement(ii,null,n.createElement(m.F.div,{className:hs},e("error").pipe(u.U((e=>n.createElement(n.Fragment,null,n.createElement(Ki,{className:vs}),n.createElement("span",{className:gs},e.header)))))),n.createElement(m.F.div,{className:fs},e("error").pipe(u.U((e=>e.text)))),n.createElement(m.F.Fragment,null,e("showGotItButton").pipe(u.U((e=>e?n.createElement(j.z.Primary,{className:ys,name:"gotItButton",onClick:t({kind:P.i.Kind.errorCardOkButtonClick}),size:"small"},"OK"):null))))))),ps=r.UI.Union.asOption(ms),hs=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.F2)}),gs=a.ux.style({fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),fontWeight:700,color:l.XY.Content.Primary.Default}),fs=a.ux.style({fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),color:l.XY.Content.Secondary.Default,whiteSpace:"break-spaces",overflowWrap:"anywhere"}),vs=a.ux.style(Object.assign({padding:a.ux.rem(o.yC)},(0,v.fx)(1.125))),ys=a.ux.style({alignSelf:"flex-start"}),bs=r.UI.Node.make((({view:e})=>n.createElement(ii,{style:ks},n.createElement("div",{className:Ss},"This document"),n.createElement(m.F.div,{className:Cs},e("title")),n.createElement(m.F.div,{className:ws},e("summary"))))),xs=r.UI.Union.asOption(bs),ks={position:"relative",padding:`${a.ux.rem(o.x)} ${a.ux.rem(o.qp)}`,gap:a.ux.rem(o.x),fontSize:a.ux.rem(o.qp),lineHeight:a.ux.rem(o.mh+o.yC)},Ss=a.ux.style({borderBottom:`${a.ux.rem(o.W9)} solid ${l.XY.Boundaries.Secondary.Default}`,paddingBottom:a.ux.rem(o.F2),marginBottom:a.ux.rem(o.F2),color:l.XY.Content.Secondary.Default,userSelect:"none"}),Cs=a.ux.style({fontSize:a.ux.rem(o.qp+o.yC),color:l.XY.Content.Secondary.Default,fontWeight:600}),ws=a.ux.style({color:l.XY.Content.Primary.Default}),_s=a.ux.keyframes({"0%":{backgroundPositionX:"-300px"},"85%":{backgroundPositionX:"600px"},"100%":{backgroundPositionX:"600px"}}),Is=e=>{var t,i,n;const r=a.ux.color(null!==(t=e.overlayGradientCenterColor)&&void 0!==t?t:"rgba(0, 0, 0, 1)"),s=a.ux.color(null!==(i=e.overlayGradientEndColor)&&void 0!==i?i:"rgba(255, 255, 255, 0)"),o=`rgba(${r.red()}, ${r.green()}, ${r.blue()}, ${r.alpha()})`,l=`rgba(${s.red()}, ${s.green()}, ${s.blue()}, ${s.alpha()})`;return a.ux.style({position:"absolute",top:0,left:0,bottom:0,right:0,pointerEvents:"none",mixBlendMode:null!==(n=e.overlayBlendMode)&&void 0!==n?n:"overlay",background:`linear-gradient(90deg, ${l} 0px, ${o} 120px, ${o} 150px, ${o} 170px, ${l} 300px)`,backgroundRepeat:"no-repeat",backgroundPositionX:"-300px",backgroundSize:1e3,animationDelay:"300ms",animationDuration:"1.5s",animationName:_s,animationTimingFunction:"linear",animationIterationCount:"infinite"})},Es=e=>n.createElement("div",{className:Is(e)}),As=r.UI.Node.make((({view:e})=>n.createElement(ii,{"aria-busy":"true"},n.createElement(ue,null,e("header")),n.createElement("div",{className:Os},n.createElement(Es,null))))),Os=a.ux.style({height:a.ux.rem(.5),borderRadius:a.ux.rem(o.W9),background:h.BlueGray5,flexGrow:1,maxWidth:a.ux.rem(22.5),position:"relative",marginBottom:a.ux.rem(o.F2)}),Rs=r.UI.Node.make((({view:e})=>n.createElement(ii,{style:Bs},n.createElement(ue,null,e("header")),n.createElement(m.F.div,Object.assign({className:Ps},(0,z.E)(e("text"),[...z.ap,"person"])))))),Us=r.UI.Union.make("kind",{loading:As,loaded:Rs}),Ts=r.UI.Union.asOption(Us),Bs={gap:a.ux.rem(o.yC)},Ps=a.ux.style({color:l.XY.Content.Primary.Default,fontStyle:"normal",fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),fontFeatureSettings:"'ss01' on",$nest:{"& person":{color:h.Blue60,fontWeight:700,$nest:{"&::before":{content:"''",display:"inline-block",width:a.ux.rem(1),height:a.ux.rem(1),backgroundSize:"cover",verticalAlign:"text-bottom",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,${encodeURIComponent(`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.95768 3.00512C8.95983 3.00512 9.7855 3.83575 9.7855 4.8769V6.01259C9.7855 7.05374 8.95983 7.88437 7.95768 7.88437C6.95553 7.88437 6.12986 7.05374 6.12986 6.01259V4.8769C6.12986 3.83575 6.95553 3.00512 7.95768 3.00512ZM10.5847 4.8769C10.5847 3.40916 9.41586 2.20593 7.95768 2.20593C6.4995 2.20593 5.33067 3.40916 5.33067 4.8769V6.01259C5.33067 7.48032 6.4995 8.68355 7.95768 8.68355C8.20909 8.68355 8.45189 8.64779 8.68159 8.58107C8.68635 8.65317 8.69342 8.72016 8.70392 8.78578C8.81061 9.45248 9.17662 10.0499 9.72211 10.4478C9.88673 10.5679 10.0776 10.6652 10.3757 10.8171L11.2702 11.2732C11.6108 11.4469 11.7408 11.5145 11.8477 11.5924C12.2227 11.866 12.4743 12.2767 12.5477 12.7351C12.5589 12.8055 12.5645 12.8807 12.5672 12.995H9.90666C9.68597 12.995 9.50707 13.1739 9.50707 13.3946C9.50707 13.6152 9.68597 13.7941 9.90666 13.7941H12.9694C13.19 13.7941 13.3689 13.6152 13.3689 13.3946L13.369 13.3588C13.369 13.0242 13.369 12.81 13.3368 12.6088C13.2301 11.9421 12.8641 11.3446 12.3186 10.9468C12.154 10.8267 11.9632 10.7294 11.665 10.5775C11.6546 10.5721 11.644 10.5667 11.6332 10.5612L10.7705 10.1214C10.43 9.94773 10.2999 9.88006 10.1931 9.80215C9.81805 9.52861 9.56642 9.11785 9.49307 8.65949C9.4762 8.55408 9.47217 8.43819 9.47124 8.19619C10.1462 7.71137 10.5847 6.9116 10.5847 6.01259V4.8769Z" fill="${h.Blue60}"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7.91127 3.00512C6.90913 3.00512 6.08346 3.83575 6.08346 4.8769V6.01259C6.08346 7.05374 6.90913 7.88437 7.91127 7.88437C8.91342 7.88437 9.73909 7.05374 9.73909 6.01259V4.8769C9.73909 3.83575 8.91342 3.00512 7.91127 3.00512ZM5.28427 4.8769C5.28427 3.40916 6.45309 2.20593 7.91127 2.20593C9.36946 2.20593 10.5383 3.40916 10.5383 4.8769V6.01259C10.5383 7.48032 9.36946 8.68355 7.91127 8.68355C7.65987 8.68355 7.41706 8.64779 7.18737 8.58107C7.1826 8.65317 7.17553 8.72016 7.16503 8.78578C7.05834 9.45248 6.69233 10.0499 6.14684 10.4478C5.98222 10.5679 5.7914 10.6652 5.49326 10.8171L4.59875 11.2732C4.25818 11.4469 4.12811 11.5145 4.02129 11.5924C3.64626 11.866 3.39463 12.2767 3.32128 12.7351C3.31001 12.8055 3.30447 12.8807 3.30176 12.995H10.2779C10.4986 12.995 10.6775 13.1739 10.6775 13.3946C10.6775 13.6152 10.4986 13.7941 10.2779 13.7941H2.8996C2.67891 13.7941 2.50001 13.6152 2.50001 13.3946L2.5 13.3588C2.49996 13.0242 2.49994 12.81 2.53214 12.6088C2.63883 11.9421 3.00484 11.3446 3.55033 10.9468C3.71494 10.8267 3.90577 10.7294 4.2039 10.5775C4.21438 10.5721 4.22499 10.5667 4.23574 10.5612L5.09841 10.1214C5.43899 9.94773 5.56906 9.88006 5.67588 9.80215C6.0509 9.52861 6.30254 9.11785 6.37589 8.65949C6.39276 8.55408 6.39678 8.43819 6.39771 8.19619C5.72278 7.71137 5.28427 6.9116 5.28427 6.01259V4.8769Z" fill="${h.Blue60}"/></svg>`)}')`}}}}}),Ns=r.UI.Node.make((({state:e,notify:t})=>n.createElement(m.F.div,null,e.pipe(u.U((({selectedRange:e,selectedText:i})=>e?n.createElement(j.z.Tertiary,{title:"Select any text to work with it in Grammarly.",style:{base:Gs},onClick:t({kind:P.i.Kind.selectionContextInteraction,range:e,visibility:"attention"}),onMouseEnter:t({kind:P.i.Kind.selectionContextInteraction,range:e,visibility:"visible"}),onMouseLeave:t({kind:P.i.Kind.selectionContextInteraction,range:e,visibility:"hidden"})},n.createElement(Te,null,i)):n.createElement("div",{className:js},n.createElement(Te,null,i)))))))),zs=r.UI.Union.asOption(Ns),Gs={paddingLeft:a.ux.rem(o.qp),paddingRight:a.ux.rem(o.qp),paddingTop:a.ux.rem(o.F2),paddingBottom:a.ux.rem(o.F2),marginBottom:a.ux.rem(-o.F2),justifyContent:"flex-start",minHeight:0},js=a.ux.style({paddingLeft:a.ux.rem(o.qp),paddingRight:a.ux.rem(o.qp),paddingTop:a.ux.rem(o.F2),paddingBottom:a.ux.rem(o.F2),marginBottom:a.ux.rem(-o.F2)});var Fs=i(21790);const Ds="primaryBtn",Ms="rephraseBtn",Vs="dismissBtn",Ls="reportBtn",Hs=({isActive:e,id:t,children:i,onHovered:r,onFocused:s,onCopy:o,customStyles:a})=>{const l=n.useRef(null);return n.createElement(ii,{ref:l,style:Object.assign(Object.assign({},$s),a),"data-active":e,"data-id":t,onMouseEnter:()=>null==r?void 0:r(!0),onMouseLeave:()=>null==r?void 0:r(!1),onFocus:()=>{var e;return null==s?void 0:s((null===(e=l.current)||void 0===e?void 0:e.contains((0,z.vY)(document)))||!1)},onBlur:()=>{var e;return null==s?void 0:s((null===(e=l.current)||void 0===e?void 0:e.contains((0,z.vY)(document)))||!1)},onCopy:o},i)},Ks={backgroundColor:l.XY.Surface.Primary.Default,$nest:{[`& .${Vs}, & .${Ls}`]:{opacity:1,pointerEvents:"auto"},[`& ${(0,v.s4)(Ds,v.Ki)}`]:{color:l.XY.Surface.Primary.Default,backgroundColor:F.Z.BrandGreen60,border:"1px solid transparent"}}},$s={backgroundColor:"transparent",$nest:{"&:not(:last-of-type)":{borderBottom:`0.5px solid ${h.BlueGray10}`},[`& ${(0,v.s4)(Ds,v.Ki)}`]:{lineHeight:a.ux.rem(1.125),backgroundColor:l.XY.Surface.Primary.Default,color:l.XY.Content.Secondary.Default,border:`1px solid ${h.BlueGray5}`,boxSizing:"border-box"},[`& ${(0,v.s4)(Ms,v.Ki)}`]:{lineHeight:a.ux.rem(1.5)},[`& .${Vs}, & .${Ls}`]:{opacity:0,pointerEvents:"none",justifyContent:"center"},"&:focus, &:hover":Object.assign({},Ks),"&[data-active='true']":Object.assign({},Ks)}},Ws=({header:e,footer:t,isActive:i,resultId:r,onHovered:s,onFocused:o,onCopy:a,body:l,customStyles:c})=>n.createElement(Hs,{id:r,isActive:i,onHovered:s,onFocused:o,customStyles:c,onCopy:a},e,l,t);var Zs=i(98884);const qs=({text:e})=>""!==e.trim()?n.createElement(Zs.s,null,e):null;var Ys=i(90653);const Xs=r.UI.Node.make((({state:e})=>n.createElement(m.F.Fragment,null,e.pipe(u.U((({resultText:e,statusText:t,isMyVoiceStatus:i,sourceLabel:r,sourceIconUrl:s})=>n.createElement(Ws,{resultId:"in-progress",header:n.createElement(Qs,null,n.createElement(Ys.L,{header:e.length>0?r:t,iconUrl:e.length>0?s:E.none,loading:0===e.length}),n.createElement(Fs.X,{isBadge:!0,isAnimated:!0,isMyVoice:i,label:"Use my style"})),body:e.length>0?n.createElement(n.Fragment,null,n.createElement(qs,{text:e}),n.createElement(eo,null)):null,isActive:!0}))))))),Qs=({children:e})=>n.createElement("div",{className:Js},e),Js=a.ux.style({display:"grid",gridTemplateColumns:"1fr auto"}),eo=()=>n.createElement("div",{className:a.ux.style({position:"relative",overflow:"hidden",height:a.ux.rem(.5),borderRadius:a.ux.rem(c.xB),background:h.BlueGray5,flexGrow:1})},n.createElement(Es,null)),to=r.UI.Node.make((({state:e})=>n.createElement(m.F.Fragment,null,e.pipe(u.U((({result:e})=>n.createElement(Ws,{resultId:"in-progress",body:n.createElement(qs,{text:e.text}),header:n.createElement(Ys.L,{header:"Working on it...",iconUrl:E.none,loading:!0}),isActive:!0}))))))),io=r.UI.Union.make("kind",{regularCardInProgress:to,myVoiceCardInProgress:Xs}),no=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement(n.Fragment,null,e.header,e.content))),{content:io,header:zs}),ro=r.UI.Union.asOption(no);var so=i(31956);function oo(e,t){var i,r;const[s,o]=(0,n.useState)(void 0);return(0,n.useEffect)((()=>{e.current&&e.current.scrollWidth>e.current.clientWidth&&o(t)}),[null===(i=e.current)||void 0===i?void 0:i.scrollWidth,null===(r=e.current)||void 0===r?void 0:r.clientWidth,t]),s}const ao=({title:e,url:t})=>{const i=n.useRef(null),r=oo(i,e);return(0,A.zG)(t,E.fold((()=>n.createElement("span",{className:lo,title:r,ref:i},e)),(t=>n.createElement(so.d,{className:lo,title:r,ref:i,href:t},e))))},lo=a.ux.style({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",$nest:{"&:visited":{color:"inherit"}}}),co=r.UI.Node.make((({state:e})=>n.createElement(m.F.Fragment,null,e.pipe(u.U((({detectedReferences:e})=>n.createElement(ii,{style:mo},n.createElement("span",{className:po},"Detected references"),n.createElement("ul",{className:ho},e.map((({title:e,iconUrl:t,url:i},r)=>n.createElement("li",{key:r,className:go},n.createElement("img",{src:t,className:fo,alt:""}),n.createElement(ao,{title:e,url:i})))))))))))),uo=r.UI.Union.asOption(co),mo={position:"relative",padding:`${a.ux.rem(o.F2)} ${a.ux.rem(o.qp)}`,gap:0},po=a.ux.style({fontSize:a.ux.rem(o.qp),lineHeight:a.ux.rem(o.mh+o.yC),color:l.XY.Content.Secondary.Default,userSelect:"none"}),ho=a.ux.style({fontSize:a.ux.rem(o.qp),lineHeight:a.ux.rem(o.mh+o.yC),color:l.XY.Content.Primary.Default,margin:0,padding:0}),go=a.ux.style({height:a.ux.rem(o.sD),display:"flex",alignItems:"center",borderRadius:a.ux.rem(c.xB)}),fo=a.ux.style({minWidth:a.ux.rem(o.mh),height:a.ux.rem(o.mh),marginRight:a.ux.rem(o.x)}),vo=r.UI.Node.make((()=>n.createElement("div",null,"Not implemented yet!"))),yo=r.UI.Union.make("kind",{loadingState:r.UI.Node.empty,emptyState:r.UI.Node.empty,successState:r.UI.Node.empty,nonEmptyState:vo});var bo=i(18702),xo=i(72125),ko=i(83078);var So=i(85682);const Co=r.UI.Node.make((({state:e,notify:t})=>{const{onMount:i}=(0,B.F)((0,A.ls)(R.b(t({kind:"shortFormFeedMounted"})),U.x(So.q.notifyFeedUnmount))),{onMount:r}=function(e,t){const{onMount:i,ref:n}=O.P.useElWatcher();return O.P.useSubscriptionTo(T.aj([n,t]).pipe(u.U((([t,i])=>(0,A.zG)(t,ko.bw((t=>t.style.setProperty(e,i)))))))),{onMount:i}}("--cardWidth",gt.of("400"));return n.createElement(ii,{style:{padding:0,paddingTop:a.ux.rem(o.qp)},ref:e=>{i(e),r(e)}},n.createElement(ue,{customStyle:{padding:`0 ${a.ux.rem(o.qp)}`}},"Review suggestions"),n.createElement(m.F.Fragment,null,e.pipe(u.U((({item:e,prevItem:i,transitions:r})=>n.createElement(bo.P,{key:e.id,sduiRootId:e.id,content:e.content,designSystem:Object.assign(Object.assign({},xo.k),{nativeExperimentalGBConsistencyUpsellFooter:()=>n.createElement("div",null,"nativeExperimentalGBConsistencyUpsellFooter not implemented")}),notify:(i,n,r)=>t({kind:"sduiNotify",item:e,sourceId:i,actions:n,actionScope:r})(),transitions:Array.from(r),prevContent:(0,A.zG)(i,E.map((e=>e.content))),onAnimationEnd:t({kind:"shortFormCardAnimationEnd"}),onMount:t({kind:"sduiItemMounted",item:e})}))))))})),wo=r.UI.Node.make((()=>n.createElement(ii,{style:Oo},n.createElement("p",{className:Ao},"Looking good so far. Keep writing to see suggestions.")))),_o=r.UI.Node.make((()=>n.createElement(ii,{style:Oo},n.createElement("p",{className:Ao},"All clear!")))),Io=r.UI.Node.make((()=>n.createElement(ii,{"aria-busy":"true",style:Oo},n.createElement("p",{className:Ao},"Checking your text...")))),Eo=r.UI.Union.make("kind",{loadingState:Io,emptyState:wo,successState:_o,nonEmptyState:Co}),Ao=a.ux.style({margin:0,color:F.Z.TextBaseSubduedColor,fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.3125)}),Oo={padding:`${a.ux.rem(o.qp)} ${a.ux.rem(o.mh)}`},Ro=r.UI.Group.make({feed:Eo}),Uo=r.UI.Group.make({feed:yo}),To=r.UI.Union.make("kind",{none:r.UI.Node.empty,shortFormFeed:Ro,longFormFeed:Uo});var Bo=i(31705);const Po=({placeholder:e,error:t,openAnswer:i,onOpenAnswerChange:r,onSubmitButtonClick:s,onCancelButtonClick:o,onKeypressShiftEnter:l})=>n.createElement("form",{className:zo,onSubmit:e=>e.preventDefault()},n.createElement(q,{className:Do,placeholder:[null!=e?e:""],text:i,onChange:r,ariaLabel:"Open ended answer",fitContentHeight:!0,theme:{fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125)},onKeyDownShiftEnter:l}),(0,A.zG)(t,E.fold((()=>null),(e=>n.createElement("div",{className:Mo},e)))),n.createElement("div",{className:No},n.createElement("input",{type:"submit",value:"Submit",hidden:!0}),n.createElement(j.z.Secondary,{style:{base:Object.assign(Object.assign({},Go),jo),hovered:Fo},onClick:s},"Submit"),n.createElement(j.z.Tertiary,{style:{base:Go},onClick:o},"Dismiss"))),No=a.ux.style({display:"flex",justifyContent:"flex-start",alignItems:"center"}),zo=a.ux.style({width:a.ux.percent(100)}),Go={minHeight:a.ux.rem(o.sD),lineHeight:a.ux.rem(o.sD)},jo={color:l.C$.Engagement.Primary.Default,fontWeight:"bold",boxShadow:`inset 0 0 0 1px ${l.C$.Engagement.Primary.Default}`,marginRight:a.ux.rem(o.x)},Fo={color:l.XY.Surface.Primary.Default,backgroundColor:l.C$.Engagement.Primary.Default},Do=a.ux.style({border:`1px solid ${h.BlueGray10}`,minHeight:a.ux.rem(7.5*o.F2),backgroundColor:h.White,borderRadius:a.ux.rem(o.x),width:a.ux.percent(100),padding:`${a.ux.rem(1.25*o.F2)} ${a.ux.rem(o.x)}`,boxSizing:"border-box"}),Mo=a.ux.style({color:l.vU.DangerAndDeletion.Primary.Default,fontSize:a.ux.rem(.75),marginBottom:a.ux.rem(o.F2)});var Vo=i(77678),Lo=i(56377);const Ho=e=>n.createElement(g.a1,Object.assign({width:"18",height:"17",viewBox:"0 0 18 17",fill:"none"},e),n.createElement("path",{d:"M9 1L11.069 6.15226L16.6085 6.52786L12.3477 10.0877L13.7023 15.4721L9 12.52L4.29772 15.4721L5.65228 10.0877L1.39155 6.52786L6.931 6.15226L9 1Z",fill:"transparent",stroke:h.NeutralGray50,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})),Ko=({rating:e,ratingLabels:t,maxScore:i})=>(0,A.zG)(e,E.fold((()=>t.length>=i&&i>1?n.createElement("div",{className:Zo},n.createElement("span",{className:Wo},t[0]),n.createElement("span",{className:Wo},t[i-1])):null),(e=>e-1>=0&&t.length>=e?n.createElement("div",{className:$o},n.createElement("span",null,t[e-1])):null))),$o=a.ux.style({display:"flex",justifyContent:"center",alignItems:"center",width:"100%",fontWeight:"bold",fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(.875)}),Wo=a.ux.style({color:h.NeutralGray50}),Zo=a.ux.style({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(.875)});var qo=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const Yo=({disabled:e,rating:t,ratingLabels:i,maxScore:r,onSelectionChange:s})=>{const[o,l]=n.useState(E.none),c=n.useMemo((()=>[]),[]),u=t=>{e||s(t+1)},d=t=>{e||l(E.some(t+1))},m=()=>{e||l(E.none)};return n.createElement(n.Fragment,null,n.createElement("div",{className:Xo,role:"slider","aria-valuemin":0,"aria-valuenow":(0,A.zG)(t,E.getOrElse((()=>0))),"aria-valuemax":5,"aria-valuetext":(0,A.zG)(t,E.fold((()=>"Not yet rated"),(e=>i[e-1])))},Array.from({length:r}).map(((s,l)=>n.createElement(Qo,{key:l,onClick:()=>u(l),style:{maxWidth:a.ux.percent(r>0?100/r:0)},isFilled:(0,A.zG)(t,E.fold((()=>!1),(e=>l<e)))||(0,A.zG)(o,E.fold((()=>!1),(e=>l<e))),onMouseEnter:()=>d(l),onMouseLeave:m,onFocus:()=>d(l),onBlur:m,isSelected:(0,A.zG)(t,E.fold((()=>!1),(e=>l+1===e))),isFocusable:(0,A.zG)(t,E.fold((()=>0===l),(e=>l+1===e))),ariaLabel:`Rate this generated output as ${i[l]}`,ref:e=>c.push(e),onKeyDown:t=>((t,i)=>{var n,s,a,l;e||("ArrowRight"!==t.key&&"ArrowUp"!==t.key||((0,A.zG)(o,E.fold((()=>!1),(e=>e<r)))?null===(n=c[i+1])||void 0===n||n.focus():null===(s=c[0])||void 0===s||s.focus()),"ArrowLeft"!==t.key&&"ArrowDown"!==t.key||((0,A.zG)(o,E.fold((()=>!1),(e=>e>1)))?null===(a=c[i-1])||void 0===a||a.focus():null===(l=c[4])||void 0===l||l.focus()),"Enter"!==t.key&&" "!==t.key||u(i))})(t,l),disabled:e})))),n.createElement(Ko,{rating:(0,A.zG)(t,E.fold((0,A.a9)(o),(0,A.a9)(t))),ratingLabels:i,maxScore:r}),n.createElement(Lo.L,{small:!0}))},Xo=a.ux.style({display:"flex",width:a.ux.percent(100),justifyContent:"center"}),Qo=n.forwardRef(((e,t)=>{var{isFilled:i,ariaLabel:r,disabled:s,isSelected:o,isFocusable:a}=e,l=qo(e,["isFilled","ariaLabel","disabled","isSelected","isFocusable"]);return n.createElement("button",Object.assign({className:Jo,role:"radio","aria-label":r,disabled:s,"aria-checked":o,tabIndex:a?0:-1,ref:t},l),n.createElement(Ho,{className:i?ea:""}))}));Qo.displayName="StarButton";const Jo=a.ux.style({border:"none",background:"none",cursor:"pointer",padding:0,borderRadius:a.ux.rem(o.F2),width:a.ux.rem(o.Lw),$nest:{"&:focus-visible":{outlineStyle:"none",boxShadow:`0 0 0 2px ${l.XY.Content.Secondary.Default}`}}}),ea=a.ux.style({$nest:{"& path":{fill:Vo.CoreYellow50,stroke:Vo.CoreYellow50}}});var ta=i(59769),ia=i(46560);const na=({stage:e,rating:t,initialTitle:i,acknowledgment:r,acknowledgmentTitle:s,onCloseButtonClick:l,className:c})=>n.createElement("div",{className:a.ux.joinClasses([ra,c])},n.createElement(ta._,{className:oa,fill:"#000"}),n.createElement(aa,{stage:e,rating:t,initialTitle:i,acknowledgment:r,acknowledgmentTitle:s}),n.createElement(j.z.Tertiary,{"aria-label":"Close survey",style:{base:{marginLeft:"auto",padding:0,minWidth:a.ux.rem(o.qp),minHeight:a.ux.rem(o.qp)},hovered:{backgroundColor:h.BlueGray10},active:{backgroundColor:h.BlueGray10}},onClick:l},n.createElement(ia.B,null))),ra=a.ux.style({display:"flex",alignItems:"center"}),sa=a.ux.style({fontSize:a.ux.rem(.75)}),oa=a.ux.style({marginRight:a.ux.rem(o.qp),$nest:{"& path:first-of-type":{fill:h.NeutralGray70}}}),aa=({stage:e,rating:t,initialTitle:i,acknowledgmentTitle:r,acknowledgment:s})=>{switch(e){case Bo.x.Stage.Type.Rating:return n.createElement("span",{className:sa},i);case Bo.x.Stage.Type.Feedback:return n.createElement("span",{className:sa},"Your rating:"," ",Array.from({length:t}).map((()=>"⭐")).join(" "));case Bo.x.Stage.Type.Completed:return n.createElement("span",{className:sa},(0,A.zG)(r,E.fold((()=>n.createElement("b",null,"Thank you!")),(e=>n.createElement("b",null,e))))," ",(0,A.zG)(s,E.fold((()=>"Your feedback helps us improve."),(e=>e))));case Bo.x.Stage.Type.Closed:return null;default:return(0,d.L0)(e)}},la=r.UI.Union.asOption(r.UI.Node.make((({notify:e,state:t})=>n.createElement(m.F.Fragment,null,t.pipe(u.U((t=>n.createElement(ca,Object.assign({},t,{onRatingSelectionChange:t=>{e({kind:P.i.Kind.surveyRatingSelectionChange,rating:t})()},onOpenAnswerChange:t=>e({kind:P.i.Kind.surveyOpenAnswerChange,openAnswer:t})(),onSubmitButtonClick:e({kind:P.i.Kind.surveySubmitButtonClick}),onKeypressShiftEnter:e({kind:P.i.Kind.surveyKeyPressShiftEnter}),onCancelButtonClick:e({kind:P.i.Kind.surveyCancelButtonClick}),onCloseButtonClick:e({kind:P.i.Kind.surveyCloseButtonClick})}))))))))),ca=({survey:e,stage:t,transitionStage:i,rating:r,errors:s,openAnswer:o,onOpenAnswerChange:l,onRatingSelectionChange:c,onCloseButtonClick:u,onCancelButtonClick:d,onSubmitButtonClick:m,onKeypressShiftEnter:p})=>n.createElement("div",{className:ua},n.createElement(na,{className:a.ux.joinClasses([i===Bo.x.Stage.Type.Feedback?pa:void 0,t===Bo.x.Stage.Type.Feedback?ha:void 0]),stage:t,rating:(0,A.zG)(r,E.getOrElse((0,A.a9)(1))),initialTitle:e.title,acknowledgment:e.acknowledgment,acknowledgmentTitle:e.acknowledgmentTitle,onCloseButtonClick:u}),t!==Bo.x.Stage.Type.Completed&&n.createElement(n.Fragment,null,n.createElement("div",{className:a.ux.joinClasses([ga,i===Bo.x.Stage.Type.Feedback?pa:void 0,t===Bo.x.Stage.Type.Feedback?ha:void 0])},n.createElement("div",{className:va,hidden:t!==Bo.x.Stage.Type.Rating},n.createElement(Yo,{onSelectionChange:c,rating:r,disabled:E.isSome(r),maxScore:e.maxScore,ratingLabels:e.ratingLabels})),(0,A.zG)(e.openAnswer,E.fold((0,A.a9)("(Optional) Please share your feedback to help us improve."),(e=>e.placeholder)),(e=>n.createElement("div",{className:fa,hidden:t!==Bo.x.Stage.Type.Feedback},n.createElement(Po,{placeholder:e,onSubmitButtonClick:m,onKeypressShiftEnter:p,onCancelButtonClick:d,onOpenAnswerChange:l,openAnswer:o,error:(0,A.zG)(s,E.chain((e=>e.openAnswerError)))}))))))),ua=a.ux.style({backgroundColor:h.BlueGray0,border:`1px solid ${h.BlueGray10}`,borderRadius:a.ux.rem(o.F2),padding:`${a.ux.rem(o.x)} ${a.ux.rem(o.mh)}`}),da=a.ux.keyframes({from:{opacity:1},to:{opacity:.3}}),ma=a.ux.keyframes({from:{opacity:.3},to:{opacity:1}}),pa=a.ux.style({animation:`${da} 0.3s ease-in-out`}),ha=a.ux.style({animation:`${ma} 0.3s ease-in-out`}),ga=a.ux.style({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:a.ux.rem(o.yC)}),fa=a.ux.style({width:a.ux.percent(100)}),va=a.ux.style({maxWidth:a.ux.percent(100),width:"fit-content",paddingTop:a.ux.rem(o.F2)}),ya=e=>n.createElement(g.a1,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),n.createElement("path",{d:"M12 7L12 17",strokeLinecap:"round"}),n.createElement("path",{d:"M9 9L9 15",strokeLinecap:"round"}),n.createElement("path",{d:"M15 9L15 15",strokeLinecap:"round"}),n.createElement("path",{d:"M18 11L18 13",strokeLinecap:"round"}),n.createElement("path",{d:"M6 11L6 13",strokeLinecap:"round"})),ba=r.UI.Node.make((({notify:e})=>n.createElement(ii,{style:Sa},n.createElement("div",{className:Ca},"Set your voice"),n.createElement("div",{className:wa},"Choose how you want your generated text to sound."),n.createElement(j.z.Primary,{className:Ia,onClick:e({kind:P.i.Kind.setVoiceButtonClick}),name:"bannerVoiceProfile",size:"small"},n.createElement(ya,{className:_a}),"Set voice")))),xa=r.UI.Union.asOption(ba),ka="setVoiceBtn",Sa={gap:0,backgroundColor:"#D8F2EC",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"right",backgroundImage:"url('https://d201kpdrh73vuz.cloudfront.net/text-generation/voice-banner.png')"},Ca=a.ux.style({fontWeight:700,fontSize:a.ux.rem(.875),lineHeight:a.ux.rem(1.375),color:l.XY.Content.Primary.Default}),wa=a.ux.style({fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),color:l.XY.Content.Secondary.Default}),_a=a.ux.style({stroke:"white"}),Ia=a.ux.joinClasses([ka,a.ux.style((0,v.dD)({alignSelf:"flex-start",marginTop:a.ux.rem(o.x),padding:`0 ${a.ux.rem(o.x)} 0 ${a.ux.rem(o.F2)}`,lineHeight:a.ux.rem(1.125),gap:a.ux.rem(o.F2),$nest:{"& > i":Object.assign({marginLeft:0},(0,v.fx)(1.5))}},ka))]);var Ea=i(53702),Aa=i(80900),Oa=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};function Ra(e){var{children:t,onOpenChange:i,title:r,placement:s="bottom end"}=e,o=Oa(e,["children","onOpenChange","title","placement"]);const a=n.useMemo((()=>yt.h.create(!1)),[]),l=n.useMemo((()=>a.pipe(we.h((e=>!0===e)),bt.w((()=>Aa.H(250))),R.b((()=>a.set(!1))))),[a]);return O.P.useSubscriptionTo(l),n.createElement(Lt.Consumer,null,(({portalContainer:e})=>n.createElement(m.F.Fragment,null,e.view(E.fold(A.gn,(e=>n.createElement(Ea.v.Dropdown,Object.assign({title:a.pipe(u.U((0,vt.RN)(void 0,r))),placement:s,portalContainer:e,onOpenChange:e=>{e||a.set(!0),null==i||i(e)}},o),t)))))))}const Ua=e=>n.createElement(g.a1,Object.assign({width:"12",height:"15",viewBox:"0 0 12 15",fill:"#99A0B3"},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.5 0.5C0.776142 0.5 1 0.723858 1 1V2H11.5C11.7022 2 11.8845 2.12182 11.9619 2.30866C12.0393 2.4955 11.9966 2.71055 11.8536 2.85355L8.70711 6L11.8536 9.14645C11.9966 9.28945 12.0393 9.5045 11.9619 9.69134C11.8845 9.87818 11.7022 10 11.5 10H1V14.5C1 14.7761 0.776142 15 0.5 15C0.223858 15 0 14.7761 0 14.5V1C0 0.723858 0.223858 0.5 0.5 0.5ZM1 9H10.2929L7.64645 6.35355C7.45118 6.15829 7.45118 5.84171 7.64645 5.64645L10.2929 3H1V9Z",stroke:"none"}));var Ta=i(95835);const Ba="reportMenuBtnIcon",Pa=(0,v.dD)((0,v.fx)(1.5),Ba),Na=({reportMenuButtonClassName:e,onClickReportOffensive:t,onClickProvideFeedback:i,onOpenChange:r})=>n.createElement(Ra,{"aria-label":"Provide feedback",title:"Provide feedback",name:"reportMenu",label:n.createElement(Ua,{className:a.ux.joinClasses([Ba,a.ux.style(Pa)])}),theme:{button:a.ux.joinClasses([e,(0,Ta.P)({type:"tertiary",compact:!0,size:"small"})])},onAction:e=>{switch(e){case"provideFeedback":return i();case"reportOffensive":return t()}},onOpenChange:r},n.createElement(Ea.v.Item,{key:"provideFeedback",textValue:"provideFeedback"},n.createElement(g.JO.AssistantFeedback,null),"Share your thoughts"),n.createElement(Ea.v.Item,{key:"reportOffensive",textValue:"reportOffensive"},n.createElement(g.JO.Report,null),"Report as offensive"));var za=i(123);const Ga=({style:e,mode:t="standard"})=>{const i="standard"==t?1:.875;return n.createElement("div",{className:a.ux.style({height:a.ux.rem(2*i),display:"flex",alignItems:"center",gap:a.ux.rem(o.x),padding:`0 ${a.ux.rem(o.x)} 0 ${a.ux.rem(o.F2)}`,borderRadius:a.ux.rem(o.F2),border:`1px solid ${h.BlueGray5}`,boxSizing:"border-box"},e)},n.createElement("div",{className:a.ux.style({width:a.ux.rem(1.5*i),height:a.ux.rem(1.5*i),borderRadius:a.ux.rem(1.5*i),background:h.BlueGray5})}),n.createElement("div",{className:a.ux.style({height:a.ux.rem(.5*i),borderRadius:a.ux.rem(o.W9),background:h.BlueGray5,flexGrow:1})}))},ja=r.UI.Node.make((({view:e})=>n.createElement(ii,{"aria-busy":"true"},n.createElement(m.F.Fragment,null,e("withContext").pipe(u.U((0,vt.RN)(n.createElement(Te,{active:!0},e("header")),n.createElement(ue,null,e("header")))))),n.createElement(m.F.div,{className:Fa},n.createElement(Es,null),e("isQuickReply").pipe(u.U((0,vt.RN)(n.createElement(n.Fragment,null,n.createElement(Ga,{style:{width:a.ux.rem(23)}}),n.createElement(Ga,{style:{width:a.ux.rem(21.5)}}),n.createElement(Ga,{style:{width:a.ux.rem(20.5)}})),n.createElement(n.Fragment,null,n.createElement(Ga,{style:{width:a.ux.rem(8.375)}}),n.createElement(Ga,{style:{width:a.ux.rem(9.3125)}}),n.createElement(Ga,{style:{width:a.ux.rem(10.5)}}),n.createElement(Ga,{style:{width:a.ux.rem(10.75)}}),n.createElement(Ga,{style:{width:a.ux.rem(4.9375)}}))))))))),Fa=a.ux.style({display:"flex",flexWrap:"wrap",gap:a.ux.rem(o.x),position:"relative"}),Da=r.UI.Knot.make(r.UI.Grid.make((({slots:e,notify:t,state:i})=>{const{notifyUnmount:r}=n.useContext(G),{onMount:s}=(0,B.F)((0,A.ls)(R.b((e=>t({kind:P.i.Kind.mount,name:N.e.initialActionsList,element:e})())),U.x((()=>r({kind:P.i.Kind.unmount,name:N.e.initialActionsList})))));return n.createElement(ii,{style:Va,ref:s},n.createElement(m.F.Fragment,null,i.pipe(u.U((({isQuickReply:e})=>e?n.createElement(Na,{reportMenuButtonClassName:La,onClickProvideFeedback:t({kind:P.i.Kind.openFeedbackFormButtonClick,source:ni.x.Source.quickReplyInitialActions}),onClickReportOffensive:t({kind:P.i.Kind.reportOffensiveActionsButtonClick}),onOpenChange:e=>t({kind:P.i.Kind.reportMenuVisibilityChange,trigger:za.G.uiItem(N.e.initialActionsList),visible:e})()}):null))),e.actions))})),{actions:De}),Ma=r.UI.Union.make("kind",{none:r.UI.Node.empty,loading:ja,loaded:Da}),Va={position:"relative",padding:`${a.ux.rem(o.F2)} ${a.ux.rem(o.qp)}`},La=a.ux.style({position:"absolute",top:a.ux.rem(o.qp),right:a.ux.rem(o.qp)}),Ha=r.UI.Knot.make(r.UI.Grid.make((({slots:e,notify:t})=>{const{notifyUnmount:i}=n.useContext(G),{onMount:r}=(0,B.F)((0,A.ls)(R.b((e=>t({kind:P.i.Kind.mount,name:N.e.followUpActionsList,element:e})())),U.x((()=>i({kind:P.i.Kind.unmount,name:N.e.followUpActionsList})))));return n.createElement("div",{className:a.ux.style(qa),ref:r},e.actions)})),{actions:ye}),Ka=a.ux.color(Rt),$a=r.UI.Node.make((()=>n.createElement("div",{"aria-busy":!0,className:a.ux.style(qa,{position:"relative"})},n.createElement(Es,{overlayGradientEndColor:`rgba(${Ka.red()}, ${Ka.green()}, ${Ka.blue()}, 0)`,overlayGradientCenterColor:`rgba(${Ka.red()}, ${Ka.green()}, ${Ka.blue()}, 0.5)`,overlayBlendMode:"screen"}),n.createElement(Ga,{style:{width:a.ux.rem(8.5)},mode:"compact"}),n.createElement(Ga,{style:{width:a.ux.rem(9.25)},mode:"compact"}),n.createElement(Ga,{style:{width:a.ux.rem(8)},mode:"compact"}),n.createElement(Ga,{style:{width:a.ux.rem(4.5)},mode:"compact"})))),Wa=r.UI.Union.make("kind",{none:r.UI.Node.empty,loading:$a,actions:Ha}),Za=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement(n.Fragment,null,e.actions))),{actions:Wa}),qa={display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end",flexDirection:"row",width:"100%",gap:a.ux.rem(o.x),marginBottom:a.ux.rem(o.x)},Ya=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement(ii,{style:el},e.actions))),{actions:De}),Xa=r.UI.Union.make("kind",{loading:ja,loaded:Ya}),Qa=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>n.createElement("div",null,e.actions))),{actions:Xa}),Ja=r.UI.Union.asOption(Qa),el={position:"relative",padding:`${a.ux.rem(o.F2)} ${a.ux.rem(o.qp)}`},tl=r.UI.Union.make("kind",{followUp:Za,newContext:Ja}),il=r.UI.Union.asOption(tl),nl=({onInsert:e,onRephrase:t,onDismiss:i,onProvideFeedback:r,onReportOffensive:s,onReportMenuVisibilityChange:o,disabled:a})=>n.createElement("div",{className:sl},n.createElement("div",{className:al},(0,A.zG)(e,E.map((e=>n.createElement(j.z.Primary,{className:dl,name:"insertResult",onClick:e,size:"small",key:"insert"},"Insert"))),E.toNullable),(0,A.zG)(t,E.map((e=>n.createElement(j.z.Tertiary,{className:ml,name:"rephraseResult",onClick:e,disabled:a,size:"small",key:"rephase"},"Rephrase"))),E.toNullable)),n.createElement("div",{className:ll},n.createElement(j.z.Tertiary,{onClick:i,className:cl,compact:!0,size:"small",name:"dismissResult",title:"Delete"},n.createElement(me,{className:pl})),n.createElement(Na,{reportMenuButtonClassName:ul,onClickProvideFeedback:r,onClickReportOffensive:s,onOpenChange:o}))),rl="ignoreIcon",sl=a.ux.style({gap:a.ux.rem(o.x),display:"flex",alignItems:"center",justifyContent:"space-between"}),ol={display:"flex",alignItems:"center",gap:a.ux.rem(o.x)},al=a.ux.style(ol),ll=a.ux.style(ol),cl=Vs,ul=Ls,dl=Ds,ml=Ms,pl=a.ux.joinClasses([rl,a.ux.style((0,v.dD)((0,v.fx)(1.5),rl))]),hl=r.UI.Grid.make((({state:e,notify:t,slots:i})=>n.createElement(m.F.Fragment,null,e.pipe(u.U((({disabled:e,result:r,originalAction:s})=>n.createElement(Ws,{resultId:r.id,body:n.createElement(n.Fragment,null,n.createElement("div",{className:a.ux.style({borderBottom:`0.5px solid ${h.BlueGray10}`})},n.createElement(qs,{text:r.text}),n.createElement("div",{className:a.ux.style({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:a.ux.rem(.5),marginTop:a.ux.rem(.5),marginBottom:a.ux.rem(.75)})},i.actions)),(0,A.zG)(s,E.map((i=>n.createElement("div",null,n.createElement(qs,{text:"Continue with your original prompt:"}),n.createElement("div",{className:a.ux.style({paddingTop:a.ux.rem(.125)})},n.createElement(gl,{disabled:e,action:i,onClick:t({kind:P.i.Kind.userPromptSubmit,prompt:i})}))))),E.toNullable)),header:n.createElement("h2",{className:a.ux.style({fontSize:a.ux.rem(1),marginBottom:a.ux.rem(.2),marginTop:0,lineHeight:a.ux.rem(1.5)})},"Review your AI use"),isActive:!0,footer:n.createElement(nl,{onRephrase:E.none,onInsert:E.none,onDismiss:t({kind:P.i.Kind.resultCardDismissButtonClick,result:r}),onProvideFeedback:t({kind:P.i.Kind.openFeedbackFormButtonClick,source:ni.x.Source.resultCard}),onReportOffensive:t({kind:P.i.Kind.reportOffensiveResultButtonClick,result:r}),onReportMenuVisibilityChange:e=>t({kind:P.i.Kind.reportMenuVisibilityChange,trigger:za.G.card(r.id),visible:e})(),disabled:e}),customStyles:{borderColor:h.Gold40,borderTopWidth:a.ux.rem(.375)}}))))))),gl=({action:e,onClick:t,disabled:i})=>n.createElement("button",{onClick:t,disabled:i,className:a.ux.style({textDecoration:"underline",color:h.BlueGray60,background:a.ux.important("none"),border:"none",cursor:"pointer",lineHeight:a.ux.rem(1.375),fontSize:a.ux.rem(.875),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",textAlign:"left"})},'"',e.arg.value,'"'),fl=r.UI.Knot.make(hl,{actions:ye});var vl=i(95195),yl=i(14047);const bl=({title:e,url:t,contextText:i})=>{const r=n.useRef(null),s=oo(r,e),o=(0,A.zG)(i,E.getOrElse((()=>s)));return(0,A.zG)(t,E.fold((()=>n.createElement(Sl,{tooltip:o},n.createElement("span",{className:xl,ref:r},e))),(t=>n.createElement(Sl,{tooltip:o},n.createElement("div",{className:kl},n.createElement(so.d,{href:t,className:xl,ref:r},e))))))},xl=a.ux.style({display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",maxWidth:"100%",$nest:{"&:visited":{color:"inherit"}}}),kl=a.ux.style({display:"flex",alignItems:"center",width:"100%",overflow:"hidden"}),Sl=({children:e,tooltip:t})=>t?n.createElement(Dn.u,{align:"topCenter",title:n.createElement("div",{className:Cl},t)},e):n.createElement(n.Fragment,null,e),Cl=a.ux.style({maxWidth:a.ux.rem(80*o.F2),textAlign:"left",whiteSpace:"normal",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":5,"-webkit-box-orient":"vertical"}),wl=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{d:"M12 10.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm-10 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z",fill:"#646B81"})),_l=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.194 7.5H7.5v-1H11V10h-1V8.18a4.926 4.926 0 0 0-2.5 4.32 5.002 5.002 0 0 0 3.214 4.672l-.357.934A6.002 6.002 0 0 1 6.5 12.5a5.925 5.925 0 0 1 2.694-5Zm8.306 5c0-2.128-1.33-3.92-3.214-4.64l.357-.934c2.251.86 3.857 3.011 3.857 5.574a5.988 5.988 0 0 1-2.655 5H17.5v1H14V15h1v1.848a4.985 4.985 0 0 0 2.5-4.348Z",fill:"#646B81"})),Il=({onRegenerateWithoutReference:e})=>n.createElement(Ra,{name:"referenceMenu",title:"Reference menu","aria-label":"Reference menu",label:n.createElement(wl,null),theme:{button:El},onAction:t=>{if("regenerateWithoutReference"===t)return e()}},n.createElement(Ea.v.Item,{key:"regenerateWithoutReference",textValue:"regenerateWithoutReference"},n.createElement(_l,{className:Al}),"Regenerate without this reference")),El=(0,Ta.P)({type:"tertiary",compact:!0,size:"small"}),Al=a.ux.style({marginRight:a.ux.rem(o.x)}),Ol=({className:e,children:t})=>n.createElement("div",Object.assign({},(0,be.Sh)(Rl,e)),t),Rl=a.ux.style({color:h.BlueGray60,fontWeight:400,fontSize:a.ux.rem(.625),lineHeight:a.ux.rem(1),background:h.BlueGray0,borderRadius:a.ux.rem(c.fe),padding:`0 ${a.ux.rem(o.F2)}`,cursor:"default"}),Ul=({privacyLevel:e})=>{switch(e.kind){case"public":return n.createElement(Tl,null);case"restricted":return n.createElement(Bl,null);default:return(0,A.Rz)(e)}},Tl=()=>n.createElement(n.Fragment,null),Bl=()=>n.createElement(Dn.u,{align:"topLeft",title:n.createElement("div",{className:Pl},"This item has restricted access and is only visible to those added to the file")},n.createElement(Ol,{className:Nl},"Private")),Pl=a.ux.style({width:a.ux.rem(9),overflowWrap:"normal",whiteSpace:"normal",textAlign:"left"}),Nl=a.ux.style({border:`1px solid ${F.Z.BorderBaseSubduedColor}`,borderRadius:a.ux.rem(o.F2)}),zl=({className:e,isOpen:t,references:i,onOpenChange:r,onRegenerateWithoutReference:s,onReferencesMount:o})=>{const{onMount:a}=(0,B.F)(R.b(o));return n.createElement(m.F.div,{className:e,mount:a},n.createElement(j.z.Tertiary,{style:Gl,onClick:()=>r(!t),name:"collapseReferencesList",size:"small"},n.createElement("span",{className:Fl},i.length," ",ei._6(i.length,"reference","references")),t?n.createElement(g.JO.Arrow,{direction:g.n4.up}):n.createElement(g.JO.Arrow,{direction:g.n4.down})),n.createElement("ul",{className:Dl,hidden:!t,"aria-hidden":!t},i.map((({id:e,privacyLevel:t,title:i,iconUrl:r,url:o,contextText:a},l)=>n.createElement("li",{key:l,className:Ml},n.createElement("img",{src:r,className:Vl,alt:""}),n.createElement(bl,{title:i,url:o,contextText:a}),n.createElement("div",{className:Ll},n.createElement(Ul,{privacyLevel:t}),void 0!==s?n.createElement(Il,{onRegenerateWithoutReference:()=>s(e)}):null))))))},Gl={base:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:a.ux.rem(o.F2),paddingRight:0}},jl={fontSize:a.ux.rem(o.qp),lineHeight:a.ux.rem(o.mh+o.yC),color:l.XY.Content.Secondary.Default,userSelect:"none"},Fl=a.ux.style(jl),Dl=a.ux.style({fontSize:a.ux.rem(o.qp),lineHeight:a.ux.rem(o.mh+o.yC),color:l.XY.Content.Primary.Default,margin:0,padding:0}),Ml=a.ux.style({height:a.ux.rem(o.sD),display:"flex",alignItems:"center",borderRadius:a.ux.rem(c.xB)}),Vl=a.ux.style({minWidth:a.ux.rem(o.mh),height:a.ux.rem(o.mh),marginRight:a.ux.rem(o.x)}),Ll=a.ux.style({display:"flex",alignItems:"center",justifyContent:"space-between",marginLeft:"auto"});var Hl=i(55243);const Kl=({title:e,titleId:t,desc:i,descId:r,...s})=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":r,...s},i?n.createElement("desc",{id:r},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.784 6.21a.727.727 0 0 1 .006 1.029L9.203 17.943 4.21 12.895a.727.727 0 1 1 1.034-1.023l3.959 4.003 9.553-9.66a.727.727 0 0 1 1.028-.005Z",fill:"#646B81"})),$l=({className:e,title:t,description:i})=>n.createElement("div",{className:a.ux.joinClasses([Wl,e])},n.createElement("div",{className:Zl},n.createElement("span",{className:Ql},t)),n.createElement("ul",{className:ql},i.map(((e,t)=>n.createElement("li",{className:Yl,key:t},n.createElement(Kl,{className:Xl}),n.createElement("span",{className:Jl},e)))))),Wl=a.ux.style({display:"flex",flexDirection:"column"}),Zl=a.ux.style({display:"flex"}),ql=a.ux.style({display:"flex",flexDirection:"column",listStyle:"none",margin:0,padding:0,$nest:{"& li":{marginTop:a.ux.rem(o.F2)}}}),Yl=a.ux.style({display:"flex",alignItems:"center"}),Xl=a.ux.style({marginRight:a.ux.rem(o.x),width:a.ux.rem(o.mh),maxHeight:a.ux.rem(o.mh+o.yC),$nest:{"& path:first-of-type":{fill:h.Green60}}}),Ql=a.ux.style({fontSize:a.ux.rem(o.qp),lineHeight:a.ux.rem(o.mh+o.yC),fontWeight:700,color:l.XY.Content.Secondary.Default}),Jl=a.ux.style({fontSize:a.ux.rem(o.qp),lineHeight:a.ux.rem(o.mh+o.yC),color:l.XY.Content.Secondary.Default,flex:1});var ec=i(7754);const tc=r.UI.Grid.make((({slots:e,state:t,notify:i})=>n.createElement(m.F.Fragment,null,e.contextHeader,t.pipe(u.U((({result:t,disabled:r,isActive:s,isReferencesOpen:o,isMyVoice:a})=>n.createElement(Ws,{resultId:t.id,body:n.createElement(Hl.r,{replacementDelta:(0,A.zG)(t.replacementDelta,vl.fold(A.yR,(e=>a?e.user:e.generic)))}),header:e.header,footer:n.createElement(n.Fragment,null,(0,A.zG)(yl.x.isComplete(t)?t.changesSummary:E.none,E.map((e=>n.createElement(n.Fragment,null,n.createElement(vr,{className:nc}),n.createElement($l,{title:e.title,description:e.description,className:rc})))),E.toNullable),n.createElement(nl,{onRephrase:(0,A.zG)(t,E.fromPredicate(yl.x.isComplete),E.filter((e=>e.isRephraseable)),E.map((e=>i({kind:P.i.Kind.resultCardRephraseButtonClick,result:e,selectedVoice:a?yl.x.GeneratedTextVoice.user:yl.x.GeneratedTextVoice.generic})))),onInsert:(0,A.zG)(t.primaryAction,E.filter((e=>e===yl.x.PrimaryAction.insert)),E.map((()=>i({kind:P.i.Kind.resultCardInsertButtonClick,result:t,selectedVoice:a?yl.x.GeneratedTextVoice.user:yl.x.GeneratedTextVoice.generic})))),onDismiss:i({kind:P.i.Kind.resultCardDismissButtonClick,result:t}),onProvideFeedback:i({kind:P.i.Kind.openFeedbackFormButtonClick,source:ni.x.Source.resultCard}),onReportOffensive:i({kind:P.i.Kind.reportOffensiveResultButtonClick,result:t}),onReportMenuVisibilityChange:e=>i({kind:P.i.Kind.reportMenuVisibilityChange,trigger:za.G.card(t.id),visible:e})(),disabled:r}),(0,A.zG)(t.references,E.filter((e=>e.length>0)),E.map((e=>n.createElement(zl,{className:sc,isOpen:o,references:e,onOpenChange:e=>i({kind:P.i.Kind.referencesVisibilityChange,visible:e,resultId:t.id})(),onRegenerateWithoutReference:yl.x.isComplete(t)?e=>i({kind:P.i.Kind.regenerateWithoutReferenceButtonClick,result:t,referenceId:e,selectedVoice:a?yl.x.GeneratedTextVoice.user:yl.x.GeneratedTextVoice.generic})():void 0,onReferencesMount:e=>i({kind:P.i.Kind.mount,name:N.e.referencesList,element:e})()}))),E.toNullable)),isActive:s,onHovered:e=>i({kind:P.i.Kind.resultCardHoverChange,hovered:e,resultId:t.id})(),onFocused:e=>i({kind:P.i.Kind.resultCardFocusChange,focused:e,resultId:t.id})(),onCopy:i({kind:P.i.Kind.resultCardCopy,resultId:t.id})}))))))),ic=r.UI.Knot.make(tc,{header:ec.oq,contextHeader:zs}),nc=a.ux.style({margin:`${a.ux.rem(o.F2)} 0`}),rc=a.ux.style({marginBottom:a.ux.rem(o.F2)}),sc=a.ux.style({marginTop:a.ux.rem(o.x)}),oc=r.UI.Union.make("kind",{promptResultComplete:ic,aiUsageNotification:fl}),ac=r.UI.List.make(s.bw,oc),lc=r.UI.Union.asOption(ac),cc=r.UI.Grid.make((({slots:e})=>n.createElement(n.Fragment,null,e.suggestions,e.voiceBanner,e.documentOverview,e.intent,e.resultList,e.lastResultSurvey,e.lastResultActions,e.inProgressResult,e.defaultActions,e.generationError,e.detectedReferences))),uc=r.UI.Knot.make(cc,{suggestions:To,voiceBanner:xa,documentOverview:xs,intent:Ts,resultList:lc,lastResultSurvey:la,lastResultActions:il,inProgressResult:ro,defaultActions:Ma,generationError:ps,detectedReferences:uo}),dc=r.UI.Union.make("kind",{main:uc,error:ps,followUpPrompt:Fi,legacyVoiceProfile:fr,voiceProfile:os,feedbackForm:Ai,skill:en,settings:r.UI.Node.empty,toneReport:r.UI.Node.empty,longFormFeed:r.UI.Node.empty}),mc=e=>n.createElement(g.a1,{className:e.className,viewBox:"0 0 22 22",width:22,height:22},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 11C22 17.0749 17.0753 22 11 22C4.92513 22 0 17.0749 0 11C0 4.92465 4.92513 0 11 0C17.0753 0 22 4.92465 22 11Z",fill:"#018374",stroke:"none"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.4371 13.3755C12.5021 13.7356 12.8407 13.9824 13.2066 13.9824H14.3592L15.0274 13.8887C13.9584 15.4569 12.1023 16.1786 10.0731 15.8601C8.42114 15.6008 7.00214 14.4831 6.40336 12.9221C5.04414 9.37866 7.63201 5.99545 11.0042 5.99545C12.7618 5.99545 14.3037 7.05097 15.1876 8.29349C15.4224 8.63162 15.8868 8.72871 16.2254 8.49388C16.5468 8.27101 16.6405 7.84775 16.4473 7.51488C15.2249 5.60662 13.0282 4.38562 10.558 4.5511C7.34171 4.76679 4.73901 7.39866 4.55392 10.6169C4.33918 14.3617 7.30966 17.4192 11.0042 17.4192C12.945 17.4192 14.6825 16.5741 15.8662 15.2068L15.7261 15.9911V16.6999C15.7261 17.0653 15.9724 17.4044 16.3325 17.4694C16.8055 17.5545 17.2168 17.1934 17.2168 16.7362V12.4912H13.1698C12.7126 12.4912 12.3515 12.903 12.4371 13.3755Z",fill:"white",stroke:"none"})),pc=e=>n.createElement(g.a1,{className:e.className,viewBox:"0 0 19 18",width:19,height:18},n.createElement("path",{d:"M2.75 9.5L6.90385 13.5L16.25 4.5",stroke:F.Z.BrandGreen80,strokeLinecap:"round",fill:"none"})),hc=r.UI.Node.make((()=>n.createElement("div",{className:Cc},n.createElement(pc,null),"No Suggestions!"))),gc=r.UI.Node.make((({view:e,notify:t})=>n.createElement("div",{className:kc},n.createElement(m.F.button,{className:Sc,onClick:t({kind:"expandSuggestionsButtonClickAction"}),disabled:e("disabled"),name:"expandFeed",type:"button"},"Review suggestions",n.createElement(m.F.div,{className:vc},e("suggestionsCount")))))),fc=r.UI.Union.make("kind",{none:r.UI.Node.empty,noSuggestions:hc,withSuggestions:gc}),vc=a.ux.style({boxSizing:"border-box",display:"flex",minWidth:a.ux.rem(1.125),height:a.ux.rem(1.125),padding:`0 ${a.ux.rem(o.F2)}`,justifyContent:"center",alignItems:"center",border:`1px solid ${F.Z.BorderBaseInverse}`,color:l.XY.Content.OnPrimary.Default,background:F.Z.BackgroundNeutralDefault,fontWeight:700,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),borderRadius:a.ux.rem(c.HP)}),yc=`0px 1px 4px 0.5px ${a.ux.color(h.BlueGray40).toRGBA().fade(.3).toString()}, 0px 0px 0px 0.5px ${h.BlueGray40}`,bc={zIndex:1,position:"absolute",left:"50%",bottom:a.ux.rem(-.3125),transform:"translateX(-50%)"},xc={padding:`0 ${a.ux.rem(o.x)}`,height:a.ux.rem(1.75),display:"flex",justifyContent:"center",alignItems:"center",fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),gap:a.ux.rem(o.F2),borderRadius:a.ux.rem(c.fe),boxShadow:yc,backgroundColor:l.XY.Surface.Primary.Default,color:F.Z.TextBaseSubduedColor},kc=a.ux.style(Object.assign({},bc)),Sc=a.ux.style(Object.assign(Object.assign({},xc),{position:"relative",border:"none",cursor:"pointer",$nest:{"&:hover":{backgroundColor:h.BlueGray0},"&[disabled]":{cursor:"not-allowed"},"&::before":Object.assign(Object.assign({content:"''"},bc),{zIndex:-1,bottom:a.ux.rem(-.1875),width:`calc(100% - 2 * ${a.ux.rem(o.F2)})`,height:a.ux.rem(1.75),borderRadius:a.ux.rem(c.fe),boxShadow:yc,backgroundColor:l.XY.Surface.Primary.Default})}})),Cc=a.ux.style(Object.assign(Object.assign(Object.assign({},bc),xc),{bottom:a.ux.rem(-.5),$nest:{"& > i":Object.assign({},(0,v.fx)(1.125))}})),wc=e=>n.createElement(g.a1,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),n.createElement("path",{d:"M11.1439 8.77381C8.92013 10.9976 5.96543 11.6484 5.12591 10.8089C4.2864 9.96935 4.93718 7.01465 7.16097 4.79086C9.38476 2.56707 12.3395 1.91629 13.179 2.7558C14.0185 3.59531 13.3677 6.55002 11.1439 8.77381Z",stroke:"#646B81"}),n.createElement("path",{d:"M10.0977 5.83569L2.09766 13.8357",stroke:"#646B81",strokeLinecap:"round"}),n.createElement("path",{d:"M7 14C8.81333 12.6019 11.768 10.8841 11 13.9999C12.0667 13.0012 13.744 10.9621 14 12.6398",stroke:"#646B81",strokeLinecap:"round",strokeLinejoin:"round"})),_c=r.UI.Node.make((({view:e,notify:t})=>n.createElement(j.z.Tertiary,{style:e("flatUI").pipe(u.U((e=>e?Ec:Ac))),onClick:t({kind:P.i.Kind.headerVoiceButtonClick}),name:"headerVoiceProfileButton",size:e("flatUI").pipe(u.U((e=>e?"small":"medium"))),flatUI:e("flatUI")},n.createElement(wc,null),n.createElement(m.F.span,null,e("styleLabel"))))),Ic=r.UI.Union.asOption(_c),Ec={base:{padding:`0 ${a.ux.rem(o.F2)}`},icon:(0,v.fx)(1.5)},Ac={base:{padding:0,paddingRight:a.ux.rem(o.x),paddingLeft:a.ux.rem(o.x),minHeight:a.ux.rem(1.625),lineHeight:a.ux.rem(1.625),border:a.ux.px(1),borderStyle:"solid",borderColor:h.BlueGray20,borderRadius:a.ux.rem(.8125),gap:a.ux.rem(o.F2),flexWrap:"nowrap"},icon:(0,v.fx)(1.5)},Oc=r.UI.Node.make((({notify:e,view:t})=>n.createElement("div",{className:Rc},n.createElement(j.z.Tertiary,{compact:!0,onClick:e({kind:P.i.Kind.headerGoBackButtonClick}),name:"goBack"},n.createElement(g.JO.Arrow,{direction:g.n4.left})),n.createElement(m.F.div,{className:Uc},t("activeViewIconUrl").pipe(u.U(E.fold(A.gn,(e=>n.createElement("img",{src:e,style:{width:a.ux.rem(1.25),height:a.ux.rem(1.25)}}))))),t("activeViewLabel").pipe(u.U(E.fold(A.gn,(e=>n.createElement("span",null,e))))))))),Rc=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.x),color:h.BlueGray60,fontWeight:400,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125)}),Uc=a.ux.style({display:"flex",alignItems:"center",gap:a.ux.rem(o.x)});var Tc=i(49708),Bc=i(598),Pc=i(13444),Nc=i(2768);const zc=r.UI.Node.make((({state:e,notify:t})=>{const{ref:i,onMount:r}=O.P.useElWatcher(),s=n.useMemo((()=>i.pipe(Ce.oA,bt.w((e=>Tc.R(e,"mouseenter").pipe(Bc.c(gt.of(null).pipe(Pc.g(500),Nc.R(Tc.R(e,"mouseleave"))))))),R.b(t({kind:P.i.Kind.creditsInfoHover})))),[i]);O.P.useSubscriptionTo(s);const{onMount:o}=(0,B.F)(R.b((e=>t({kind:P.i.Kind.mount,name:N.e.creditsInfoButton,element:e})())));return n.createElement(m.F.Fragment,null,e.pipe(u.U((({user:e,genAIAvailability:i})=>{const s=X._.isActive(i)?function(e){const t=`${Number(e.promptsRemaining).toLocaleString()}/${Number(e.promptsAllocated).toLocaleString()} prompts left. `,i=X._.Active.daysUntilRefillDate(e.refillDate),n=X._.Active.hoursUntilRefillDate(e.refillDate);return i>0?t+`Next refill in ${i} ${ei._6(i,"day","days")}.`:n>0?t+`Next refill in ${n} ${ei._6(n,"hour","hours")}.`:t+"Next refill in less than an hour."}(i):e.isPremium?"To get more prompts, contact support.":"To get more prompts, upgrade to Premium.",a=X._.isActive(i)?`${Number(i.promptsRemaining).toLocaleString()} ${ei._6(i.promptsRemaining,"prompt","prompts")}`:e.isPremium?"0 prompts":n.createElement(n.Fragment,null,"0 prompts. ",n.createElement("span",{className:Fc},"Upgrade"));return e.isPremium&&X._.isActive(i)?n.createElement(n.Fragment,null,X._.isActiveUnlimited(i)?null:n.createElement(Dn.u,{title:s},n.createElement("div",{ref:r,className:jc},a))):n.createElement(j.z.Tertiary,{onClick:t({kind:P.i.Kind.creditsInfoClick}),title:s,name:"creditsInfo",mount:o},n.createElement("div",{ref:r},a))}))))})),Gc=r.UI.Union.asOption(zc),jc=a.ux.style({padding:`${a.ux.rem(o.x)}`,fontSize:a.ux.rem(.75),lineHeight:a.ux.rem(1.125),color:l.XY.Content.Secondary.Default,cursor:"default"}),Fc=a.ux.style({color:h.Blue60}),Dc=e=>n.createElement(g.a1,Object.assign({width:"17",height:"16",viewBox:"0 0 17 16",fill:F.Z.TextBaseSubduedColor},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.5 8C2.5 4.41015 5.41015 1.5 9 1.5C12.5899 1.5 15.5 4.41015 15.5 8C15.5 11.5899 12.5899 14.5 9 14.5C7.85901 14.5 6.73812 14.1997 5.75 13.6292C5.51085 13.4911 5.42892 13.1853 5.56699 12.9462C5.70506 12.707 6.01085 12.6251 6.25 12.7631C7.08611 13.2459 8.03455 13.5 9 13.5C9.96545 13.5 10.9139 13.2459 11.75 12.7631C12.5861 12.2804 13.2804 11.5861 13.7631 10.75C14.2459 9.91389 14.5 8.96545 14.5 8C14.5 4.96243 12.0376 2.5 9 2.5C5.96243 2.5 3.5 4.96243 3.5 8V8.29289L4.64645 7.14645C4.84171 6.95118 5.15829 6.95118 5.35355 7.14645C5.54882 7.34171 5.54882 7.65829 5.35355 7.85355L3.35355 9.85355L3 10.2071L2.64645 9.85355L0.646447 7.85355C0.451184 7.65829 0.451184 7.34171 0.646447 7.14645C0.841709 6.95118 1.15829 6.95118 1.35355 7.14645L2.5 8.29289V8ZM9 4C9.27614 4 9.5 4.22386 9.5 4.5V7.5H11.5C11.7761 7.5 12 7.72386 12 8C12 8.27614 11.7761 8.5 11.5 8.5H9H8.5V8V4.5C8.5 4.22386 8.72386 4 9 4Z",stroke:"none"})),Mc=r.UI.Node.make((({state:e,view:t,notify:i})=>{const{onMount:r}=(0,B.F)(R.b((e=>i({kind:P.i.Kind.mount,name:N.e.historyButton,element:e})())));return n.createElement("div",{className:Lc},n.createElement(j.z.Tertiary,{mount:r,onClick:i({kind:P.i.Kind.restoreHistoryButtonClick}),disabled:t("state").pipe(u.U((e=>"disabled"===e||"loading"===e))),compact:!0,style:t("flatUI").pipe(u.U((e=>e?{}:Kc))),flatUI:t("flatUI"),size:t("flatUI").pipe(u.U((e=>e?"small":"medium"))),name:"restoreHistory",title:e.pipe(u.U((({flatUI:e,state:t})=>"disabled"===t?"No prior prompt to go back to.":"enabled"===t?e?"Pick up with your last prompt.":"Pick up where you left off":void 0)))},n.createElement(Dc,null)),n.createElement(m.F.Fragment,null,e.pipe(u.U((({flatUI:e,state:t})=>e&&"disabled"!==t?n.createElement("div",{key:"badge",role:"presentation",className:Hc}):null)))))})),Vc=r.UI.Union.asOption(Mc),Lc=a.ux.style({position:"relative"}),Hc=a.ux.style({width:a.ux.rem(.375),height:a.ux.rem(.375),borderRadius:a.ux.rem(.375),background:F.Z.BrandGreen60,position:"absolute",top:a.ux.rem(o.yC),right:a.ux.rem(-o.yC)}),Kc={base:{boxShadow:`0px 0px 1px ${a.ux.color(h.BlueGray40).toRGBA().fade(.5).toString()}, 0px 0.5px 8px -0.5px ${a.ux.color(h.BlueGray40).toRGBA().fade(.5).toString()}`}},$c="logo",Wc="sepAndRight",Zc=a.ux.style({display:"flex",alignItems:"center",justifyContent:"space-between",width:a.ux.percent(100),height:a.ux.percent(100),gap:a.ux.rem(o.x)}),qc={display:"flex",alignItems:"center",paddingRight:a.ux.rem(o.x)},Yc=a.ux.style(Object.assign(Object.assign({},qc),{gap:a.ux.rem(o.x)})),Xc=a.ux.style(Object.assign(Object.assign({},qc),{gap:a.ux.rem(o.F2)})),Qc=a.ux.style({display:"flex",flexDirection:"row",alignItems:"center",gap:a.ux.rem(o.x)}),Jc={height:a.ux.rem(1),borderLeft:`1px solid ${h.BlueGray20}`},eu=a.ux.style(Jc),tu=a.ux.style({display:"flex",flexDirection:"row",alignItems:"center",gap:a.ux.rem(o.F2)}),iu=a.ux.joinClasses([a.ux.style({display:"flex",alignItems:"center",justifyContent:"center",height:a.ux.rem(2)}),$c]),nu=a.ux.style({display:"flex",flexDirection:"row",alignItems:"center"}),ru=(a.ux.style(Object.assign(Object.assign({},Jc),{marginLeft:a.ux.rem(o.x),marginRight:a.ux.rem(o.F2)})),a.ux.joinClasses([a.ux.style({display:"flex",alignItems:"center"}),Wc])),su=(a.ux.style({display:"flex",flexDirection:"row",alignItems:"center",height:a.ux.rem(2)}),r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:Qc},e.back,n.createElement("div",{className:eu}),e.voice)))),ou=r.UI.Knot.make(su,{back:Oc,voice:_c}),au=()=>n.createElement("div",{className:nu},n.createElement(mc,{className:iu})),lu=r.UI.Node.make(au),cu=r.UI.Composite.make(r.UI.Grid.make((({slots:e})=>n.createElement("div",{className:tu},n.createElement(au,null),n.createElement("div",{className:ru},e.content)))),_c),uu=r.UI.Union.make("kind",{logoOnly:lu,logoAndVoiceButton:cu,backButton:Oc,backButtonAndVoiceButton:ou}),du=r.UI.Grid.make((({slots:e,view:t})=>n.createElement(m.F.div,{className:t("flatUI").pipe(u.U((e=>e?Xc:Yc)))},e.voiceButton,e.historyButton,e.credits))),mu=r.UI.Knot.make(du,{voiceButton:Ic,historyButton:Vc,credits:Gc}),pu=r.UI.Grid.make((({slots:e,view:t,notify:i})=>n.createElement(n.Fragment,null,n.createElement("div",{className:Zc},e.left,e.expandFeedButton,e.right),n.createElement(j.z.Tertiary,{onClick:i({kind:P.i.Kind.headerCloseButtonClick}),compact:!0,flatUI:t("flatUI"),size:t("flatUI").pipe(u.U((e=>e?"small":"large"))),name:"headerClose","aria-label":"Close Assistant"},n.createElement(g.JO.Close,null))))),hu=r.UI.Knot.make(pu,{left:uu,expandFeedButton:fc,right:mu}),gu=r.UI.Knot.make(Jt,{header:hu,content:dc,footer:ct,notifications:_});function fu(e){return r.UI.Knot.make(r.UI.Grid.make((({slots:t})=>n.createElement(G.Provider,{value:{notifyUnmount:t=>e.notify(t)}},t.assistant))),{assistant:gu})}},72230:(e,t,i)=>{i.d(t,{Q:()=>kt});var n,r=i(34217),s=i(5114),o=i(72004);function a(e,t=n.empty){return r.Z.fromSideEffect((t=>e.notify(t)),e.feedbackForm.stagingFeedbackFormData.view((e=>{var i;return{formData:e,domain:t.showDomainCheckbox,source:null!==(i=null==e?void 0:e.source)&&void 0!==i?i:o.x.Source.resultCard}})))}!function(e){e.empty={showDomainCheckbox:s.none}}(n||(n={}));var l=i(64015),c=i(22232);function u(e){return r.Z.composeKnot({content:(t=e.notifications,r.Z.composeList(l.Ot,(()=>t.state.view(l.GY)),(e=>function(e,t){return r.Z.fromSideEffect((e=>{if("dismissNotification"===e.kind)return t.dismiss(e.id);(0,c.L0)(e.kind)}),e)}(e,t))))});var t}var d=i(77176),m=i(76974),p=i(57050),h=i(67434),g=i(2844),f=i(28043);const v=new(i(45930).X)(999999);var y;!function(e){e.create=function(e){return null!=e?e:v.newId()}}(y||(y={}));var b=i(7903);function x(e){const t=e.promptMenu.state.pipe(h.R(((e,t)=>(0,p.zG)(t,s.fold((()=>e),(()=>e+1)))),0));return r.Z.fromSideEffect((t=>e.notify(t)),g.aj([e.assistant.state,t,e.routing.activeView]).pipe(d.U((([e,t,i])=>{return{kind:(0,p.zG)(b.z.toStarted(e.session),s.fold((()=>"loading"),(e=>(0,p.zG)(e.inProgressResult,s.fold((()=>"ready"),(()=>"waitingForResult")))))),genAIAvailability:e.genAIAvailability,placeholder:(n=e,(0,p.zG)(n.selectedAction,s.chain((e=>""!==e.args[0].label.trim()?s.some([e.args[0].label]):s.none)),s.alt((()=>(0,p.zG)(n.userPromptAction,s.map((e=>[e.arg.label]))))))),hasHeader:!1,text:e.textBox,autofocusToken:y.create(`${i.kind}_${(0,p.zG)(b.z.toStarted(e.session),s.chain((e=>e.inProgressResult)),s.fold((()=>"done"),(()=>"inProgress")))}_${(0,p.zG)(e.selectedAction,s.fold((()=>"no-selected-action"),(()=>"selected-action")))}_${e.promptAutofocusToken}_promptMenuOpen:${t}`)};var n})),f.x()))}var k=i(17889),S=i(60797),C=i(97645),w=i(42636),_=i(17771),I=i(95195);function E(e,t,i,n){return r.Z.fromSideEffect((t=>e.notify(t)),g.aj([t,e.assistant.state.view("textBox")]).pipe(d.U((([e,t])=>({icon:"backendAction"===e.kind?I.right({url:e.action.iconUrl}):I.left({kind:e.kind}),label:"backendAction"===e.kind?e.action.label:"allResults"===e.kind?"More":"go"===e.kind?`”${t.trim()}”`:(0,c.L0)(e),action:e,mode:i,customViewOpts:n})))))}function A(e,t,i,n){return r.Z.composeList(l.Ot,(()=>t.pipe(d.U(s.getOrElse((()=>[]))))),(t=>E(e,m.of(t),i,n)))}function O(e,t){return r.Z.composeList(l.Ot,(()=>t.pipe(d.U((e=>(0,p.zG)(e,l.Su(((e,t)=>({category:t,isFirst:0===e})))))))),(({category:t,isFirst:i})=>function(e,t,i){const n=e.assistant.state.view((({session:e,contextualActions:t})=>(0,p.zG)(_.g(s.option)((0,p.zG)(e,b.z.toStarted,s.chain((e=>e.activeBoundaryContext.selection))),t),s.fold(p.jv,p.W8))));return r.Z.composeKnot({root:()=>m.of({label:t.label,view:t.view}),actions:A(e,m.of(s.some(t.actions)),"standard",{isPinned:t.view===w.aU.Store.View.pinned}),header:r.Z.composeUnion({default:()=>m.of({label:t.label}),withSelectionContext:r.Z.fromSideEffect((t=>e.notify(t)),m.of({label:t.label}))},(()=>n.pipe(d.U((e=>({kind:e&&i?"withSelectionContext":"default"}))))))})}(e,t,i)))}var R=i(88187);function U(e){return(0,p.zG)(e,l.pO((e=>{const{init:t,rest:i}=l.zT((t=>w.aU.Group.Id.eq.equals(t.group.id,e[0].group.id)))(e);return[t,i]})),l.UI((e=>_.Y(s.Applicative)({label:(0,p.zG)(e,l.YM,s.map((e=>e.group.label))),view:s.some(w.aU.Store.View.normal),actions:(0,p.zG)(e,l.UI(R.Dj.BackendAction.make),k.c2),withContext:s.some(!1)}))),l.oA,k.c2,s.getOrElse((()=>[{label:e[0].group.label,view:w.aU.Store.View.normal,actions:[R.Dj.BackendAction.make(e[0])],withContext:!1}])))}function T(e,t){const i=t.pipe(d.U((0,p.ls)(s.map(k.DY(w.aU.ListableActionInput.ordByGroup)),s.map(U))));return r.Z.composeOption(O(e,i.pipe(S.oA)),(()=>i))}function B(e,t){return r.Z.composeKnot({searchResults:A(e,t.pipe(d.U(s.map(k.UI(R.Dj.BackendAction.make)))),"standard"),customPromptGo:E(e,m.of({kind:"go"}),"standard")})}function P(e,t){return r.Z.composeOption(r.Z.composeKnot({root:r.Z.fromSideEffect((t=>e.notify(t)),m.of(null)),content:r.Z.composeUnion({searchResults:B(e,t.pipe(d.U((0,p.ls)(s.filter(C.t.isSearchResults),s.chain((e=>k.hX(e.filterPredicate)(e.actions))))))),actionsStore:T(e,t.pipe(d.U((0,p.ls)(s.filter(C.t.isActionsStore),s.chain((e=>k.hX(e.filterPredicate)(e.actions)))))))},(()=>t.pipe(S.oA)))}),(()=>t))}function N(e){const t=e.routing.activeView.view((e=>"main"===e.kind||"followUpPrompt"===e.kind&&"string"===e.inputType?s.some(!0):s.none));return r.Z.composeOption(function(e){return r.Z.composeKnot({root:r.Z.fromSideEffect((t=>e.notify(t)),e.promptMenu.state.pipe(d.U((e=>({menuExpanded:s.isSome(e)}))))),promptField:x(e),promptHeader:()=>m.of(null),promptMenu:P(e,e.promptMenu.state)})}(e),(()=>t))}var z,G,j=i(90845),F=i(38194),D=i(24209),M=i(2834),V=i(49143),L=i(66310),H=i(85089),K=i(93508),$=i(85985),W=i(49708),Z=i(83401),q=i(38983),Y=i(2768),X=i(55721),Q=i(39719),J=i(87683);!function(e){e.create=function(){return{translate:{x:0,y:0},lastTranslate:{x:0,y:0},dragging:!1,dragStart:!1,dragEnd:!1}}}(z||(z={})),function(e){e.fromCartesian=function({x:e,y:t}){return{top:t,left:e}},e.l1Distance=function(e,t){return Math.abs(e.top-t.top)+Math.abs(e.left-t.left)}}(G||(G={}));var ee=i(63712);var te;function ie(e,t=te.empty){return(0,p.ls)(F.B(),(i=>{return D.T(i.pipe(M.b((t=>function(e,t){switch(e.kind){case"focus":return t.position.onFocusChange(e.focused);case"mount":return t.position.onMount(e.element);case"maxSize":return t.position.onMaxHeightChange(e.maxSize.height);case"dragHandleMount":break;default:return(0,c.L0)(e)}}(t,e))),V.l()),i.pipe((n=e.position,(0,p.ls)(d.U((e=>"dragHandleMount"===e.kind?s.some(e.element):s.none)),S.oA,(0,p.ls)($.h((e=>!!e)),f.x(),L.w((e=>W.R(e,"mousedown").pipe($.h((e=>!e.button)),M.b((e=>e.preventDefault())),d.U((t=>({element:e,startPos:{x:t.clientX,y:t.clientY}}))),L.w((e=>W.R((0,J.Jj)(e.element),"mousemove").pipe(Y.R(W.R((0,J.Jj)(e.element),"mouseup",{capture:!0})),X.p(10),d.U((({clientX:t,clientY:i})=>({kind:"dragInProgress",element:e.element,startPos:e.startPos,delta:{x:t-e.startPos.x,y:i-e.startPos.y}}))),Q.l({kind:"dragDone"}))))))),h.R(((e,t)=>"dragDone"===t.kind?{translate:e.translate,lastTranslate:e.translate,dragging:!1,dragStart:!1,dragEnd:e.dragging}:{dragging:!0,dragStart:!e.dragging,dragEnd:!1,lastTranslate:e.lastTranslate,translate:{x:t.delta.x+e.lastTranslate.x,y:t.delta.y+e.lastTranslate.y}}),z.create())),(r=n,(0,p.ls)(F.B(),(e=>(0,p.zG)(D.T(e.pipe($.h((e=>G.l1Distance(G.fromCartesian(e.translate),G.fromCartesian(e.lastTranslate))>=3)),M.b((e=>r.onDrag(e.translate)))),e.pipe($.h((e=>e.dragEnd)),M.b((()=>r.onDragEnd())))),V.l())))),V.l()))),i.pipe(function(e){return(0,p.ls)(d.U((e=>"mount"===e.kind?s.some(e.element):s.none)),S.oA,L.w((e=>H.YC(e).pipe(K.O(null),d.U((()=>e.getBoundingClientRect()))))),M.b((t=>e.onResize(t))),V.l())}(e.position)),i.pipe((0,p.ls)(d.U((e=>"mount"===e.kind?s.some(e.element):s.none)),S.oA,d.U(s.some),j.P.FocusTrap.dynamicFocusTrap(j.P.FocusTrap.InitialFocus.none,ne,re),V.l())),q.h.combine(e.position.state,e.assistant.state.view("canScroll"),function(e){return q.h.combine(e.assistant.state.view("session"),e.userSurvey.state,e.routing.activeView,((e,t,i)=>(0,p.zG)(b.z.toStarted(e),s.filter((()=>"main"===i.kind&&"afterResults"===i.state)),s.map((e=>`${(0,p.zG)(e.inProgressResult,s.fold((()=>""),(e=>e.text)))}_${e.results.length}_${s.isSome(t.activeSurvey)}`)))))}(e),e.promptMenu.state,t.assistantMaxHeight,((e,t,i,n,r)=>Object.assign(Object.assign({},e),{canScrollContent:t,menuRef:(0,p.zG)(n,s.chain((e=>e.promptMenuContainer))),scrollContentToBottomToken:i,maxHeight:(0,p.zG)(r,s.alt((()=>(0,p.zG)((0,ee.G)(e),s.chain((e=>e.assistantMaxHeight))))))}))));var n,r}))}function ne(e){var t;if(e instanceof HTMLIFrameElement){const i=null===(t=e.contentWindow)||void 0===t?void 0:t.document;if(i){const e=i.body.querySelector("textarea:not([disabled]), input:not([disabled])");e&&"focus"in e&&"function"==typeof e.focus&&e.focus()}}else e.focus()}function re(e,t){return e instanceof HTMLIFrameElement?e.contentDocument?W.R(e.contentDocument.body,t):Z.C:W.R(e,t)}function se(e){return r.Z.composeOption(function(e){return r.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.view("selectedAction").view(s.chain((e=>(0,p.zG)(e.args[0].hints,s.map((t=>({header:e.label,iconUrl:e.iconUrl,hintsHeader:t.header,hintsItems:t.items,radioOptions:w.Xy.match({string:()=>s.none,radio:e=>s.some(e.radioOptions)})(e.args[0])}))))))).pipe(S.oA))}(e),(()=>e.assistant.state.view("selectedAction").view(s.chain((e=>e.args[0].hints)))))}function oe(e){const t=e.skill.state.view(s.map((e=>({displayName:e.skill.displayName,status:e.status,srcUrl:e.skill.srcUrl,size:e.size}))));return r.Z.composeOption(function(e,t){return r.Z.fromSideEffect((t=>e.notify(t)),t)}(e,t.pipe(S.oA)),(()=>t))}!function(e){e.empty={assistantMaxHeight:q.h.create(s.some(660))}}(te||(te={}));var ae=i(83289),le=i(33305);function ce(e){const t=q.h.create("");return r.Z.fromSideEffect((i=>{"updateRoleTypeaheadText"===i.kind?(t.set(i.text),""===i.text&&e.notify({kind:ae.i.Kind.roleTypeaheadSelectionChange,role:s.none})):(i.kind===ae.i.Kind.roleTypeaheadSelectionChange&&t.set((0,p.zG)(i.role,s.fold((()=>""),(e=>e.label)))),e.notify(i))}),q.h.combine(e.assistant.state.view("session"),e.voiceProfile.state.view("stagingVoiceProfile"),t,((e,t,i)=>(0,p.zG)(_.Y(s.Applicative)({voiceProfile:(0,p.zG)(b.z.toStarted(e),s.map((e=>e.voiceProfile)),s.chain(le.L.toLegacyVoiceProfile)),stagingVoiceProfile:t}),s.fold((()=>({tones:[],styles:[],roles:[],maxSelectableTones:0,applyButtonEnabled:!1,description:"",roleTypeaheadText:"",dialects:le.L.Dialect.all(),selectedDialect:le.L.Dialect.american})),(({stagingVoiceProfile:e,voiceProfile:t})=>(0,p.zG)(t.styles,l.Ew((t=>t.id===e.selectedStyle)),(n=>({styles:(0,p.zG)(t.styles,l.UI((t=>Object.assign(Object.assign({},t),{kind:t.id===e.selectedStyle?"selected":"unselected"})))),tones:(0,p.zG)(n,s.fold((()=>[]),(t=>(0,p.zG)(t.tones,l.UI((i=>Object.assign(Object.assign({},i),{kind:(0,p.zG)(s.fromNullable(e.selectedTonesPerStyle.get(e.selectedStyle)),s.getOrElse((()=>new Set)),(e=>e.has(i.id)?"selected":e.size>=t.maxTones?"disabled":"unselected"))}))))))),roles:t.roles,maxSelectableTones:(0,p.zG)(n,s.fold((()=>3),(e=>e.maxTones))),applyButtonEnabled:!le.L.Selections.eq.equals(e,t),description:"These voice settings will apply to any text you generate.",roleTypeaheadText:(0,p.zG)(e.selectedRole,s.filter((()=>""===i)),s.chain((e=>s.fromNullable(t.roles.find((t=>t.id===e))))),s.fold((()=>i),(e=>e.label))),dialects:t.dialects,selectedDialect:t.dialects.find((t=>le.L.Dialect.Id.eq.equals(t.id,e.selectedDialect)))||le.L.Dialect.american})))))))))}function ue(e){return r.Z.fromSideEffect((t=>e.notify(t)),q.h.combine(e.assistant.state.view("session"),e.voiceProfile.state.view("stagingNewVoiceProfile"),((e,t)=>(0,p.zG)(_.Y(s.Applicative)({sessionVoiceProfile:(0,p.zG)(b.z.toStarted(e),s.map((e=>e.voiceProfile)),s.chain(le.L.toNewVoiceProfile)),stagingVoiceProfile:t}),s.fold((()=>({userName:"",title:"",subTitle:"",roles:[],dialects:le.L.Dialect.all(),selectedDialect:le.L.Dialect.american,isEnabledByDefault:!0,isEnabledByDefaultLabel:"",profiles:[],activeProfileName:s.none,activeTagId:s.none,isEditing:!1,selectedRole:s.none})),(({sessionVoiceProfile:e,stagingVoiceProfile:t})=>({userName:e.userName,title:e.title,subTitle:e.subTitle,isEnabledByDefault:t.isEnabledByDefault,isEnabledByDefaultLabel:e.isEnabledByDefaultLabel,profiles:t.profiles,roles:(0,p.zG)(de(t,e),s.fold((()=>e.roles),(t=>e.roles.filter((e=>e.id!==t.id))))),dialects:(0,p.zG)(me(t,e),(t=>e.dialects.filter((e=>e.id!==t.id)))),selectedRole:de(t,e),selectedDialect:me(t,e),activeProfileName:t.activeProfileName,activeTagId:t.activeTagId,isEditing:s.isSome(t.stagingSelections)})))))))}function de(e,t){return(0,p.zG)(e.stagingSelections,s.chain((e=>e.selectedRole)),s.alt((()=>e.selectedRole)),s.chain((e=>s.fromNullable(t.roles.find((t=>le.L.Role.Id.eq.equals(t.id,e)))))))}function me(e,t){return(0,p.zG)(e.stagingSelections,s.fold((()=>e.selectedDialect),(e=>e.selectedDialect)),(e=>t.dialects.find((t=>le.L.Dialect.Id.eq.equals(t.id,e)))||le.L.Dialect.american))}var pe=i(41398);function he(e){const t=e.assistant.state.view("session").pipe(d.U((e=>e.error)));return r.Z.composeOption(function(e,t){const i=e.routing.activeView.view((e=>"error"!==e.kind));return r.Z.fromSideEffect((t=>e.notify(t)),t.pipe(pe.M(i),d.U((([e,t])=>({error:e,showGotItButton:t})))))}(e,t.pipe(S.oA)),(()=>t))}function ge(e){const t=e.assistant.state.view("session").view((0,p.ls)(b.z.toStarted,s.chain((e=>e.activeContext.documentOverview))));return r.Z.composeOption((()=>(0,p.zG)(t,S.oA)),(()=>t))}var fe=i(69693);function ve(e){const t=e.state.view("session").view((0,p.ls)(s.fromPredicate((e=>fe.w.isQuickReply(e.mode))),s.chain((e=>(0,p.zG)("started"===e.kind?(0,p.zG)(e.activeContext.intent,s.map((e=>({kind:"loaded",text:e})))):s.some({kind:"loading"}),s.map((e=>Object.assign(Object.assign({},e),{header:"Sender’s intent"}))))))));return r.Z.composeOption(r.Z.composeUnion({loading:()=>t.pipe(S.oA),loaded:()=>t.pipe(d.U(s.chain((e=>"loaded"===e.kind?s.some({text:e.text,header:e.header}):s.none))),S.oA)},(()=>t.pipe(S.oA))),(()=>t))}var ye=i(14047);const be=(e,t,i)=>{const n=e.assistant.state.view("session").view((0,p.ls)(b.z.toStarted,s.chain((e=>s.fromNullable(e.results[i+1]))),s.filter(ye.x.isComplete),s.chain((e=>e.boundaryContextId)))),o=t.pipe(pe.M(n),d.U((([e,t])=>(0,p.zG)(e,s.filter((e=>ye.x.isComplete(e)||ye.x.isInProgress(e))),s.chain((e=>e.boundaryContextId)),s.filter((e=>!!s.isNone(t)||e!==t.value)))))),a=o.pipe(d.U(s.chain((t=>e.assistant.getContextById(t))))),l=a.pipe(d.U((e=>(0,p.zG)(e,s.chain((e=>e.selection))))));return r.Z.composeOption(r.Z.fromSideEffect((t=>e.notify(t)),g.aj([a,e.assistant.state.view("session").view((0,p.ls)(b.z.toStarted,s.map((({textRevision:e})=>e))))]).pipe(d.U((([e,t])=>_.Y(s.option)({selection:(0,p.zG)(e,s.chain((({selection:e})=>e))),currentTextRevision:t,contextTextRevision:(0,p.zG)(e,s.map((({textRevision:e})=>e)))}))),S.oA,d.U((({selection:e,currentTextRevision:t,contextTextRevision:i})=>({selectedText:e.text,selectedRange:s.isSome(i)&&t===i.value?e.range:void 0}))))),(()=>l))};var xe=i(12126),ke=i(87938),Se=i(77843);const Ce=[{text:"Working on it...",isMyVoice:!1},{text:"Applying your style...",isMyVoice:!0},{text:"Using your preferred words...",isMyVoice:!0},{text:"Structuring sentences your way...",isMyVoice:!0},{text:"Adjusting your formality...",isMyVoice:!0},{text:"Dotting the i’s and crossing the t’s...",isMyVoice:!0}];function we(e){const t=e.state.view("session").view(b.z.toStarted).view(s.chain((e=>e.inProgressResult))),i=t.pipe(S.oA,d.U((e=>e.text)),K.O("")),n=t.pipe(d.U(s.map((e=>e.header.label))),S.oA,K.O("")),r=t.pipe(d.U(s.chain((e=>e.header.iconUrl)))),o=xe.D(Ce).pipe(ke.j(((e,t)=>Se.F(3e3*t)))),a=o.pipe(d.U((e=>e.text))),l=o.pipe(d.U((e=>e.isMyVoice)));return()=>g.aj([i,a,l,n,r]).pipe(d.U((([e,t,i,n,r])=>({resultText:e,statusText:t,sourceLabel:n,sourceIconUrl:r,isMyVoiceStatus:i||e.length>0}))))}function _e(e){return()=>e.assistant.state.view("session").view(b.z.toStarted).view((0,p.ls)(s.chain((e=>e.inProgressResult)),s.map((e=>({result:e}))))).pipe(S.oA)}function Ie(e){const t=e.assistant.state.view("session").view(b.z.toStarted).view(s.chain((0,p.ls)((e=>e.voiceProfile),le.L.toNewVoiceProfile,s.map((e=>e.isEnabledByDefault))))).view(s.getOrElse(p.jv));return r.Z.composeUnion({regularCardInProgress:_e(e),myVoiceCardInProgress:we(e.assistant)},(()=>t.pipe(d.U((e=>e?{kind:"myVoiceCardInProgress"}:{kind:"regularCardInProgress"})))))}function Ee(e){const t=q.h.combine(e.assistant.state.view("session"),e.routing.activeView,((e,t)=>(0,p.zG)(b.z.toStarted(e),s.chain((e=>e.inProgressResult)),s.filter((()=>"main"===t.kind&&"afterResults"===t.state)),s.map((e=>({result:e}))))));return r.Z.composeOption(function(e){return r.Z.composeKnot({content:Ie(e),header:be(e,e.assistant.state.view("session").view(b.z.toStarted).view(s.chain((e=>e.inProgressResult))),-1)})}(e),(()=>t))}function Ae(e){const t=e.assistant.state.view("detectedReferences");return r.Z.composeOption(function(e){return()=>e.assistant.state.view("detectedReferences").pipe(d.U(s.getOrElse((0,p.a9)([]))),d.U((e=>({detectedReferences:e}))))}(e),(()=>t))}var Oe,Re=i(28577);!function(e){e.empty={feedType:"shortForm"}}(Oe||(Oe={}));const Ue=()=>m.of(null);function Te(e,t=Oe.empty){return r.Z.composeUnion({none:Ue,shortFormFeed:r.Z.composeKnot({feed:(0,p.zG)(e.revision,s.fold((()=>Ue),(e=>function(e){const t=Re.v.unwrap(e).shortFormFeedViewModel;return r.Z.fromSideEffect((e=>{const i=e.action;switch(i.kind){case"sduiNotify":return t.processActions(i.actions,i.item,i.actionScope,i.sourceId);case"sduiItemMounted":return t.onItemMount(i.item);case"shortFormCardAnimationEnd":return t.onAnimationEnd();case"shortFormFeedMounted":return t.onFeedMount();default:(0,c.L0)(i)}}),t.state.view((e=>"nonEmptyState"===e.kind?{kind:"nonEmptyState",item:e.focused,prevItem:e.prevFocusedItem,transitions:e.transitions}:e)))}(e))))}),longFormFeed:r.Z.composeKnot({feed:(0,p.zG)(e.revision,s.fold((()=>Ue),(e=>()=>m.of({kind:"nonEmptyState"}))))})},(()=>e.routing.activeView.view((i=>"main"===i.kind&&s.isSome(e.revision)?{kind:"beforeResults"===i.state?"shortForm"===t.feedType?"shortFormFeed":"longForm"===t.feedType?"longFormFeed":(0,c.L0)(t.feedType):"afterResults"===i.state?"none":(0,c.L0)(i.state)}:{kind:"none"}))))}var Be=i(83078),Pe=i(31705);function Ne(e,t){return r.Z.composeOption(r.Z.fromSideEffect((t=>e.notify(t)),e.userSurvey.state.pipe(d.U((e=>(0,p.zG)(e.activeSurvey,s.map((t=>({survey:t,state:e})))))),S.oA,d.U((({survey:e,state:t})=>({survey:e,stage:t.stage,transitionStage:t.transitionStage,rating:t.rating,openAnswer:(0,p.zG)(t.openAnswer,s.getOrElse((0,p.a9)(""))),ratingLabels:(0,p.zG)(t.activeSurvey,s.fold((0,p.a9)([]),(e=>e.ratingLabels))),errors:t.errors}))))),(()=>q.h.combine(e.userSurvey.state,t,e.routing.activeView,(({activeSurvey:e,stage:t},i,n)=>(0,p.zG)(e,s.filter((e=>"main"===n.kind&&"afterResults"===n.state&&(0,p.zG)(i,Be.FX(e.resultId))&&t!==Pe.x.Stage.Type.Closed)))))))}function ze(e){const t=q.h.combine(e.assistant.state.view("session"),e.routing.activeView,((e,t)=>(0,p.zG)(e,b.z.toStarted,s.filter((()=>"main"===t.kind&&"beforeResults"===t.state)),s.fold(p.jv,(e=>e.voiceProfile.needsSetup)))));return r.Z.composeOption(r.Z.fromSideEffect((t=>e.notify(t)),null),(()=>t.view((e=>e?s.some(null):s.none))))}function Ge(e,t=p.W8,i=s.some(3)){const n=(0,p.zG)(k.hX((e=>t(e.action)))(e),s.getOrElseW((()=>l.cS)));return(0,p.zG)(i,s.filter((e=>n.length>e)),s.map((e=>k.Ss(l.ke(e)(n),{kind:"allResults",filterPredicate:t}))),s.getOrElseW((()=>n)))}function je(e){const t=e.assistant.state.view("session").view((e=>fe.w.isQuickReply(e.mode))),i=e.assistant.state.view("session").view("selectedText"),n=e.assistant.state.view("contextualActions").view((e=>(0,p.zG)(e,s.map(k.UI(R.Dj.BackendAction.make)),s.map(k.IR(R.Dj.BackendAction.ordByActionStore)),s.map(k.UI((e=>({label:e[0].action.store.label,actions:Ge(e,(t=>w.aU.Store.Id.eq.equals(t.store.id,e[0].action.store.id)),e[0].action.store.maxCountBeforeClipping),view:e[0].action.store.view})))))));return r.Z.composeUnion({none:()=>m.of(null),loading:()=>q.h.combine(t,i,((e,t)=>({header:e?"Ways to reply":s.isSome(t)?`Work with: ${t.value}`:"Ideas for you",isQuickReply:e,withContext:s.isSome(t)}))),loaded:Fe(e,n,t)},(()=>q.h.combine(n,e.assistant.state.view("session"),e.routing.activeView,((e,t,i)=>"main"!==i.kind||"afterResults"===i.state?{kind:"none"}:s.isSome(e)?"started"===t.kind&&"pending"===t.activeContext.kind?{kind:"loading"}:{kind:"loaded"}:"started"===t.kind?{kind:"none"}:{kind:"loading"}))))}function Fe(e,t,i){return r.Z.composeKnot({root:r.Z.fromSideEffect((t=>e.notify(t)),i.view((e=>({isQuickReply:e})))),actions:O(e,t.pipe(S.oA))})}var De=i(27278),Me=i(819);function Ve(e){const t=e.assistant.state.view("contextualActions").view((e=>(0,p.zG)(e,s.map(k.UI(R.Dj.BackendAction.make)),s.map((e=>Ge(e,(0,p.ff)(w.aU.isSkillActionInput)))),s.chain(k.c2))));return r.Z.composeUnion({none:()=>m.of(null),loading:()=>m.of(null),actions:r.Z.composeKnot({root:r.Z.fromSideEffect((t=>e.notify(t)),null),actions:A(e,t,"compact")})},(()=>q.h.combine(t,e.assistant.state.view("genAIAvailability"),e.assistant.state.view("session"),((e,t,i)=>(0,p.zG)(b.z.toStarted(i),s.map((e=>e.activeContext)),s.fold((()=>"none"),(i=>(0,p.zG)(e,s.filter((()=>!Me._.isUnavailable(t))),s.fold((()=>Me._.isUnavailable(t)||!De._.isPending(i)?"none":"loading"),(()=>"actions"))))),(e=>({kind:e})))))))}var Le=i(8125);function He(e){return()=>e.assistant.state.view("session").view("selectedText").pipe(d.U((e=>({header:s.isSome(e)?`Work with: ${e.value}`:"Ideas for you",isQuickReply:!1,withContext:s.isSome(e)}))))}function Ke(e){const t=e.assistant.state.view("contextualActions").view((e=>(0,p.zG)(e,s.chain(k.hX((0,Le.ff)(w.aU.isSkillActionInput))),s.map(k.UI(R.Dj.BackendAction.make)),s.map(k.IR(R.Dj.BackendAction.ordByActionStore)),s.map(k.UI((e=>({label:e[0].action.store.label,actions:Ge(e,(t=>w.aU.Store.Id.eq.equals(t.store.id,e[0].action.store.id))),view:e[0].action.store.view})))))));return r.Z.composeKnot({actions:O(e,t.pipe(S.oA))})}function $e(e){return r.Z.composeOption(r.Z.composeKnot({actions:r.Z.composeUnion({loading:He(e),loaded:Ke(e)},(()=>e.assistant.state.view("session").view(b.z.toStarted).pipe(d.U(s.map((e=>"pending"===e.activeContext.kind?{kind:"loading"}:{kind:"loaded"}))),S.oA)))}),(()=>e.assistant.state.view("session").view(b.z.toStarted)))}function We(e){const t=q.h.combine(e.assistant.state.view("session"),e.routing.activeView,((e,t)=>(0,p.zG)(e,b.z.toStarted,s.filter((e=>"main"===t.kind&&"afterResults"===t.state&&s.isNone(e.inProgressResult)&&s.isNone(e.error))),s.map((e=>e.results)),s.chain(k.c2))));return r.Z.composeOption(function(e){return r.Z.composeUnion({followUp:r.Z.composeKnot({actions:Ve(e)}),newContext:$e(e)},(()=>e.assistant.state.view("session").view(b.z.toStarted).pipe(d.U((e=>(0,p.zG)(e,s.map((e=>e.activeContext.isBoundary&&s.isSome(e.activeContext.textRevision)?"newContext":"followUp"))))),S.oA,d.U((e=>({kind:"followUp"===e?"followUp":"newContext"}))))))}(e),(()=>t))}var Ze=i(24713),qe=i(26328);function Ye(e,t){return r.Z.fromSideEffect((t=>e.notify(t)),t)}function Xe(e,t){const i=function(e,t){return e.assistant.state.view((({genAIAvailability:e,session:i})=>(0,p.zG)(b.z.toStarted(i),s.map((i=>{const n=Me._.isPassive(e)||Me._.isUnavailable(e),r=(0,p.zG)(i.activeContext.userPromptAction,s.chain((e=>(0,p.zG)(t.header.copiablePrompt,s.map((t=>w.aU.UserPromptActionValue.fromInput(e,t,s.none,s.none)))))));return{actions:(0,p.zG)(qe.nI(i.activeContext.availableActions.filter((0,Le.Kg)(w.aU.isFollowUpQuestionActionInput,w.aU.isQuickActionInput))),s.filter((()=>!n)),s.map(qe.UI(R.Dj.BackendAction.make))),originalAction:r,disabled:n,result:t}}))))).pipe(S.oA)}(e,t),n=i.pipe(Ze.j("actions"));return r.Z.composeKnot({root:Ye(e,i),actions:A(e,n,"standard")})}var Qe,Je=i(36991),et=i(80900),tt=i(17343),it=i(55243),nt=i(7754);function rt(e,t,i,n){return r.Z.composeKnot({root:r.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.view((({genAIAvailability:e,activeCards:n,session:r,referencesVisibility:s,overrideCardVoice:o})=>{var a,l;return{disabled:Me._.isUnavailable(e),result:t,isActive:(0,p.zG)(!!n.has(t.id)||0===n.size&&i&&!st(b.z.toStarted(r))),isReferencesOpen:null!==(a=s.get(t.id))&&void 0!==a&&a,isMyVoice:(null!==(l=o.get(t.id))&&void 0!==l?l:(0,p.zG)(t.replacementDelta,I.fold((()=>ye.x.GeneratedTextVoice.generic),(e=>e.preferVoice))))===ye.x.GeneratedTextVoice.user}}))),header:r.Z.composeKnot({root:r.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.pipe(L.w((e=>{const i=(0,p.zG)(t.header.copiablePrompt,s.fold((()=>({kind:nt.nP.searchLabel,label:t.header.label,iconUrl:t.header.iconUrl})),(i=>({kind:nt.nP.clickableSearchLabel,label:t.header.label,disabled:Me._.isUnavailable(e.genAIAvailability),copiablePrompt:i}))));return ye.x.isComplete(t)&&function(e){return(0,p.zG)(e.replacementDelta,I.fold(p.yR,(e=>e.generic)),(e=>e.ops.some((e=>{var t;return Je.s.isInsert(e)&&!!(null===(t=e.attributes)||void 0===t?void 0:t[it.U.knowledgeHubTerm])}))))}(t)&&t.timestamp+3e3>Date.now()?et.H(t.timestamp+3e3-Date.now()).pipe(tt.h(i),K.O({kind:nt.nP.knowledgeHub})):m.of(i)})))),voiceButton:r.Z.composeOption(r.Z.fromSideEffect((t=>e.notify(t)),e.assistant.state.pipe(d.U((e=>{var i;return{selectedVoice:null!==(i=e.overrideCardVoice.get(t.id))&&void 0!==i?i:(0,p.zG)(t.replacementDelta,I.fold((()=>ye.x.GeneratedTextVoice.generic),(e=>e.preferVoice))),resultId:t.id}})))),(()=>m.of((0,p.zG)(t.replacementDelta,s.fromEither))))}),contextHeader:be(e,m.of(s.some(t)),n)})}function st(e){return(0,p.zG)(e,s.fold(p.jv,(e=>s.isSome(e.inProgressResult)||s.isSome(e.error))))}function ot(e,t){return r.Z.composeList(l.Ot,(()=>t.pipe(d.U((0,p.ls)(l.ke(50),l.Su(((e,t)=>({result:t,isLast:0===e,index:e}))),l.GY)))),(({result:t,isLast:i,index:n})=>function(e,t,i,n){return r.Z.composeUnion({promptResultComplete:rt(e,t,i,n),aiUsageNotification:Xe(e,t)},(()=>m.of(ye.x.isAIUsageNotification(t)?{kind:"aiUsageNotification"}:{kind:"promptResultComplete"})))}(e,t,i,n)))}function at(e,t){return r.Z.composeOption(ot(e,t.view(s.getOrElse((()=>[])))),(()=>q.h.combine(t,e.routing.activeView,((e,t)=>(0,p.zG)(e,s.filter((()=>"main"===t.kind&&"afterResults"===t.state)))))))}function lt(e){const t=e.assistant.state.view("session").view((0,p.ls)(b.z.toStarted,s.map((e=>e.results)),s.chain(k.c2)));return r.Z.composeKnot({suggestions:Te(e),voiceBanner:ze(e),documentOverview:ge(e),intent:ve(e.assistant),resultList:at(e,t),lastResultSurvey:Ne(e,t.view(s.map((0,p.ls)(k.YM,(e=>e.id))))),lastResultActions:We(e),inProgressResult:Ee(e),defaultActions:je(e),generationError:he(e),detectedReferences:Ae(e)})}function ct(e,t){return r.Z.composeUnion({main:lt(e),error:he(e),followUpPrompt:se(e),legacyVoiceProfile:ce(e),voiceProfile:ue(e),feedbackForm:a(e,t),skill:oe(e),toneReport:()=>m.of(null),settings:()=>m.of(null),longFormFeed:()=>m.of(null)},(()=>e.routing.activeView))}function ut(e){const t=(0,p.zG)(e.revision,s.map((e=>Re.v.unwrap(e).expandFeedButtonViewModel)));return r.Z.composeUnion({none:()=>m.of(null),noSuggestions:()=>m.of(null),withSuggestions:r.Z.fromSideEffect((t=>{if("expandSuggestionsButtonClickAction"===t.kind)return e.routing.replace({kind:"main",state:"beforeResults"});(0,c.L0)(t.kind)}),(0,p.zG)(t,s.fold((()=>m.of({suggestionsCount:0,disabled:!0})),(t=>q.h.combine(t.state,e.assistant.state.view("session"),(({suggestionsCount:e},t)=>({suggestionsCount:e,disabled:(0,p.zG)(b.z.toStarted(t),s.fold(p.jv,(e=>s.isSome(e.inProgressResult))))})))))))},(()=>(0,p.zG)(t,s.fold((()=>m.of("none")),(t=>q.h.combine(t.state,e.routing.activeView,(({suggestionsCount:e},t)=>"main"===t.kind&&"afterResults"===t.state?e>0?"withSuggestions":"noSuggestions":"none")))),d.U((e=>({kind:e}))))))}function dt(e){return(0,p.zG)(e,s.fold((()=>""),(e=>(0,p.zG)(le.L.toLegacyVoiceProfile(e),s.fold((()=>"Style"),(e=>(0,p.zG)(s.fromNullable(e.styles.find((t=>le.L.Style.Id.eq.equals(t.id,e.selectedStyle)))),s.fold((()=>""),(e=>e.label)))))))))}function mt(e){return q.h.combine(e.assistant.state.view("session").view((0,p.ls)(b.z.toStarted,s.map((e=>e.voiceProfile)))),e.theme.theme.view("flatUI"),((e,t)=>({styleLabel:dt(e),flatUI:t})))}function pt(e){const t=e.assistant.state.view((e=>(0,p.zG)(e.genAIAvailability,s.fromPredicate(Me._.isActiveOrPassive),s.filter((()=>s.isSome(b.z.toStarted(e.session)))))));return r.Z.composeOption(function(e,t,i){return r.Z.fromSideEffect((t=>e.notify(t)),(0,p.zG)(g.aj([t,i]),d.U((([e,t])=>({user:e,genAIAvailability:t})))))}(e,e.assistant.state.view("user"),t.pipe(S.oA)),(()=>q.h.combine(t,e.routing.activeView.view("kind"),((t,i)=>(0,p.zG)(t,s.filter((()=>"voiceProfile"!==i&&"legacyVoiceProfile"!==i&&"feedbackForm"!==i&&"skill"!==i&&"settings"!==i&&"toneReport"!==i&&s.isNone(e.revision))))))))}function ht(e){return r.Z.fromSideEffect((t=>e.notify(t.action.action)),q.h.combine(e.assistant.state.view("session"),e.routing.activeView,e.theme.theme.view("flatUI"),((e,t,i)=>{const n="started"!==e.kind||e.historyStatus!==b.z.HistoryStatus.hasHistory&&0===e.results.length?"disabled":e.historyStatus===b.z.HistoryStatus.historyRequested?"loading":"enabled",r="main"===t.kind&&"beforeResults"===t.state;return i?r?s.some({state:n,flatUI:!0}):s.none:"started"===e.kind&&r&&(e.historyStatus===b.z.HistoryStatus.hasHistory||e.historyStatus===b.z.HistoryStatus.historyRequested||e.results.length>0)?s.some({state:n,flatUI:!1}):s.none})))}function gt(e){return r.Z.composeKnot({root:r.Z.fromSideEffect((t=>e.notify(t)),e.theme.theme),left:ft(e),right:r.Z.composeKnot({root:()=>e.theme.theme,historyButton:ht(e),credits:pt(e),voiceButton:xt(e)}),expandFeedButton:ut(e)})}function ft(e){const t=q.h.combine(e.assistant.state,e.routing.activeView.view("kind"),e.theme.theme.view("flatUI"),(({session:e},t,i)=>(0,p.zG)(b.z.toStarted(e),s.fold((()=>"logoOnly"),(()=>"error"===t?"logoOnly":"main"===t?i?"logoOnly":"logoAndVoiceButton":"voiceProfile"===t||"feedbackForm"===t||"legacyVoiceProfile"===t||"skill"===t||"toneReport"===t||"settings"===t||"longFormFeed"===t?"backButton":"followUpPrompt"===t?i?"backButton":"backButtonAndVoiceButton":(0,c.L0)(t))))));return r.Z.composeUnion({logoOnly:()=>m.of(null),logoAndVoiceButton:bt(e),backButton:vt(e),backButtonAndVoiceButton:yt(e)},(()=>t.pipe(K.O("logoOnly"),d.U((e=>({kind:e}))))))}function vt(e){return r.Z.fromSideEffect((t=>e.notify(t)),q.h.combine(e.routing.activeView.view("kind"),e.skill.state,((e,t)=>"voiceProfile"===e||"legacyVoiceProfile"===e?{activeViewIconUrl:s.none,activeViewLabel:s.some("Style")}:"feedbackForm"===e?{activeViewIconUrl:s.none,activeViewLabel:s.some("Share your thoughts")}:"skill"===e?(0,p.zG)(t,s.fold((()=>({activeViewIconUrl:s.none,activeViewLabel:s.none})),(e=>({activeViewIconUrl:s.some(e.skill.iconUrl),activeViewLabel:s.some(e.skill.displayName)})))):"toneReport"==e?{activeViewIconUrl:s.none,activeViewLabel:s.some("Tone insights")}:"settings"===e?{activeViewIconUrl:s.none,activeViewLabel:s.some("Settings")}:{activeViewIconUrl:s.none,activeViewLabel:s.none})))}function yt(e){return r.Z.fromSideEffect((t=>e.notify(t.action)),mt(e).view((e=>({back:{activeViewIconUrl:s.none,activeViewLabel:s.none},voice:e}))))}function bt(e){return r.Z.fromSideEffect((t=>e.notify(t)),mt(e).view((e=>Object.assign(Object.assign({},e),{kind:"logoAndVoiceButton"}))))}function xt(e){return r.Z.fromSideEffect((t=>e.notify(t.action.action)),q.h.combine(e.assistant.state.view("session"),e.routing.activeView.view("kind"),e.theme.theme.view("flatUI"),((e,t,i)=>(0,p.zG)(b.z.toStarted(e),s.map((e=>e.voiceProfile)),s.filter((()=>i&&"main"===t)),s.map((e=>({styleLabel:dt(s.some(e)),flatUI:i})))))))}function kt(e,t=Qe.empty){return r.Z.composeKnot({assistant:r.Z.composeKnot({root:ie(e,t.draggableContainerOptions),content:ct(e,t.feedbackFormOptions),header:gt(e),footer:N(e),notifications:u(e)})})}!function(e){e.empty={draggableContainerOptions:te.empty,feedbackFormOptions:n.empty}}(Qe||(Qe={}))},46285:(e,t,i)=>{i.d(t,{s:()=>Y});var n=i(32952),r=i(5114),s=i(38983);const o={flatUI:!1};var a=i(14601),l=i(83289),c=i(98370),u=i(63346),d=i(2735),m=i(26320);class p{constructor(e){var t;this._params=e,this._state=s.h.create({}),this._subs=new a.w,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new u.W(p.name),this.stagingFeedbackFormData=this._state.view(),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case l.i.Kind.openFeedbackFormButtonClick:return this._openFeedbackForm(e.source);case l.i.Kind.feedbackFormChange:return this._updateFeedbackForm(e.feedbackData);case l.i.Kind.feedbackFormSubmitButtonClick:return this._submitFeedbackForm(e.feedbackData);default:return}}_openFeedbackForm(e){this._params.routingViewModel.push({kind:"feedbackForm"}),this._state.set({source:e})}_updateFeedbackForm(e){this._state.modify((t=>Object.assign(Object.assign({},t),e)))}_submitFeedbackForm(e){this._params.routingViewModel.pop(),this._state.set({}),(0,m.t)("submitFeedback",this._params.feedbackService.submitFeedback(e),this._logger,void 0,(e=>this._params.monitoringService.notify((0,c.L)({source:"feedback",kind:"error",name:"submitFeedbackFailed",data:{rawError:(0,d.N)(e)}}))))}}var h=i(64015),g=i(57050),f=i(80900),v=i(85985),y=i(2834),b=i(28043),x=i(8125),k=i(75552);class S{constructor(e,t,i=3e3,n=1){this._assistantUIActions=e,this._activeView=t,this._notificationsDurationMs=i,this._maxNotificationsCountAtOnce=n,this._state=s.h.create([]),this._notificationsSubs=new Map,this._subs=new a.w,this._nextToastId=0,this.state=this._state.view(),this._subs.add(this._showFeedbackSubmittedToast().subscribe()),this._subs.add(this._clearNotificationsOnViewChange().subscribe()),this._subs.add(this._removeVoiceTagNotification().subscribe())}dismiss(e){var t;null===(t=this._notificationsSubs.get(e))||void 0===t||t.unsubscribe(),this._notificationsSubs.delete(e),this._state.modify(h.hX((t=>t.id!==e)))}clearAll(){this._notificationsSubs.forEach((e=>e.unsubscribe())),this._notificationsSubs.clear(),this._state.set([])}dispose(){this._subs.unsubscribe(),this.clearAll()}_showNotification(e){const t=this._nextToastId++;this._notificationsSubs.set(t,f.H(this._notificationsDurationMs).subscribe((()=>this.dismiss(t)))),this._state.modify((0,g.ls)(h.QI({kind:e,id:t}),h.ke(this._maxNotificationsCountAtOnce)))}_showFeedbackSubmittedToast(){return this._assistantUIActions.pipe(v.h((0,x.Kg)(l.i.is(l.i.Kind.feedbackFormSubmitButtonClick),l.i.is(l.i.Kind.reportOffensiveResultButtonClick),l.i.is(l.i.Kind.reportOffensiveActionsButtonClick))),y.b((()=>this._showNotification(k.C.Kind.feedbackSubmitted))))}_removeVoiceTagNotification(){return this._assistantUIActions.pipe(v.h(l.i.is(l.i.Kind.voiceTagPopoverRemoveButtonClick)),y.b((()=>this._showNotification(k.C.Kind.voiceTagRemoved))))}_clearNotificationsOnViewChange(){return this._activeView.view("kind").pipe(b.x(),y.b((()=>this.clearAll())))}}var C=i(97645),w=i(62965),_=i(42636),I=i(99877),E=i(41866);class A{constructor(e,t,i,n){this._assistantUIActions=e,this._router=t,this._monitoringService=i,this._skillService=n,this._subs=new a.w,this._state=s.h.create(r.none),this.state=this._state.view(),this._skillService&&this._subs.add(this._skillService.skillRequests.subscribe((e=>{e.close?(this._onSkillClosed(),this._state.set(r.none)):e.size&&this._state.modify(r.map((t=>Object.assign(Object.assign({},t),{size:e.size}))))}))),this._subs.add(this._assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case l.i.Kind.actionBrickClick:if("backendAction"===e.action.kind&&_.aU.isSkillActionInput(e.action.action)){const t=e.action.action.skill;this._onSkillOpened(),this._state.set(r.some({skill:t,status:"loading",size:{width:416,height:245}}))}break;case l.i.Kind.mount:e.name===I.e.skill&&(0,m.t)("initSkill",(0,g.zG)((0,g.zG)(this._state.get(),w.Yo((()=>new Error("Cannot init Skill. No Skill state available.")))),w.tS((t=>this._skillService?(0,g.zG)(this._skillService.initSkill(t.skill,e.element),w.UI((e=>Object.assign(Object.assign({},t),{size:e})))):w.t$(new Error("Cannot init Skill. No `SkillService` available."))))),void 0,(e=>this._state.set(r.some(Object.assign(Object.assign({},e),{status:"ready"})))),(e=>{this._state.modify(r.map((e=>Object.assign(Object.assign({},e),{status:"error"})))),this._monitoringService.notify((0,c.L)((0,E.iJ)({skillId:(0,g.zG)(this._state.get(),r.map((e=>e.skill.id)),r.toNullable),rawError:(0,d.N)(e)})))}));break;case l.i.Kind.unmount:e.name===I.e.skill&&(0,m.t)("terminateSkill",(0,g.zG)((0,g.zG)(this._state.get(),w.Yo((()=>new Error("Cannot terminate Skill. No Skill state available.")))),w.tS((e=>this._skillService?(0,g.zG)(this._skillService.terminateSkill(e.skill),w.UI((()=>e))):w.t$(new Error("Cannot terminate Skill. No `SkillService` available."))))),void 0,(()=>this._state.set(r.none)),(e=>{this._state.set(r.none),this._monitoringService.notify((0,c.L)((0,E.go)({skillId:(0,g.zG)(this._state.get(),r.map((e=>e.skill.id)),r.toNullable),rawError:(0,d.N)(e)})))}))}}_onSkillOpened(){this._router.push({kind:"skill"})}_onSkillClosed(){"skill"===this._router.activeView.get().kind&&this._router.pop()}}var O,R=i(22232),U=i(31705);!function(e){e.empty={activeSurvey:r.none,stage:U.x.Stage.Type.Rating,transitionStage:U.x.Stage.Type.Rating,rating:r.none,errors:r.none,openAnswer:r.none}}(O||(O={}));class T{constructor(e){this._params=e,this._state=s.h.create(O.empty),this._subs=new a.w,this._stageTimeoutClear=void 0,this.state=this._state.view(),this._updateStageAfterTransition(),this._subscribeToActiveSurvey(),this._subs.add(this._params.assistantUIActions.subscribe((e=>{(0,x.Kg)(l.i.isSurveyAction,l.i.isSurveyImplicitDismissAction)(e)&&this._handleUIAction(e)})))}get _activeSurvey(){return this.state.get().activeSurvey}_subscribeToActiveSurvey(){this._subs.add(this._params.userSurveyService.activeSurvey.subscribe((e=>{(0,g.zG)(e,r.map((e=>{(0,g.zG)(this._activeSurvey,r.fold((()=>this._updateActiveSurvey(e)),(t=>{t.detailedPlacement!==e.detailedPlacement&&this._updateActiveSurvey(e)})))})))})))}_updateActiveSurvey(e){this._state.set(Object.assign(Object.assign({},O.empty),{activeSurvey:r.some(e)}))}_handleUIAction(e){switch(e.kind){case l.i.Kind.surveySubmitButtonClick:case l.i.Kind.surveyKeyPressShiftEnter:this._onSurveyCompleted();break;case l.i.Kind.surveyCancelButtonClick:case l.i.Kind.surveyCloseButtonClick:this._onDismissExplicitly();break;case l.i.Kind.surveyOpenAnswerChange:this._onOpenAnswerChange(e.openAnswer);break;case l.i.Kind.surveyRatingSelectionChange:this._onRatingSelectionChange(e.rating);break;case l.i.Kind.promptSubmitButtonClick:case l.i.Kind.actionBrickClick:case l.i.Kind.resultCardInsertButtonClick:case l.i.Kind.resultCardRephraseButtonClick:case l.i.Kind.resultCardHeaderClick:case l.i.Kind.resultCardDismissButtonClick:this._onDismissImplicitly();break;default:(0,R.L0)(e)}}_onRatingSelectionChange(e){(0,g.zG)(this._activeSurvey,r.map((e=>e.skipOpenAnswerFrom)),r.map((t=>{e<t?this._state.modify((t=>Object.assign(Object.assign({},t),{rating:r.some(e),transitionStage:U.x.Stage.Type.Feedback}))):this._state.modify((t=>Object.assign(Object.assign({},t),{rating:r.some(e),transitionStage:U.x.Stage.Type.Completed}))),this._reportCompleting()})))}_onOpenAnswerChange(e){(0,g.zG)(this._activeSurvey,r.chain((({openAnswer:e})=>e)),r.map((({maxLen:t})=>{e.length<=t&&this._state.modify((t=>Object.assign(Object.assign({},t),{openAnswer:r.some(e),errors:r.none})))})))}_onSurveyCompleted(){(0,g.zG)(this._activeSurvey,r.chain((({openAnswer:e})=>e)),r.chain((({minLen:e})=>e)),r.fold((()=>this._complete()),(e=>{(0,g.zG)(this._state.get().openAnswer,r.fold((()=>this._setOpenAnswerError("This field is required.")),(t=>{t.length<e?this._setOpenAnswerError(e>0?`Please enter at least ${e} characters.`:"This field is required."):this._complete()})))})))}_complete(){this._reportCompleting(),this._state.lens("transitionStage").set(U.x.Stage.Type.Completed)}_reportCompleting(){(0,g.zG)(this._activeSurvey,r.chain((e=>(0,g.zG)(this._state.get().rating,r.map((t=>({survey:e,rating:t})))))),r.map((({survey:e,rating:t})=>this._params.userSurveyService.submitSurveyResult({rating:t,openAnswer:this._state.get().openAnswer,placement:e.placement,detailedPlacement:e.detailedPlacement,stage:this.state.get().stage,type:e.type}))))}_setOpenAnswerError(e){this._state.lens("errors").set(r.some({openAnswerError:r.some(e)}))}_onDismissExplicitly(){(0,g.zG)(this._activeSurvey,r.map((e=>{const t=this.state.get().stage;t===U.x.Stage.Type.Rating&&this._params.userSurveyService.dismissSurvey({placement:e.placement,detailedPlacement:e.detailedPlacement,type:e.type,stage:t})}))),this._state.lens("transitionStage").set(U.x.Stage.Type.Closed)}_onDismissImplicitly(){this._state.lens("transitionStage").set(U.x.Stage.Type.Closed)}_updateStageAfterTransition(){this._subs.add(this._state.subscribe((e=>{this._clearStageTimeout(),this._stageTimeoutClear=setTimeout((()=>{this._state.lens("stage").set(e.transitionStage)}),B[e.transitionStage])})))}_clearStageTimeout(){void 0!==this._stageTimeoutClear&&(clearTimeout(this._stageTimeoutClear),this._stageTimeoutClear=void 0)}dispose(){this._subs.unsubscribe(),this._clearStageTimeout()}}const B={[U.x.Stage.Type.Rating]:0,[U.x.Stage.Type.Feedback]:300,[U.x.Stage.Type.Completed]:0,[U.x.Stage.Type.Closed]:0};var P=i(17771),N=i(48044),z=i(13853),G=i(83078),j=i(7903);var F=i(54596),D=i(33305);class M{constructor(e){var t;this._params=e,this._subs=new a.w,this._state=s.h.create({stagingNewVoiceProfile:r.none,stagingVoiceProfile:r.none}),this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new u.W(M.name),this.state=this._state.view(),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case l.i.Kind.headerGoBackButtonClick:return this._handleGoBack();case l.i.Kind.headerVoiceButtonClick:return this._openVoiceProfile("toolbar");case l.i.Kind.setVoiceButtonClick:return this._openVoiceProfile("banner");case l.i.Kind.voiceProfileCloseButtonClick:return this._closeVoiceProfile();case l.i.Kind.voiceProfileUseVoiceButtonClick:return this._applyVoiceProfile();case l.i.Kind.toneToggleClick:return this._toggleTone(e.id,e.selected);case l.i.Kind.styleToggleClick:return this._selectStyle(e.id);case l.i.Kind.roleTypeaheadSelectionChange:return this._selectRole((0,g.zG)(e.role,r.map((e=>e.id))));case l.i.Kind.dialectDropdownSelectionChange:return this._selectDialect(e.dialect.id);case l.i.Kind.voiceProfileTabChange:return this._switchNewVoiceProfileTab(e.profileName);case l.i.Kind.voiceTagPopoverRemoveButtonClick:return this._removeVoiceTag(e);case l.i.Kind.voiceTagPopoverCloseButtonClick:return this._closeVoiceTagPopover();case l.i.Kind.voiceTagPopoverKeepButtonClick:return this._keepVoiceTagPopover();case l.i.Kind.applyVoiceToWritingCheckboxChange:return this._updateMyVoiceIsEnabled(e.checked);case l.i.Kind.voiceTagClick:return this._toggleVoiceTag(e);case l.i.Kind.voiceDialectDropdownSelectionChange:return this._selectNewVoiceDialect(e.dialect.id);case l.i.Kind.voiceRoleDropdownSelectionChange:return this._selectNewVoiceRole(e.role.id);case l.i.Kind.voiceSelectionsSaveButtonClick:return this._saveNewVoiceSelections();case l.i.Kind.voiceSelectionsCancelButtonClick:return this._cancelNewVoiceSelectionChanges();case l.i.Kind.voiceSelectionsEditButtonClick:return this._editNewVoiceSelections();case l.i.Kind.promptFieldKeyPressEscape:case l.i.Kind.headerCloseButtonClick:return this._trySaveNewProfileIfChanged();default:return}}_handleGoBack(){(0,g.zG)(j.z.toStarted(this._params.sessionService.session.get()),G.bw((e=>{"newVoiceProfile"===e.voiceProfile.kind?(this._trySaveNewProfileIfChanged(),this._state.lens("stagingNewVoiceProfile").set(r.none)):"legacyVoiceProfile"===e.voiceProfile.kind&&this._state.lens("stagingVoiceProfile").set(r.none)})))}_createVoiceProfile(e){var t;return"newVoiceProfile"===e.kind?F.e.set("stagingNewVoiceProfile",r.some({selectedRole:e.selectedRole,selectedDialect:e.selectedDialect,isEnabledByDefault:e.isEnabledByDefault,profiles:e.profiles,activeTagId:r.none,activeProfileName:r.fromNullable(null===(t=e.profiles.find((e=>e.selected)))||void 0===t?void 0:t.name),stagingSelections:r.none})):F.e.set("stagingVoiceProfile",r.some({selectedStyle:e.selectedStyle,selectedTonesPerStyle:e.selectedTonesPerStyle,selectedRole:e.selectedRole,selectedDialect:e.selectedDialect,needsSetup:e.needsSetup}))}_openVoiceProfile(e){(0,g.zG)(j.z.toStarted(this._params.sessionService.session.get()),G.bw((t=>{this._params.trackingService.trackVoiceProfileOpen(e),this._params.routingViewModel.push({kind:"newVoiceProfile"===t.voiceProfile.kind?"voiceProfile":"legacyVoiceProfile"}),this._state.modify(this._createVoiceProfile(t.voiceProfile))})))}_closeVoiceProfile(){this._params.trackingService.trackVoiceProfileSkip(),this._params.routingViewModel.pop(),this._state.lens("stagingVoiceProfile").set(r.none)}_applyVoiceProfile(){const e=this._state.get().stagingVoiceProfile;this._params.routingViewModel.pop(),this._state.lens("stagingVoiceProfile").set(r.none),(0,g.zG)(e,G.bw((e=>{(0,m.t)("setVoiceProfile",this._params.sessionService.setVoiceProfile(e),this._logger)})))}_toggleTone(e,t){this._state.lens("stagingVoiceProfile").modify(r.map((i=>{return Object.assign(Object.assign({},i),{selectedTonesPerStyle:(0,g.zG)(i.selectedTonesPerStyle,t?(n=D.L.Style.Id.eq,(e,t)=>i=>(0,g.zG)(i,N.cq(n)(e,(0,g.ls)(r.some,t)),r.getOrElse((()=>(0,g.zG)(i,N.ZQ(n)(e,t(r.none)))))))(i.selectedStyle,r.fold((()=>new Set([e])),z.$T(D.L.Tone.Id.eq)(e))):(0,g.ls)(N.cq(D.L.Style.Id.eq)(i.selectedStyle,z.Od(D.L.Tone.Id.eq)(e)),r.getOrElse((()=>i.selectedTonesPerStyle))))});var n})))}_selectStyle(e){this._state.lens("stagingVoiceProfile").modify(r.map((t=>Object.assign(Object.assign({},t),{selectedStyle:e}))))}_selectRole(e){this._state.lens("stagingVoiceProfile").modify(r.map((t=>Object.assign(Object.assign({},t),{selectedRole:e}))))}_selectDialect(e){this._state.lens("stagingVoiceProfile").modify(r.map((t=>Object.assign(Object.assign({},t),{selectedDialect:e}))))}_editNewVoiceSelections(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{stagingSelections:r.some({selectedDialect:e.selectedDialect,selectedRole:e.selectedRole})})))}_cancelNewVoiceSelectionChanges(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{stagingSelections:r.none})))}_saveNewVoiceSelections(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{selectedDialect:(0,g.zG)(e.stagingSelections,r.fold((()=>e.selectedDialect),(e=>e.selectedDialect))),selectedRole:(0,g.zG)(e.stagingSelections,r.fold((()=>e.selectedRole),(e=>e.selectedRole))),stagingSelections:r.none})))}_selectNewVoiceRole(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{stagingSelections:(0,g.zG)(t.stagingSelections,r.map((t=>Object.assign(Object.assign({},t),{selectedRole:r.some(e)}))))})))}_selectNewVoiceDialect(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{stagingSelections:(0,g.zG)(t.stagingSelections,r.map((t=>Object.assign(Object.assign({},t),{selectedDialect:e}))))})))}_updateNewProfileStateIfAny(e){this._state.lens("stagingNewVoiceProfile").modify(r.map(e))}_keepVoiceTagPopover(){this._params.trackingService.trackVoiceProfileKeepTag(),this._closeVoiceTagPopover()}_closeVoiceTagPopover(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{activeTagId:r.none})))}_toggleVoiceTag({tagName:e,sectionName:t,profileName:i}){this._updateNewProfileStateIfAny((n=>Object.assign(Object.assign({},n),{activeTagId:r.toNullable(n.activeTagId)===D.b.createId({tagName:e,sectionName:t,profileName:i})?r.none:r.some(D.b.createId({tagName:e,sectionName:t,profileName:i}))})))}_updateMyVoiceIsEnabled(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{isEnabledByDefault:e})))}_removeVoiceTag({tagName:e,profileName:t,sectionName:i}){this._params.trackingService.trackVoiceProfileRemoveTag(),this._updateNewProfileStateIfAny((n=>Object.assign(Object.assign({},n),{profiles:(0,g.zG)(n.profiles,h.UI((n=>n.name===t?Object.assign(Object.assign({},n),{sections:n.sections.map((t=>t.name===i?Object.assign(Object.assign({},t),{tags:t.tags.filter((t=>t.name!==e))}):t))}):n)))})))}_switchNewVoiceProfileTab(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{activeProfileName:r.some(e)})))}_trySaveNewProfileIfChanged(){(0,g.zG)(P.Y(r.option)({editedVoiceProfile:this._state.view("stagingNewVoiceProfile").get(),sessionVoiceProfile:(0,g.zG)(j.z.toStarted(this._params.sessionService.session.get()),r.map((e=>e.voiceProfile)),r.chain(D.L.toNewVoiceProfile))}),r.filter((({editedVoiceProfile:e,sessionVoiceProfile:t})=>!D.L.NewSelections.eqByRoleDialectProfileAndIsEnabledByDefault.equals(e,t))),G.bw((({editedVoiceProfile:e})=>{(0,m.t)("setNewVoiceProfile",this._params.sessionService.setNewVoiceProfile({selectedDialect:e.selectedDialect,selectedRole:e.selectedRole,isEnabledByDefault:e.isEnabledByDefault,profiles:e.profiles}),this._logger)})))}}var V,L=i(73975);!function(e){e.eq=L.f7(((e,t)=>"main"===e.kind&&"main"===t.kind?e.state===t.state:e.kind===t.kind))}(V||(V={}));var H=i(88187),K=i(17889);class ${constructor(e,t){this._initialView=e,this._viewEq=t,this._viewStack=s.h.create([this._initialView]),this.activeView=this._viewStack.view(K.YM)}push(e){this._viewStack.modify((t=>this._viewEq.equals(e,t[0])?t:K.QI(e,t)))}pop(){this._viewStack.modify((0,g.ls)(K.pW,(([e,t])=>(0,g.zG)(K.c2(t),r.getOrElse((()=>[e]))))))}replace(e){this._viewStack.modify((t=>(0,g.zG)(K.QI(e,K.Gb(t)))))}}class W{constructor(e){this._theme=e,this.theme=this._theme}}var Z,q=i(47150);!function(e){e.create=function(e){var t;const i=(0,q.UF)(e),a=new n.xQ,l=new $({kind:"main",state:"beforeResults"},V.eq),c=new H.A2(Object.assign({assistantUIActions:a,routingViewModel:l},i)),u=new M({assistantUIActions:a,trackingService:i.trackingService,sessionService:i.sessionService,logger:i.logger,routingViewModel:l}),d=new p({assistantUIActions:a,feedbackService:i.feedbackService,monitoringService:i.monitoringService,logger:i.logger,routingViewModel:l}),m=new C.A(a,i.genAIAvailabilityService,i.sessionService,i.trackingService,(()=>r.isSome(c.state.get().selectedAction)),(()=>c.focusPromptField())),h=new S(a,l.activeView),g=new T({userSurveyService:i.userSurveyService,assistantUIActions:a}),f=new A(a,l,i.monitoringService,i.skillService);i.selectionContextAvailabilityService&&i.selectionContextAvailabilityService.augment((e=>s.h.combine(e,l.activeView,((e,t)=>"main"===t.kind?e:{contextUpdatesClient:!1,contextUpdatesServer:!1}))));const v=new W(null!==(t=i.theme)&&void 0!==t?t:s.h.create(o));return{assistant:c,promptMenu:m,notifications:h,voiceProfile:u,feedbackForm:d,userSurvey:g,skill:f,theme:v,revision:r.fromNullable(i.revisionEngine),routing:l,actions:a.asObservable(),notify:e=>a.next(e),dispose:()=>{c.dispose(),m.dispose(),h.dispose(),u.dispose(),d.dispose(),g.dispose(),f.dispose()}}}}(Z||(Z={}));var Y,X=i(63712),Q=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){e.create=function(e){const{positionInfo:t,handlers:i}=e,n=Q(e,["positionInfo","handlers"]),r=Z.create(Object.assign(Object.assign({},n),{handlers:{close:()=>i.close()}})),s=new X.u(t,{onFocusChange:e=>i.onFocusChange(e)});return Object.assign(Object.assign({},r),{position:s,dispose:()=>{s.dispose(),r.dispose()}})}}(Y||(Y={}))},88187:(e,t,i)=>{i.d(t,{A2:()=>D,Dj:()=>n});var n,r,s=i(95195),o=i(45701),a=i(64015),l=i(17889),c=i(57050),u=i(14601),d=i(24209),m=i(60797),p=i(77176),h=i(19751),g=i(78674),f=i(85985),v=i(98403),y=i(16118),b=i(2834),x=i(23063),k=i(5114),S=i(83078),C=i(22232),w=i(38983),_=i(42636),I=i(83289),E=i(98370),A=i(89727),O=i(14047),R=i(7903),U=i(99877),T=i(63346),B=i(65602),P=i(2735),N=i(54596),z=i(26320),G=i(123),j=i(47150),F=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};!function(e){let t;!function(e){e.make=function(e){return{kind:"backendAction",action:e}},e.ordByActionStore=o.contramap((e=>e.action.store.rank))(o.ordNumber)}(t=e.BackendAction||(e.BackendAction={}))}(n||(n={})),function(e){e.create=function(){return{textBox:"",selectedAction:k.none,promptAutofocusToken:0,cardsState:{hoveredCard:k.none,focusedCard:k.none},reportMenuVisible:k.none,referencesVisibility:new Map,detectedReferences:k.none,overrideCardVoice:new Map}}}(r||(r={}));class D{constructor(e){var t;this._params=e,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new T.W(D.name),this._state=w.h.create(r.create()),this._subs=new u.w,this._reportMenuVisibleDebounced=w.h.create(k.none),this.state=w.h.combine(this._state,this._params.userService.user,this._params.genAIAvailabilityService.availability,this._params.sessionService.session,this._reportMenuVisibleDebounced,((e,t,i,n,r)=>{var{cardsState:s,reportMenuVisible:o,textBox:l}=e,u=F(e,["cardsState","reportMenuVisible","textBox"]);return Object.assign(Object.assign({},u),{textBox:l,user:t,genAIAvailability:i,session:n,userPromptAction:(0,c.zG)(R.z.toStarted(n),k.chain((e=>e.activeContext.userPromptAction))),activeCards:new Set((0,c.zG)([s.hoveredCard,(0,c.zG)(s.focusedCard,S.vx((0,c.zG)(r,k.chain(G.G.toCard))))],a.oA)),canScroll:k.isNone(o),contextualActions:(0,j.F_)(n),detectedReferences:(0,j.fM)(n,l)})})),this._subs.add(this.state.subscribe((e=>this._logger.debug("State update",e)))),this._subs.add(this._updateActiveView().subscribe()),this._subs.add(d.T(this._state.view("reportMenuVisible").pipe(m.oA,p.U(k.some)),this._state.view("reportMenuVisible").pipe(h.skipBy(k.getEq(G.G.eq)),g.b(250),f.h(k.isNone))).subscribe(v.wW(this._reportMenuVisibleDebounced))),this._subs.add(this._params.routingViewModel.activeView.subscribe((()=>this._state.modify((0,c.ls)(N.e.set("reportMenuVisible",k.none),N.e.set("cardsState",{hoveredCard:k.none,focusedCard:k.none})))))),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}focusPromptField(){this._state.lens("promptAutofocusToken").modify((e=>e+1))}getContextById(e){return this._params.sessionService.getContextById(e)}dispose(){this._subs.unsubscribe()}_updateActiveView(){return d.T(this._params.sessionService.session.view((0,c.ls)(R.z.toStarting,k.chain((e=>e.error)),S.bw((()=>this._params.routingViewModel.replace({kind:"error"}))))),this._params.sessionService.session.view((0,c.ls)(R.z.toStarted,k.fold(c.jv,(e=>k.isSome(e.inProgressResult))))).pipe(y.G(),f.h((([e,t])=>!e&&t)),b.b((()=>this._params.routingViewModel.replace({kind:"main",state:"afterResults"})))),this._params.sessionService.session.view((0,c.ls)(R.z.toStarted,k.fold(c.jv,(e=>k.isSome(e.inProgressResult)||e.results.length>0)))).pipe(y.G(),f.h((([e,t])=>e&&!t)),b.b((()=>this._params.routingViewModel.replace({kind:"main",state:"beforeResults"})))))}_handleUIAction(e){switch(e.kind){case I.i.Kind.headerCloseButtonClick:return void this._close(e);case I.i.Kind.headerGoBackButtonClick:case I.i.Kind.radioOptionsCancelButtonClick:return this._goBack();case I.i.Kind.promptFieldTextChange:return this._updateTextBox(e.text);case I.i.Kind.actionBrickClick:return this._executeAction(e.action);case I.i.Kind.promptSubmitButtonClick:return this._go(k.none);case I.i.Kind.userPromptSubmit:return this._go(k.some(e.prompt));case I.i.Kind.radioOptionsSubmitButtonClick:return this._submitSelectedAction({selectedRadioOption:e.selectedOption});case I.i.Kind.generateStopButtonClick:return this._stop();case I.i.Kind.resultCardInsertButtonClick:return this._insert(e.result,e.selectedVoice);case I.i.Kind.resultCardRephraseButtonClick:return this._rephrase(e.result,e.selectedVoice);case I.i.Kind.resultCardDismissButtonClick:return this._dismissResult(e.result);case I.i.Kind.errorCardOkButtonClick:return this._dismissError();case I.i.Kind.reportOffensiveResultButtonClick:return this._reportOffensiveResult(e.result);case I.i.Kind.reportOffensiveActionsButtonClick:return this._reportOffensiveActions();case I.i.Kind.resultCardHeaderClick:return this._clickResultHeader(e.prompt);case I.i.Kind.creditsInfoHover:return this._params.trackingService.trackUsageInfoHover();case I.i.Kind.creditsInfoClick:return this._onCreditsInfoClick();case I.i.Kind.resultCardHoverChange:return this._onCardHover(e.resultId,e.hovered);case I.i.Kind.resultCardFocusChange:return this._onCardFocus(e.resultId,e.focused);case I.i.Kind.resultCardCopy:return this._onCardCopy(e.resultId);case I.i.Kind.resultCardToggleGenericVoiceButtonClick:return this._onToggleGenericVoice(e.resultId,e.voice);case I.i.Kind.reportMenuVisibilityChange:return this._onCardReportMenuVisibilityChange(e.trigger,e.visible);case I.i.Kind.referencesVisibilityChange:return this._onCardReferencesVisibilityChange(e.resultId,e.visible);case I.i.Kind.regenerateWithoutReferenceButtonClick:return this._regenerateWithoutReference(e.result,e.referenceId,e.selectedVoice);case I.i.Kind.mount:return this._handleMount(e);case I.i.Kind.promptFieldKeyPressEscape:return this._onPromptFieldKeyPressEscape(e);case I.i.Kind.promptFieldKeyPressEnter:return e.text.trim().length>0?this._go(k.none):this._tryInsertLatestResult();case I.i.Kind.restoreHistoryButtonClick:return this._handleHistoryButtonClick();case I.i.Kind.removeSelectionContextClick:return this._params.sessionService.dismissActiveBoundaryContext();case I.i.Kind.selectionContextInteraction:return this._params.textEditorService.setContextHighlight(e.range,e.visibility);default:return}}_handleHistoryButtonClick(){(0,c.zG)(R.z.toStarted(this._params.sessionService.session.get()),k.map((e=>k.isSome(e.inProgressResult)||e.results.length>0)),S.bw((e=>{e?this._params.routingViewModel.replace({kind:"main",state:"afterResults"}):(this._params.sessionService.restoreHistory(),this._subs.add(this._params.sessionService.session.view(R.z.toStarted).pipe(m.oA,f.h((e=>void 0!==e.results.find(O.x.isHistory))),x.q(1)).subscribe((()=>this._params.routingViewModel.replace({kind:"main",state:"afterResults"})))))})))}_handleMount(e){e.name===U.e.creditsInfoButton?(0,z.t)("reportUphookShow",this._params.uphookService.reportUphookShow(this._params.userService.user.get()),this._logger,void 0,(e=>this._params.monitoringService.notify((0,E.L)((0,A.ix)({rawError:(0,P.N)(e)}))))):e.name===U.e.historyButton&&this._params.trackingService.trackHistoryButtonView()}_onCardHover(e,t){this._state.lens("cardsState").lens("hoveredCard").modify(t?()=>k.some(e):k.filter((t=>t!==e)))}_onCardFocus(e,t){this._state.lens("cardsState").lens("focusedCard").modify(t?()=>k.some(e):k.filter((t=>t!==e)))}_onCardCopy(e){this._params.sessionService.trackResultCopy(e)}_onCardReportMenuVisibilityChange(e,t){this._state.modify((i=>Object.assign(Object.assign({},i),{reportMenuVisible:t?k.some(e):(0,c.zG)(i.reportMenuVisible,k.filter((t=>!G.G.eq.equals(t,e)))),cardsState:Object.assign(Object.assign({},i.cardsState),{hoveredCard:(0,c.zG)(G.G.toCard(e),k.fold((()=>i.cardsState.hoveredCard),(e=>t?i.cardsState.hoveredCard:(0,c.zG)(i.cardsState.hoveredCard,k.filter((t=>t!==e))))))})})))}_onCardReferencesVisibilityChange(e,t){this._state.lens("referencesVisibility").modify((i=>new Map(i).set(e,t)))}_onToggleGenericVoice(e,t){this._state.lens("overrideCardVoice").modify((i=>{var n;const r=new Map(i),s=(null!==(n=i.get(e))&&void 0!==n?n:t)===O.x.GeneratedTextVoice.generic?O.x.GeneratedTextVoice.user:O.x.GeneratedTextVoice.generic;return r.set(e,s),this._params.trackingService.trackMyVoiceCardToggle(s===O.x.GeneratedTextVoice.user),r}))}_close(e){I.i.is(I.i.Kind.headerCloseButtonClick)(e)&&this._params.trackingService.trackAssistantClose(),(0,z.t)("close",this._params.handlers.close(),this._logger,void 0,(e=>this._params.monitoringService.notify((0,E.L)((0,A.eM)({rawError:(0,P.N)(e)})))))}_goBack(){"followUpPrompt"===this._params.routingViewModel.activeView.get().kind&&this._state.modify((e=>Object.assign(Object.assign({},e),{selectedAction:k.none,textBox:""}))),this._params.routingViewModel.pop()}_updateTextBox(e){this._state.lens("textBox").set(e),this._searchReferences(e)}_executeAction(e){if("backendAction"===e.kind)if(_.aU.isFollowUpQuestionActionInput(e.action)){const t=e.action;this._state.modify((e=>Object.assign(Object.assign({},e),{textBox:"",selectedAction:k.some(t)}))),this._params.routingViewModel.push({kind:"followUpPrompt",inputType:_.Xy.match({radio:()=>"radio",string:()=>"string"})(e.action.args[0])})}else _.aU.isQuickActionInput(e.action)?(this._state.modify((e=>Object.assign(Object.assign({},e),{textBox:"",selectedAction:k.none}))),this._params.sessionService.submitAction(e.action,k.toUndefined(this._lastResultSelectedVoice()))):_.aU.isSkillActionInput(e.action)||(0,C.L0)(e.action);else"allResults"===e.kind||("go"===e.kind?this._go(k.none):(0,C.L0)(e))}_handleAIUsageNotificationOnPromptSubmit(){(0,c.zG)(R.z.toStarted(this._params.sessionService.session.get()),k.chain((e=>e.activeContext.specialView)),k.filter((e=>"aiUsageAlert"===e.kind)),S.bw((()=>this._params.trackingService.trackAINotificationDismiss("document"))))}_go(e){k.isSome(e)?(this._handleAIUsageNotificationOnPromptSubmit(),this._params.sessionService.submitAction(S.MH(e),k.toUndefined(this._lastResultSelectedVoice()))):k.isSome(this._state.get().selectedAction)?this._submitSelectedAction({textBox:this._state.get().textBox}):(this._handleAIUsageNotificationOnPromptSubmit(),this._submitUserPromptAction())}_stop(){this._params.sessionService.stopInProgressResult()()}_insert(e,t){(0,z.t)("insertText",this._params.textEditorService.insertText((0,B.l)((0,c.zG)(e.replacementDelta,s.fold(c.yR,(e=>t===O.x.GeneratedTextVoice.user?e.user:e.generic))),"")),this._logger,(()=>{this._params.sessionService.trackResultInsert(e.id,t===O.x.GeneratedTextVoice.user)}))}_tryInsertLatestResult(){(0,c.zG)(R.z.toStarted(this._params.sessionService.session.get()),k.map((e=>e.results)),k.chain(a.YM),k.filter(O.x.isStandardCompletedResult),S.bw((e=>this._insert(e,(0,c.zG)(this._lastResultSelectedVoice(),k.getOrElse((()=>O.x.GeneratedTextVoice.generic)))))))}_onPromptFieldKeyPressEscape(e){(0,c.zG)(R.z.toStarted(this._params.sessionService.session.get()),k.chain((e=>e.inProgressResult)),k.fold((()=>this._close(e)),(()=>this._stop())))}_rephrase(e,t){this._params.sessionService.regenerateResult(e.id,{omitReferenceIds:k.none},t)}_dismissResult(e){this._params.sessionService.dismissResult(e.id),this._state.modify((t=>Object.assign(Object.assign({},t),{reportMenuVisible:(0,c.zG)(t.reportMenuVisible,k.filter((t=>!G.G.eq.equals(t,G.G.card(e.id))))),cardsState:{hoveredCard:(0,c.zG)(t.cardsState.hoveredCard,k.filter((t=>t!==e.id))),focusedCard:(0,c.zG)(t.cardsState.hoveredCard,k.filter((t=>t!==e.id)))}})))}_dismissError(){this._params.sessionService.dismissError()}_reportOffensiveResult(e){this._params.sessionService.trackResultOffensive(e.id)}_reportOffensiveActions(){this._params.sessionService.trackActionsOffensive()}_clickResultHeader(e){this._state.modify((t=>Object.assign(Object.assign({},t),{textBox:e,promptAutofocusToken:t.promptAutofocusToken+1})))}_onCreditsInfoClick(){this._params.trackingService.trackUsageInfoClick(),(0,z.t)("reportUphookClick",this._params.uphookService.reportUphookClick(this._params.userService.user.get()),this._logger,void 0,(e=>this._params.monitoringService.notify((0,E.L)((0,A.ol)({rawError:(0,P.N)(e)})))))}_submitSelectedAction(e){(0,c.zG)(this._state.get().selectedAction,k.chain((t=>(0,c.zG)(t.args[0],_.Xy.match({string:()=>{var i;return(0,c.zG)(k.fromNullable(null===(i=e.textBox)||void 0===i?void 0:i.trim()),k.filter((e=>e.length>0)),k.map((e=>_.aU.FollowUpQuestionActionValue.fromTextInput(t,e))))},radio:()=>(0,c.zG)(k.fromNullable(e.selectedRadioOption),k.map((e=>_.aU.FollowUpQuestionActionValue.fromRadioInput(t,e))))})))),S.bw((e=>{this._state.modify((e=>Object.assign(Object.assign({},e),{selectedAction:k.none,textBox:""}))),this._params.sessionService.submitAction(e,k.toUndefined(this._lastResultSelectedVoice()))})))}_lastResultSelectedVoice(){return(0,c.zG)(R.z.toStarted(this._params.sessionService.session.get()),k.map((e=>e.results)),k.chain(a.YM),k.chain((e=>k.fromNullable(this._state.lens("overrideCardVoice").view((t=>t.get(e.id))).get()))))}_submitUserPromptAction(){(0,c.zG)(this._state.get().textBox.trim(),k.fromPredicate((e=>""!==e)),k.chain((e=>(0,c.zG)(R.z.toStarted(this._params.sessionService.session.get()),k.chain((t=>(0,c.zG)(t.activeContext.userPromptAction,k.map((i=>({text:e,session:t,userPromptAction:i}))))))))),S.bw((({text:e,session:t,userPromptAction:i})=>{this._state.lens("textBox").set(""),this._params.sessionService.submitAction(_.aU.UserPromptActionValue.fromInput(i,e,(0,c.zG)((0,j.fM)(t,e),k.map(a.DZ((e=>(0,c.zG)(e.url,k.map((t=>({url:t,referenceId:e.id}))))))),k.chain(l.nI)),k.none),k.toUndefined(this._lastResultSelectedVoice()))})))}_regenerateWithoutReference(e,t,i){this._params.sessionService.regenerateResult(e.id,{omitReferenceIds:k.some([t])},i)}_searchReferences(e){(0,c.zG)((0,j.Yl)(e),S.bw((e=>e.forEach((e=>this._params.sessionService.searchReferences(e))))))}}},63712:(e,t,i)=>{i.d(t,{u:()=>g,G:()=>h});var n=i(5114),r=i(57050),s=i(14601),o=i(2768),a=i(85985),l=i(2834),c=i(49708),u=i(38983),d=i(54596);function m(e=document){return{top:0,left:0,height:e.documentElement.clientHeight,width:e.documentElement.clientWidth}}function p(e,t){return i=>{const n=function(e,t){const i=e.left<t.left?t.left:e.left+e.width>t.left+t.width?t.left+t.width-e.width:e.left,n=e.top<t.top?t.top:e.top+e.height>t.top+t.height?t.top+t.height-e.height:e.top;return Object.assign(Object.assign({},e),{left:i,top:n})}({left:e.left+i.x,top:e.top+i.y,width:e.width,height:e.height},t);return{x:n.left-e.left,y:n.top-e.top}}}function h(e){return(0,r.zG)(e,n.fromPredicate((e=>"initial"===e.kind||"dragged"===e.kind)))}class g{constructor(e,t){this._positionInfo=e,this._handlers=t,this._internalState=u.h.create({managedPositionInfo:n.none,assistant:n.none,dragState:n.none,assistantMaxHeight:n.none}),this.state=this._internalState.view((e=>(0,r.zG)(e.dragState,n.map((t=>{return i=t,n=e.assistantMaxHeight,{kind:"dragged",dragging:i.dragging,referencePosition:i.translationOrigin,assistantMaxHeight:n,translation:p(Object.assign(Object.assign({},i.assistantSize),{top:i.viewportSize.height-i.translationOrigin.bottom-i.assistantSize.height,left:i.viewportSize.width-i.translationOrigin.right-i.assistantSize.width}),Object.assign({left:0,top:0},i.viewportSize))(i.translation)};var i,n})),n.alt((()=>(0,r.zG)(e.managedPositionInfo,n.map((t=>({kind:"initial",referenceElement:t.referenceElement,placement:t.placement,offset:t.offset,assistantMaxHeight:e.assistantMaxHeight})))))),n.getOrElse((()=>({kind:"none"})))))),this._subs=new s.w,this._subs.add(this._positionInfo.pipe(o.R(this._internalState.view("dragState").pipe(a.h(n.isSome))),l.b((e=>this._internalState.lens("managedPositionInfo").set(n.some(e))))).subscribe()),this._subs.add(c.R(self,"resize").pipe(l.b((()=>this._internalState.lens("dragState").modify(n.map(d.e.set("viewportSize",(0,r.zG)(m(),(({width:e,height:t})=>({width:e,height:t}))))))))).subscribe())}onFocusChange(e){this._handlers.onFocusChange(e)}onMount(e){this._internalState.lens("assistant").set(n.some(e))}onResize(e){this._internalState.lens("dragState").modify(n.map(d.e.set("assistantSize",(0,r.zG)(e,(({width:e,height:t})=>({width:e,height:t}))))))}onMaxHeightChange(e){this._internalState.lens("assistantMaxHeight").set(n.some(e))}onDrag(e){this._internalState.modify((t=>Object.assign(Object.assign({},t),{dragState:(0,r.zG)(t.dragState,n.map((0,r.ls)(d.e.set("translation",e),d.e.set("dragging",!0))),n.alt((()=>(0,r.zG)(t.assistant,n.map((e=>({assistantRect:e.getBoundingClientRect(),viewportSize:(0,r.zG)(m(),(({width:e,height:t})=>({width:e,height:t})))}))),n.map((({assistantRect:t,viewportSize:i})=>({dragging:!0,viewportSize:i,assistantSize:{width:t.width,height:t.height},translation:e,translationOrigin:{bottom:i.height-(t.top+t.height),right:i.width-(t.left+t.width)}})))))))})))}onDragEnd(){this._internalState.lens("dragState").modify(n.map(d.e.set("dragging",!1)))}dispose(){this._subs.unsubscribe()}}},123:(e,t,i)=>{i.d(t,{G:()=>n});var n,r=i(57050),s=i(95195),o=i(73975),a=i(5114),l=i(14047);!function(e){e.eq=s.getEq(o.yv,l.x.Id.eq),e.card=function(e){return s.right(e)},e.uiItem=function(e){return s.left(e)},e.toCard=function(e){return a.fromEither(e)},e.toUIItem=function(e){return(0,r.zG)(e,s.fold(a.some,(()=>a.none)))}}(n||(n={}))},47150:(e,t,i)=>{i.d(t,{F_:()=>u,UF:()=>p,Yl:()=>m,fM:()=>d});var n=i(64015),r=i(17889),s=i(57050),o=i(5114),a=i(83078),l=i(62965),c=i(7903);function u(e){return(0,s.zG)(c.z.toStarted(e),o.filter((e=>(0,s.zG)(e.activeContext.specialView,a.wo((({kind:e})=>"aiUsageAlert"!==e))))),o.map((e=>e.activeContext.availableActions)),o.chain(r.c2))}function d(e,t){return(0,s.zG)(c.z.toStarted(e),o.chain((e=>(0,s.zG)(m(t),o.map(n.DZ((t=>{var i;return null!==(i=e.detectedReferences.get(t))&&void 0!==i?i:o.none}))),o.chain(r.c2)))))}function m(e){return(0,s.zG)(e.split(/\s/).filter((e=>e.length>3&&e.includes("."))),r.nI)}function p(e){return Object.assign(Object.assign({},e),{handlers:Object.assign(Object.assign({},e.handlers),{close:()=>(0,s.zG)(l.fF((()=>new Promise((e=>setTimeout(e))))),l.tS(e.handlers.close))})})}},72004:(e,t,i)=>{var n;i.d(t,{x:()=>n}),function(e){let t,i;!function(e){e.ok="ok",e.satisfied="satisfied",e.dissatisfied="dissatisfied"}(t=e.Mood||(e.Mood={})),function(e){e.resultCard="resultCard",e.quickReplyInitialActions="quickReplyInitialActions"}(i=e.Source||(e.Source={}))}(n||(n={}))},75552:(e,t,i)=>{var n;i.d(t,{C:()=>n}),function(e){let t;!function(e){e.feedbackSubmitted="feedbackSubmitted",e.voiceTagRemoved="voiceTagRemoved"}(t=e.Kind||(e.Kind={}))}(n||(n={}))},50901:(e,t,i)=>{i.d(t,{T:()=>n});var n,r=i(22232);!function(e){let t;!function(e){e.initial="initial",e.initialBTS="initialBTS",e.history="history",e.prompts="prompts",e.review="review",e.rewrite="rewrite",e.knowledgeHub="knowledgeHub",e.references="references"}(t=e.StepName||(e.StepName={})),function(e){e.isAssistantOnboardingStep=function(t){switch(t){case e.prompts:case e.review:case e.knowledgeHub:case e.references:case e.history:return!0;case e.initial:case e.initialBTS:case e.rewrite:return!1;default:return(0,r.L0)(t)}},e.isTooltipOnboardingStep=function(t){switch(t){case e.prompts:case e.review:case e.rewrite:case e.knowledgeHub:case e.references:case e.history:return!0;case e.initial:case e.initialBTS:return!1;default:return(0,r.L0)(t)}}}(t=e.StepName||(e.StepName={}))}(n||(n={}))},51478:(e,t,i)=>{i.d(t,{l:()=>n});var n,r=i(22232);!function(e){let t;!function(e){e.close="close",e.tryItOut="tryItOut",e.mount="mount"}(t=e.Kind||(e.Kind={})),e.is=function(e){return t=>t.kind===e}}(n||(n={})),(0,r.L0)(void 0)},12422:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(95195),r=i(5114),s=i(64015),o=i(57050),a=i(69243);var l;!function(e){const t=["initial","initialBTS","prompts","review","rewrite","knowledgeHub","references","history"],i=["extension","editor","llamaMac","llamaWin"];function l(e,t){return`${e}|${t}`}function c(e,t,i){return`${e}|${t}|${i}`}function u(e){return r.isSome(y(e))}function d(e){return r.isSome(b(e))}const m=new a.Dy("CompletedStepName",(e=>"string"==typeof e&&u(e)),((e,t)=>"string"==typeof e&&u(e)?a.Vp(e):a.Rn(e,t)),a.yR),p=new a.Dy("LastSeenStepName",(e=>"string"==typeof e&&d(e)),((e,t)=>"string"==typeof e&&d(e)?a.Vp(e):a.Rn(e,t)),a.yR),h=a.OT(a.r$({completed:a.Bk(m),lastSeen:a.Bk(p)}));let g,f,v;function y(e){return(0,o.zG)(r.some(e.split("|")),r.filter((e=>2===e.length)),r.filter((e=>t.includes(e[0])&&i.includes(e[1]))))}function b(e){return(0,o.zG)(r.some(e.split("|")),r.filter((e=>3===e.length)),r.filter((e=>t.includes(e[0])&&i.includes(e[1]))),r.filterMap((e=>(0,o.zG)(parseInt(e[2],10),(t=>Number.isNaN(t)?r.none:r.some([e[0],e[1],t]))))))}function x(e,t,i){var n,r,s,o;return{extension:{completed:t.some((t=>t[0]===e&&"extension"===t[1])),lastSeen:null===(n=i.find((t=>t[0]===e&&"extension"===t[1])))||void 0===n?void 0:n[2]},editor:{completed:t.some((t=>t[0]===e&&"editor"===t[1])),lastSeen:null===(r=i.find((t=>t[0]===e&&"editor"===t[1])))||void 0===r?void 0:r[2]},llamaMac:{completed:t.some((t=>t[0]===e&&"llamaMac"===t[1])),lastSeen:null===(s=i.find((t=>t[0]===e&&"llamaMac"===t[1])))||void 0===s?void 0:s[2]},llamaWin:{completed:t.some((t=>t[0]===e&&"llamaWin"===t[1])),lastSeen:null===(o=i.find((t=>t[0]===e&&"llamaWin"===t[1])))||void 0===o?void 0:o[2]}}}e.emptyClientStep={completed:!1,lastSeen:void 0},function(e){function t(e){return t=>e(t.extension)||e(t.editor)||e(t.llamaMac)||e(t.llamaWin)}e.anyClient=t,e.anyClientCompleted=t((e=>e.completed))}(g=e.Step||(e.Step={})),e.emptyStep={extension:e.emptyClientStep,llamaMac:e.emptyClientStep,llamaWin:e.emptyClientStep,editor:e.emptyClientStep},e.codec=new a.Dy("UpstreamOnboarding",(e=>h.is(e)),((e,t)=>(0,o.zG)(h.validate(e,t),n.map((e=>{const t=(0,o.zG)(e.completed||[],s.UI(y),s.oA),i=(0,o.zG)(e.lastSeen||[],s.UI(b),s.oA);return{initial:x("initial",t,i),initialBTS:x("initialBTS",t,i),prompts:x("prompts",t,i),review:x("review",t,i),rewrite:x("rewrite",t,i),knowledgeHub:x("knowledgeHub",t,i),references:x("references",t,i),history:x("history",t,i)}})))),(e=>({completed:(0,o.zG)(Object.entries(e),s.tS((([e,t])=>function(e,t){return(0,o.zG)(Object.entries(t),s.tS((([t,i])=>i.completed?[l(e,t)]:[])))}(e,t)))),lastSeen:(0,o.zG)(Object.entries(e),s.tS((([e,t])=>function(e,t){return(0,o.zG)(Object.entries(t),s.tS((([t,i])=>i.lastSeen?[c(e,t,i.lastSeen)]:[])))}(e,t))))}))),e.decode=function(t){return(0,o.zG)(decodeURIComponent(t),(i=>{try{const t=JSON.parse(i);return e.codec.decode(t)}catch(e){return n.left(`Cannot decode raw onboarding state: ${t}.`)}}),n.getOrElse((()=>e.State.empty)))},e.encode=function(t){return encodeURIComponent(JSON.stringify(e.codec.encode(t)))},function(t){t.empty={initial:e.emptyStep,initialBTS:e.emptyStep,prompts:e.emptyStep,review:e.emptyStep,rewrite:e.emptyStep,knowledgeHub:e.emptyStep,references:e.emptyStep,history:e.emptyStep},t.toClientState=function(e,t){return{initial:e.initial[t],initialBTS:e.initialBTS[t],prompts:e.prompts[t],review:e.review[t],rewrite:e.rewrite[t],knowledgeHub:e.knowledgeHub[t],references:e.references[t],history:e.history[t]}},t.patch=function(e,t){return i=>({initial:Object.assign(Object.assign({},i.initial),{[t]:e.initial}),initialBTS:Object.assign(Object.assign({},i.initialBTS),{[t]:e.initialBTS}),prompts:Object.assign(Object.assign({},i.prompts),{[t]:e.prompts}),review:Object.assign(Object.assign({},i.review),{[t]:e.review}),rewrite:Object.assign(Object.assign({},i.rewrite),{[t]:e.rewrite}),knowledgeHub:Object.assign(Object.assign({},i.knowledgeHub),{[t]:e.knowledgeHub}),references:Object.assign(Object.assign({},i.references),{[t]:e.references}),history:Object.assign(Object.assign({},i.history),{[t]:e.history})})}}(f=e.State||(e.State={})),function(t){t.empty={initial:e.emptyClientStep,initialBTS:e.emptyClientStep,prompts:e.emptyClientStep,review:e.emptyClientStep,rewrite:e.emptyClientStep,knowledgeHub:e.emptyClientStep,references:e.emptyClientStep,history:e.emptyClientStep}}(v=e.ClientState||(e.ClientState={}))}(l||(l={}))},81484:(e,t,i)=>{i.d(t,{T:()=>ke});var n=i(34217),r=i(27378),s=i(13578),o=i(2834),a=i(93986),l=i(31956),c=i(31278),u=i(12187),d=i(89894),m=i(94689);const p="closeBtn",h="closeIcon",g=(0,m.dD)({$nest:{[`& .${h}`]:Object.assign(Object.assign({},(0,m.fx)(1.5)),{stroke:d.ux.important(s.vU.InteractiveNeutral.Primary.Default)})}},p),f=d.ux.joinClasses([p,d.ux.style(g)]),v=({name:e,className:t,size:i,onClick:n})=>r.createElement(a.z.Tertiary,Object.assign({},(0,u.Sh)(f,t),{onClick:n,compact:!0,size:i,theme:"light",name:e}),r.createElement(c.JO.Close,{className:h}));var y=i(24435),b=i(50901),x=i(51478),k=i(88392),S=i(9546);const C=({className:e})=>r.createElement("span",Object.assign({},(0,u.Sh)(w,e)),"New"),w=d.ux.style({color:s.S5.Content.OnPrimary.Default,fontWeight:700,fontSize:d.ux.rem(.75),lineHeight:d.ux.rem(1),justifyContent:"center",alignItems:"center",background:"linear-gradient(226.37deg, #BBD86D 0%, #41D9B5 100%)",borderRadius:d.ux.rem(k.HP),padding:`${d.ux.rem(S.yC)} ${d.ux.rem(S.x)}`,textTransform:"uppercase",width:"fit-content",cursor:"default"});var _=i(74204),I=i(62172),E=i(24351);const A=r.forwardRef((function({placement:e,style:t,arrowColor:i},n){return r.createElement("div",{ref:n,style:{width:33}},r.createElement("svg",{width:33,height:12,viewBox:"0 0 33 12.5",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:Object.assign(Object.assign(Object.assign({position:"absolute"},t),{transform:`${(null==t?void 0:t.transform)||""} rotate(${O(e)}deg)`.trimStart()}),R(e))},r.createElement("path",{d:"M0.5 3.41877e-07C3.5 3.41877e-07 29.5 3.41877e-07 32.5 3.41877e-07C28.5 3.41877e-07 26.4111 0.903505 24.1814 3.69994L17.5562 11.4728C16.957 12.1757 15.8652 12.1757 15.2661 11.4728L8.64084 3.69994C6.41113 0.903505 4.5 3.41877e-07 0.5 3.41877e-07Z",fill:i||"white"})))}));function O(e){return(null==e?void 0:e.startsWith("right"))?90:(null==e?void 0:e.startsWith("bottom"))?180:(null==e?void 0:e.startsWith("left"))?270:0}function R(e){return(null==e?void 0:e.startsWith("bottom"))?{top:-12}:(null==e?void 0:e.startsWith("top"))?{bottom:-12}:(null==e?void 0:e.startsWith("right"))?{transformOrigin:"top left",top:-16.5,left:0}:(null==e?void 0:e.startsWith("left"))?{transformOrigin:"top right",top:-16.5,right:0}:{}}const U=(0,u.xb)((({reference:e,placement:t,offset:i,boundaryAreaPadding:n,className:s,arrowColor:o,children:a})=>{const[l,c]=r.useState(null),[d,m]=r.useState(null),p=(0,E.s)(),{styles:h,attributes:g,state:f}=(0,_.D)(e,l,{placement:t,modifiers:[{name:"offset",options:{offset:[0,12+(null!=i?i:0)]}},{name:"arrow",options:{element:d,padding:12}},{name:"preventOverflow",options:{padding:null!=n?n:5}},p]});return r.createElement("div",Object.assign({dir:"ltr",ref:c,style:h.popper},g.popper,(0,u.Sh)(B,s)),r.createElement(A,{ref:m,style:h.arrow,placement:null==f?void 0:f.placement,arrowColor:o}),a)})),T=e=>d.ux.color(I.BlueGray40).toRGBA().fade(e).toString(),B=d.ux.style({filter:`drop-shadow(0px 0px 0.5px ${I.BlueGray40}) drop-shadow(0px 0px 2px ${T(.5)}) drop-shadow(0px 1px 6px ${T(.25)})`,borderRadius:d.ux.rem(k.xB+k.fe)}),P="tryItOutBtn",N="skipBtn",z=d.ux.rem(k.xB+k.fe),G={width:d.ux.rem(25.875),background:s.XY.Surface.Primary.Default},j={display:"flex",flexDirection:"column",gap:d.ux.rem(S.F2),padding:`${d.ux.rem(S.mh)} ${d.ux.rem(S.x0)} ${d.ux.rem(S.sD)} ${d.ux.rem(S.sD)}`,color:s.XY.Content.Primary.Default},F={display:"flex",flexDirection:"row",alignItems:"center",gap:d.ux.rem(S.x),fontWeight:"bold",fontSize:d.ux.rem(1),lineHeight:d.ux.rem(1.5)},D={fontSize:d.ux.rem(.875),lineHeight:d.ux.rem(1.375)},M={display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderBottomLeftRadius:z,borderBottomRightRadius:z,padding:`${d.ux.rem(S.qp)} ${d.ux.rem(S.sD)} ${d.ux.rem(S.qp)} ${d.ux.rem(S.sD)}`,backgroundColor:s.XY.Surface.Secondary.Default,color:s.XY.Content.Secondary.Default,fontSize:d.ux.rem(.875),lineHeight:d.ux.rem(1.3125),$nest:{a:{color:"inherit"}}},V={width:d.ux.rem(12),lineHeight:d.ux.rem(1.25)},L=Object.assign({marginRight:d.ux.rem(.5)},(0,m.dD)({fontSize:d.ux.rem(.875)},N)),H=(0,m.dD)({fontSize:d.ux.rem(.875),fontWeight:"bold"},P),K={position:"absolute",top:d.ux.rem(S.x),right:d.ux.rem(S.x)},$=d.ux.style(G),W=d.ux.style(j),Z=d.ux.style(F),q=d.ux.style(D),Y=d.ux.style(M),X=d.ux.style(V),Q=d.ux.style({display:"flex",flexDirection:"row",alignItems:"flex-end"}),J=d.ux.joinClasses([N,d.ux.style(L)]),ee=d.ux.joinClasses([P,d.ux.style(H)]),te=d.ux.style({display:"inline"}),ie=d.ux.style(K),ne=(e=b.T.StepName.initial)=>n.UI.Grid.make((({slots:t,view:i,notify:n})=>{const{onMount:l}=(0,y.F)(o.b((t=>n({kind:x.l.Kind.mount,step:e,element:t})())));return r.createElement(U,{className:$,reference:i("reference"),placement:i("placement"),offset:i("offset"),boundaryAreaPadding:i("boundaryAreaPadding"),arrowColor:s.XY.Surface.Secondary.Default},r.createElement("div",{ref:l},t.content),r.createElement("div",{className:Y},r.createElement("div",{className:X},t.footerText),r.createElement("div",{className:Q},r.createElement(a.z.Tertiary,{onClick:n({kind:x.l.Kind.close,step:e}),className:J,name:"skip"},"Skip"),r.createElement(a.z.Primary,{onClick:n({kind:x.l.Kind.tryItOut,step:e}),className:ee,name:"tryItOut"},"Try it out"))))})),re=n.UI.Node.make((({notify:e})=>r.createElement(r.Fragment,null,r.createElement(v,{onClick:e({kind:x.l.Kind.close,step:b.T.StepName.initial}),name:"onboardingClose",size:"medium",className:ie}),r.createElement("div",{className:W},r.createElement(C,null),r.createElement("div",{className:Z},r.createElement("div",null,"Write faster with GrammarlyGO")),r.createElement("div",{className:q},"Brainstorm, write, and rewrite with generative AI assistance at your fingertips."))))),se=n.UI.Node.make((()=>r.createElement(r.Fragment,null,"If you use GrammarlyGO,"," ",r.createElement(l.d,{href:"https://grammarly.com/terms",className:te},"additional terms")," ","apply."))),oe=n.UI.Knot.make(ne(),{content:re,footerText:se}),ae=n.UI.Node.make((({notify:e})=>r.createElement(r.Fragment,null,r.createElement(v,{onClick:e({kind:x.l.Kind.close,step:b.T.StepName.initialBTS}),name:"onboardingClose",size:"medium",className:ie}),r.createElement("div",{className:W},r.createElement(C,null),r.createElement("div",{className:Z},r.createElement("div",null,"Write better papers faster (for free!)")),r.createElement("div",{className:q},"Start with a brainstorm, then get instant feedback, revisions, and citations to ace your assignment."))))),le=n.UI.Knot.make(ne(b.T.StepName.initialBTS),{content:ae,footerText:n.UI.Node.empty});var ce=i(57050),ue=i(41398),de=i(77176),me=i(45578),pe=i(27995);function he(e){switch(e){case b.T.StepName.knowledgeHub:return d.ux.rem(16);case b.T.StepName.references:return d.ux.rem(17.8);default:return d.ux.rem(13.75)}}const ge=(0,u.xb)((({reference:e,placement:t,offset:i,boundaryAreaPadding:n,children:o,name:a})=>r.createElement(pe.J,{reference:e,placement:t,offset:i,boundaryAreaPadding:n,theme:{bgColor:I.Green80,fgColor:s.S5.Content.Primary.Default,padding:d.ux.rem(S.mh),width:he(a)}},o))),fe={[b.T.StepName.prompts]:{title:"Start with a prompt",description:e=>e?`Choose a suggested prompt, or type your own to get started. You’ll get ${Number(e).toLocaleString()} each month.`:"Choose a suggested prompt, or type your own to get started."},[b.T.StepName.review]:{title:"How does this sound?",description:"Adjust it to your liking with additional prompts. Don’t forget to check for any inaccuracies. "},[b.T.StepName.rewrite]:{title:"Want help rewriting?",description:"Select your text to rewrite it with GrammarlyGO."},[b.T.StepName.knowledgeHub]:{title:"Using organizational language?",description:"Prompt GrammarlyGO using terms and project names from Knowledge Share to automatically insert organizational context."},[b.T.StepName.references]:{title:"GrammarlyGO now incorporates your organizational knowledge",description:"Review the references for accuracy and relevance and regenerate the response without any references that seem irrelevant or outdated."},[b.T.StepName.history]:{title:"Return to recent history",description:"Pick up where you left off with your latest prompts."}},ve=n.UI.Node.make((({state:e,view:t,notify:i})=>{const{onMount:n}=(0,y.F)((0,ce.ls)(ue.M(t("name")),de.U((([e,t])=>({element:e,stepName:t}))),o.b((({element:e,stepName:t})=>i({kind:x.l.Kind.mount,step:t,element:e})()))));return r.createElement(ge,{name:t("name"),reference:t("reference"),placement:t("placement"),offset:t("offset"),boundaryAreaPadding:t("boundaryAreaPadding")},e.pipe(de.U((e=>r.createElement(r.Fragment,null,r.createElement(me.x,{onClick:i({kind:x.l.Kind.close,step:e.name}),name:"tooltipClose",className:xe,size:"small"}),r.createElement("div",{className:be},fe[e.name].title),r.createElement("div",{ref:n},e.name===b.T.StepName.prompts?fe[e.name].description(e.promptsAllocated):fe[e.name].description))))))})),ye=n.UI.Union.asOption(ve),be=d.ux.style({fontWeight:700}),xe=d.ux.style({position:"absolute",top:d.ux.rem(S.x),right:d.ux.rem(S.x)}),ke=n.UI.Union.make("kind",{none:n.UI.Node.empty,initial:oe,initialBTS:le,tooltip:ye})},82471:(e,t,i)=>{i.d(t,{A:()=>y});var n=i(5114),r=i(57050),s=i(76974),o=i(22232),a=i(34217),l=i(50901),c=i(60797);const u=e=>a.Z.fromSideEffect((t=>e.notify(t)),e.activeStep.pipe(c.oA)),d=e=>{const t=u(e);return a.Z.composeKnot({root:t,content:t,footerText:t})},m=e=>{const t=u(e);return a.Z.composeKnot({root:t,content:t,footerText:t})};var p=i(77176),h=i(85985),g=i(41398),f=i(71660);function v(e){return a.Z.composeOption(function(e){return a.Z.fromSideEffect((t=>e.notify(t)),e.activeStep.pipe(c.oA,h.h(f.X.isTooltipOnboardingStep),g.M(e.promptsAllocated.pipe(p.U(n.toUndefined))),p.U((([e,t])=>Object.assign(Object.assign({},e),{promptsAllocated:t})))))}(e),(()=>e.activeStep.pipe(p.U(n.filter(f.X.isTooltipOnboardingStep)))))}function y(e){return a.Z.composeUnion({none:()=>s.of(null),initial:d(e),initialBTS:m(e),tooltip:v(e)},(()=>e.activeStep.view(b).view((e=>({kind:e})))))}function b(e){return(0,r.zG)(e,n.filter((e=>e.show)),n.fold((()=>"none"),(e=>{switch(e.name){case l.T.StepName.initial:return"initial";case l.T.StepName.initialBTS:return"initialBTS";case l.T.StepName.prompts:case l.T.StepName.review:case l.T.StepName.rewrite:case l.T.StepName.knowledgeHub:case l.T.StepName.references:case l.T.StepName.history:return"tooltip";default:return(0,o.L0)(e.name)}})))}},12081:(e,t,i)=>{i.d(t,{k:()=>N});var n,r=i(5114),s=i(14601),o=i(85985),a=i(83289),l=i(64015),c=i(57050),u=i(93508),d=i(16118),m=i(77176),p=i(60797),h=i(41398),g=i(66310),f=i(80544),v=i(79692),y=i(2834),b=i(24209),x=i(67434),k=i(17343),S=i(40151),C=i(8125),w=i(22232),_=i(83078),I=i(14047),E=i(7903),A=i(69693),O=i(50901),R=i(51478);function U(e,t,i,n,r=1e3){return e.pipe(o.h(R.l.is(R.l.Kind.mount)),o.h((e=>i(e.step))),g.w((({step:e})=>t.pipe(m.U(_.FX(e)),g.w((e=>e?n.pipe(k.h(Date.now())):S.E)),o.h((e=>Date.now()-e>=r)),k.h(e)))))}!function(e){e.completeInitialOrRewriteStepOnSessionInit=({session:e,stepsSeenOnThisSession:t})=>e.pipe(u.O(r.none),d.G(),m.U((([e,t])=>r.isNone(e)&&r.isSome(t)?r.some(t):r.none)),p.oA,h.M(t),g.w((([e,t])=>(0,c.zG)([t.has(O.T.StepName.initial)?r.some(O.T.StepName.initial):r.none,t.has(O.T.StepName.initialBTS)?r.some(O.T.StepName.initialBTS):r.none,A.w.isRewriteOrQuickRewrite(e.value.mode)?r.some(O.T.StepName.rewrite):r.none],l.oA)))),e.completeReviewStepOnSecondResultReceived=({session:e,activeStep:t})=>e.pipe(m.U((0,c.ls)(r.chain(E.z.toStarted),r.fold((()=>0),(e=>e.results.length)))),d.G(),o.h((([e,t])=>1===e&&2===t)),h.M(t),m.U((([e,t])=>(0,c.zG)(t,r.filter((e=>e===O.T.StepName.review))))),p.oA),e.completeActiveAssistantStepOnSessionEnd=({session:e,activeStep:t,visibleForMs:i,onboardingUIActions:n})=>U(n,t.pipe(f.QV(v.E)),O.T.StepName.isAssistantOnboardingStep,e.pipe(d.G(),o.h((([e,t])=>r.isSome(e)&&r.isNone(t)))),i),e.completeStepOnCloseClick=({onboardingUIActions:e,trackingService:t})=>e.pipe(o.h(R.l.is(R.l.Kind.close)),m.U((e=>(e.step===O.T.StepName.initial&&t.trackOnboardingPopupSkip(),e.step===O.T.StepName.initialBTS&&t.trackBTSOnboardingPopupSkip(),e.step)))),e.completeInitialStepOnTryItOutClick=({onboardingUIActions:e,trackingService:t})=>e.pipe(o.h(R.l.is(R.l.Kind.tryItOut)),m.U((e=>(e.step===O.T.StepName.initial&&t.trackOnboardingPopupNext(),e.step===O.T.StepName.initialBTS&&t.trackBTSOnboardingPopupNext(),e.step)))),e.completeReviewStepOnResultInteraction=({assistantUIActions:e})=>e.pipe(o.h(a.i.isResultAction),o.h((e=>I.x.isStandardCompletedResult(e.result))),m.U((()=>O.T.StepName.review))),e.completeHistoryStepOnHistoryRestore=({assistantUIActions:e})=>e.pipe(o.h(a.i.is(a.i.Kind.restoreHistoryButtonClick)),m.U((()=>O.T.StepName.history))),e.completeAssistantStepsOnUserActions=({assistantUIActions:e,activeStep:t})=>e.pipe(o.h((0,C.Kg)(a.i.is(a.i.Kind.actionBrickClick),a.i.is(a.i.Kind.promptSubmitButtonClick),a.i.is(a.i.Kind.promptFieldKeyPressEnter),a.i.is(a.i.Kind.headerVoiceButtonClick),a.i.is(a.i.Kind.setVoiceButtonClick),a.i.is(a.i.Kind.openFeedbackFormButtonClick))),h.M(t),m.U((([e,t])=>(0,c.zG)(t,r.filter(O.T.StepName.isAssistantOnboardingStep)))),p.oA),e.completeInitialStepOnDispose=({onboardingUIActions:e,activeStep:t,disposed:i,visibleForMs:n})=>U(e,t,(e=>e===O.T.StepName.initial||e===O.T.StepName.initialBTS),i,n);const t=e=>t=>i=>t(i).pipe(y.b((t=>{var n;return null===(n=i.logger)||void 0===n?void 0:n.debug(`${e} - step to complete: ${t}`)})));function i(e){return e.pipe(x.R(((e,t)=>({seen:new Set(e.seen).add(t),step:e.seen.has(t)?r.none:r.some(t)})),{seen:new Set,step:r.none}),m.U((e=>e.step)),p.oA)}e.defaultCompletionSources=[t("session init")(e.completeInitialOrRewriteStepOnSessionInit),t("second result received")(e.completeReviewStepOnSecondResultReceived),t("session end")(e.completeActiveAssistantStepOnSessionEnd),t("user closed step")(e.completeStepOnCloseClick),t("user clicked try-it-out")(e.completeInitialStepOnTryItOutClick),t("user interacted with results")(e.completeReviewStepOnResultInteraction),t("user interacted with assistant")(e.completeAssistantStepsOnUserActions),t("user restored history")(e.completeHistoryStepOnHistoryRestore),t("feature disposed")(e.completeInitialStepOnDispose)],e.extractStepsToComplete=function(e,t){return b.T(...e.map((e=>e(t)))).pipe(i)}}(n||(n={}));var T=i(71660),B=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};class P extends T.o{constructor(e,t){super(e),this._onDispose=t}dispose(){super.dispose(),this._onDispose()}}function N(e){var{assistantUIActions:t,trackingService:i,completeOnboardingStep:l,stepCompletionSources:c,disposed:u,logger:d}=e,m=B(e,["assistantUIActions","trackingService","completeOnboardingStep","stepCompletionSources","disposed","logger"]);const p=new s.w,h=new P(Object.assign(Object.assign({},m),{assistantMountActions:t.pipe(o.h(a.i.is(a.i.Kind.mount))),assistantUnmountActions:t.pipe(o.h(a.i.is(a.i.Kind.unmount)))}),(()=>p.unsubscribe()));return p.add(n.extractStepsToComplete(null!=c?c:n.defaultCompletionSources,{onboardingUIActions:h.uiActions,assistantUIActions:t,activeStep:h.activeStep.view(r.map((e=>e.name))),stepsSeenOnThisSession:h.stepsSeenOnThisSession,session:m.session,trackingService:i,disposed:u,logger:d}).subscribe((e=>{l(e)}))),p.add(function(e,t){return e.pipe(o.h(R.l.is(R.l.Kind.mount)),y.b((e=>{switch(e.step){case O.T.StepName.initial:return t.trackOnboardingPopupView();case O.T.StepName.initialBTS:return t.trackBTSOnboardingPopupView();case O.T.StepName.prompts:return t.trackOnboardingPromptsTooltipView();case O.T.StepName.review:return t.trackOnboardingReviewTooltipView();case O.T.StepName.rewrite:return t.trackOnboardingRewriteTooltipView();case O.T.StepName.knowledgeHub:return t.trackOnboardingKnowledgeHubTooltipView();case O.T.StepName.references:return t.trackOnboardingReferencesTooltipView();case O.T.StepName.history:return t.trackOnboardingHistoryTooltipView();default:return(0,w.L0)(e.step)}})))}(h.uiActions,i).subscribe()),h}},71660:(e,t,i)=>{i.d(t,{X:()=>n,o:()=>C});var n,r=i(5114),s=i(57050),o=i(14601),a=i(32952),l=i(98403),c=i(60797),u=i(77176),d=i(93508),m=i(16118),p=i(85985),h=i(2844),g=i(28043),f=i(41398),v=i(67434),y=i(22232),b=i(38983),x=i(99877),k=i(50901),S=i(12422);!function(e){e.isTooltipOnboardingStep=function(e){return k.T.StepName.isTooltipOnboardingStep(e.name)}}(n||(n={}));class C{constructor(e){var t,i,n,v,C,I;this._params=e,this._subs=new o.w,this._assistantElements=b.h.create({}),this._externalElements=b.h.create({}),this._hideAssistantTooltips=b.h.create(!1),this._nextCandidateStep=b.h.create(r.none),this.stepsSeenOnThisSession=b.h.create(new Set),this._uiActions=new a.xQ,this.uiActions=this._uiActions.asObservable(),this.activeStep=b.h.combine(this._nextCandidateStep,this._assistantElements,this._externalElements,this._hideAssistantTooltips,((e,t,i,n)=>(0,s.zG)(e,r.chain((e=>function(e,t,i,n){switch(e){case k.T.StepName.initial:return(0,s.zG)(r.fromNullable(i[x.n.initialPopupAnchor]),r.map((e=>({name:k.T.StepName.initial,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!0}))));case k.T.StepName.initialBTS:return(0,s.zG)(r.fromNullable(i[x.n.initialBTSPopupAnchor]),r.map((e=>({name:k.T.StepName.initialBTS,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!0}))));case k.T.StepName.rewrite:return(0,s.zG)(r.fromNullable(i[x.n.rewriteTooltipAnchor]),r.map((e=>({name:k.T.StepName.rewrite,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!0}))));case k.T.StepName.prompts:return(0,s.zG)(r.fromNullable(t[x.e.initialActionsList]),r.map((e=>({name:k.T.StepName.prompts,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case k.T.StepName.review:return(0,s.zG)(r.fromNullable(t[x.e.followUpActionsList]),r.map((e=>({name:k.T.StepName.review,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case k.T.StepName.knowledgeHub:return(0,s.zG)(r.fromNullable(t[x.e.promptInput]),r.map((e=>({name:k.T.StepName.knowledgeHub,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case k.T.StepName.references:return(0,s.zG)(r.fromNullable(t[x.e.referencesList]),r.map((e=>({name:k.T.StepName.references,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));case k.T.StepName.history:return(0,s.zG)(r.fromNullable(t[x.e.historyButton]),r.map((e=>({name:k.T.StepName.history,reference:e.reference,placement:e.placement,offset:e.offset,boundaryAreaPadding:e.boundaryAreaPadding,show:!n}))));default:return(0,y.L0)(e)}}(e,t,i,n)))))),this.promptsAllocated=this._params.promptsAllocated,this._subs.add((t=this.activeStep,i=this._params.upstreamOnboardingState,n=this._params.session,v=this._params.textStats,C=this._params.forceDisabledOnboardingSteps,I=this._params.client,h.aj([n,i,v.pipe(_()),n.pipe(u.U(r.isSome),g.x(),f.M(i),u.U((([e,t])=>e?r.some(t):r.none)))]).pipe(u.U((([e,i,n,o])=>{if(r.isNone(e)){const e=!(0,s.zG)(t.get(),r.map((e=>e.name===k.T.StepName.initial)),r.getOrElse(s.jv))&&!C.has(k.T.StepName.initialBTS)&&!i.initialBTS[I].completed&&void 0===i.initialBTS[I].lastSeen,o=!C.has(k.T.StepName.initial)&&!i.initial[I].completed&&void 0===i.initial[I].lastSeen&&!i.initialBTS[I].completed&&void 0===i.initialBTS[I].lastSeen,a=!C.has(k.T.StepName.rewrite)&&!i.rewrite[I].completed&&(i.initial[I].completed||i.initialBTS[I].completed)&&n>=30;return e?r.some(k.T.StepName.initialBTS):o?r.some(k.T.StepName.initial):a?r.some(k.T.StepName.rewrite):r.none}return S.Z.Step.anyClientCompleted(i.prompts)||C.has(k.T.StepName.prompts)?S.Z.Step.anyClientCompleted(i.review)||C.has(k.T.StepName.review)?S.Z.Step.anyClientCompleted(i.history)||C.has(k.T.StepName.history)||!w(o)?S.Z.Step.anyClientCompleted(i.knowledgeHub)||C.has(k.T.StepName.knowledgeHub)||!w(o)?S.Z.Step.anyClientCompleted(i.references)||C.has(k.T.StepName.references)||!w(o)?r.none:r.some(k.T.StepName.references):r.some(k.T.StepName.knowledgeHub):r.some(k.T.StepName.history):r.some(k.T.StepName.review):r.some(k.T.StepName.prompts)})))).subscribe(l.wW(this._nextCandidateStep))),this._subs.add(this._params.assistantMountActions.subscribe((({name:e,element:t})=>this._assistantElements.modify((i=>Object.assign(Object.assign({},i),{[e]:{reference:t,placement:e===x.e.historyButton?"bottom":"left"}})))))),this._subs.add(this._params.assistantUnmountActions.subscribe((({name:e})=>this._assistantElements.modify((t=>Object.assign(Object.assign({},t),{[e]:void 0})))))),this._subs.add(this._params.externalElements.subscribe(l.wW(this._externalElements))),this._subs.add(this._params.hideAssistantOnboardingTooltips.subscribe(l.wW(this._hideAssistantTooltips))),this._subs.add(this.activeStep.pipe(c.oA).subscribe((e=>this.stepsSeenOnThisSession.modify((t=>new Set([...t,e.name])))))),this._subs.add(this._params.session.pipe(u.U(r.isSome),d.O(!1),m.G(),p.h((([e,t])=>e&&!t))).subscribe((()=>this._assistantElements.set({}))))}notify(e){this._uiActions.next(e)}dispose(){this._subs.unsubscribe()}}function w(e){return(0,s.zG)(e,r.fold(s.jv,(({prompts:e,review:t})=>{const i={prompts:S.Z.Step.anyClientCompleted(e),review:S.Z.Step.anyClientCompleted(t)};return Object.values(i).every(s.yR)})))}function _(){return(0,s.ls)(c.oA,u.U((e=>e.wordCount)),d.O(0),m.G(),v.R(((e,[t,i])=>(0,s.zG)(Math.abs(i-t),(t=>t<=2?e+t:e))),0),d.O(0),g.x())}},7754:(e,t,i)=>{i.d(t,{nP:()=>n,oq:()=>v});var n,r=i(27378),s=i(5114),o=i(9546),a=i(89894),l=i(77176),c=i(22232),u=i(5739),d=i(34217),m=i(83289),p=i(14047),h=i(21790),g=i(90653);!function(e){e.searchLabel="searchLabel",e.clickableSearchLabel="clickableSearchLabel",e.knowledgeHub="knowledgeHub"}(n||(n={}));const f=d.UI.Union.asOption(d.UI.Node.make((({notify:e,state:t})=>r.createElement(u.F.Fragment,null,t.pipe(l.U((t=>r.createElement(h.X,{key:"voiceButton",isMyVoice:t.selectedVoice===p.x.GeneratedTextVoice.user,onClick:e({kind:m.i.Kind.resultCardToggleGenericVoiceButtonClick,resultId:t.resultId,voice:t.selectedVoice})})))))))),v=d.UI.Knot.make(d.UI.Grid.make((({slots:e,notify:t,state:i})=>r.createElement(u.F.div,{className:y},i.pipe(l.U((e=>{switch(e.kind){case n.clickableSearchLabel:return r.createElement(g.$,{header:e.label,disabled:e.disabled,onClick:t({kind:m.i.Kind.resultCardHeaderClick,prompt:e.copiablePrompt})});case n.searchLabel:return r.createElement(g.L,{header:e.label,iconUrl:e.iconUrl,loading:!1});case n.knowledgeHub:return r.createElement(g.L,{header:"Knowledge Share content was used.",iconUrl:s.none,loading:!1});default:return(0,c.L0)(e)}}))),e.voiceButton))),{voiceButton:f}),y=a.ux.style({display:"grid",gridTemplateColumns:"1fr auto",gap:a.ux.rem(o.x)})},98884:(e,t,i)=>{i.d(t,{s:()=>a});var n=i(27378),r=i(13578),s=i(89894);const o=s.ux.style({whiteSpace:"break-spaces",overflowWrap:"anywhere",fontStyle:"normal",fontWeight:"normal",fontSize:s.ux.rem(.875),fontFeatureSettings:"'ss03' on",lineHeight:s.ux.rem(1.3125),color:r.XY.Content.Primary.Default}),a=({children:e})=>n.createElement("div",{className:o},e)},55243:(e,t,i)=>{i.d(t,{U:()=>_,r:()=>I});var n,r=i(27378),s=i(57050),o=i(62172),a=i(88392),l=i(36991),c=i(65223),u=i(89894),d=i(98884);!function(e){e.generatedText="generatedText",e.knowledgeHubTerm="knowledgeHubTerm",e.none="none"}(n||(n={}));const m=({insertOp:e})=>{const t=p(e.attributes),i=h(e.attributes);switch(t){case n.generatedText:return r.createElement(b,{style:i},e.insert);case n.knowledgeHubTerm:return r.createElement(x,{style:i},e.insert);case n.none:return y(e.attributes)?r.createElement(S,{style:i,href:e.attributes.link},e.insert):r.createElement(k,{style:i},e.insert);default:return(0,s.Rz)(t)}},p=e=>{switch(!0){case null==e?void 0:e[_.knowledgeHubTerm]:return n.knowledgeHubTerm;case null==e?void 0:e[_.generatedText]:return n.generatedText;default:return n.none}},h=e=>{const t={};return g(e)&&(t.fontWeight="bold"),f(e)&&(t.fontStyle="italic"),v(e)&&(t.textDecoration="underline"),y(e)&&(t.color=o.Blue60),t},g=e=>!0===(null==e?void 0:e.bold),f=e=>!0===(null==e?void 0:e.italic),v=e=>!0===(null==e?void 0:e.underline),y=e=>"string"==typeof(null==e?void 0:e.link),b=({children:e,style:t})=>r.createElement("span",{className:C,style:t},e),x=({children:e,style:t})=>r.createElement(c.u,{title:"from Knowledge Share"},r.createElement("span",{className:w,style:t},e)),k=({children:e,style:t})=>r.createElement("span",{style:t},e),S=({children:e,style:t,href:i})=>r.createElement("a",{style:t,href:i,target:"_blank",rel:"noreferrer"},e),C=u.ux.style({backgroundColor:o.Green0,borderRadius:u.ux.rem(a.fe)}),w=u.ux.style({backgroundColor:o.Blue0,borderRadius:u.ux.rem(a.fe)});var _;!function(e){e.generatedText="generatedText",e.knowledgeHubTerm="knowledgeHubTerm"}(_||(_={}));const I=({replacementDelta:e})=>r.createElement(d.s,null,e.map(((e,t)=>l.s.isInsert(e)?r.createElement(m,{key:t,insertOp:e}):null)))},90653:(e,t,i)=>{i.d(t,{$:()=>g,L:()=>v});var n=i(27378),r=i(5114),s=i(57050),o=i(9546),a=i(62172),l=i(13578),c=i(89894),u=i(12187),d=i(93986),m=i(83538),p=i(94689),h=i(87683);const g=({header:e,onClick:t,disabled:i})=>n.createElement(d.z.Tertiary,{compact:!0,disabled:i,onClick:t,className:C,name:"editResultPrompt",size:"small"},n.createElement("div",{className:w},n.createElement("div",Object.assign({className:I},(0,h.E)(e))),n.createElement("div",{className:k},"Edit")));var f;!function(e){e.FadeIn="FadeIn",e.FadeOut="FadeOut"}(f||(f={}));const v=({iconUrl:e,loading:t,header:i})=>{const[o,a]=n.useState({text:i,animationState:f.FadeIn});return n.useEffect((()=>{a((e=>Object.assign(Object.assign({},e),{animationState:e.text!==i?f.FadeOut:e.animationState})));const e=setTimeout((()=>a({text:i,animationState:f.FadeIn})),250);return()=>clearTimeout(e)}),[i]),n.createElement("div",{className:S},t?n.createElement(m.H,{className:_}):(0,s.zG)(e,r.fold(s.gn,(e=>n.createElement("img",{src:e,style:{width:c.ux.rem(1.25),height:c.ux.rem(1.25)}})))),n.createElement("span",Object.assign({"aria-live":"assertive"},(0,u.Sh)(I,o.animationState===f.FadeIn&&E,o.animationState===f.FadeOut&&A),(0,h.E)(o.text))))},y="editHeaderBtn",b="headerBtn",x=(0,p.dD)({height:c.ux.rem(1.5),lineHeight:c.ux.rem(1.125),padding:`0 ${c.ux.rem(o.F2)}`,margin:`0 ${c.ux.rem(-o.F2)}`,overflow:"hidden",$nest:{[`& .${y}`]:{opacity:0,pointerEvents:"none"},"&:focus, &:hover":{background:a.BlueGray0,[`& .${y}`]:{opacity:1,pointerEvents:"auto",color:l.XY.Content.Primary.Default}}}},b),k=y,S=c.ux.style({display:"flex",alignItems:"center",gap:c.ux.rem(o.x+o.yC),height:c.ux.rem(1.5),fontWeight:400,fontSize:c.ux.rem(.75),lineHeight:c.ux.rem(1.125),color:a.BlueGray60,overflow:"hidden"}),C=c.ux.joinClasses([b,c.ux.style(x)]),w=c.ux.style({display:"flex",justifyContent:"space-between",width:"100%",gap:c.ux.rem(o.F2)}),_=c.ux.style({marginBottom:`-${c.ux.rem(o.yC)}`,display:"inline-flex",alignItems:"center",justifyContent:"center"}),I=c.ux.style({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",transitionProperty:"opacity",transitionDuration:c.ux.seconds(.25)}),E=c.ux.style({opacity:1}),A=c.ux.style({opacity:0})},97645:(e,t,i)=>{i.d(t,{t:()=>U,A:()=>P});var n=i(64015),r=i(17889),s=i(57050),o=i(14601),a=i(32952),l=i(78674),c=i(85985),u=i(41398),d=i(2834),m=i(98403),p=i(16118),h=i(77176),g=i(60797),f=i(2844),v=i(66310),y=i(76974),b=i(93508),x=i(5114),k=i(83078),S=i(22232),C=i(38983),w=i(83289),_=i(819),I=i(7903),E=i(99877),A=i(87683),O=i(45701);function R(e){return e.split(/\s+/).map((e=>e.trim())).filter((e=>""!==e))}var U,T=i(63501),B=i(47150);!function(e){e.isActionsStore=function(e){return"actionsStore"===e.kind},e.isSearchResults=function(e){return"searchResults"===e.kind}}(U||(U={}));class P{constructor(e,t,i,k,w,E){var A,U,T,P;this._genAIAvailabilityService=t,this._sessionService=i,this._trackingService=k,this._focusPromptField=E,this._subs=new o.w,this._state=C.h.create(x.none),this._userTyped=new a.xQ,this._promptOrMenuFocused=new a.xQ,this._promptMenuActions=new a.xQ,this._promptMenuContainer=C.h.create(x.none),this._promptMenuContentContainer=x.none,this._cachedActionBricks=x.none,this.state=this._state.view(),this._subs.add(this._userTyped.pipe(l.b(150),c.h((()=>!w())),u.M(this._state.view((0,s.ls)(x.map((e=>e.filterPredicate)),x.getOrElse((()=>s.W8))))),d.b((([e,t])=>this._promptMenuActions.next({kind:"showSearchResults",search:e,filterPredicate:t})))).subscribe()),this._subs.add((A=this._promptMenuActions,U=this._sessionService.session,T=this._genAIAvailabilityService.availability,P=this._promptMenuContainer,f.aj([A.pipe(v.w((e=>"showSearchResults"===e.kind?U.view(I.z.toStarted).pipe(h.U((t=>(0,s.zG)(t,x.filter((()=>""!==e.search.trim())),x.chain((t=>{return i=t.activeContext.availableActions,o=e.search,(0,s.zG)(i,n.DZ((e=>(0,s.zG)(function(e,t,i){const r=R(e),o=[...R(t),...(0,s.zG)(i,n.tS((e=>R(e))))],a=r.map((()=>null));let l=0;for(const e of o){if(l>=r.length)break;e.toLowerCase().includes(r[l].toLowerCase())&&(a[l]=0,++l)}return a.includes(null)?x.none:x.some(a.map((e=>null!=e?e:0)).reduce(((e,t)=>e+t),0))}(o,e.searchLabel,e.searchTags),x.map((t=>({data:e,matchScore:t})))))),n.DY(O.contramap((({matchScore:e})=>e))(O.ordNumber)),n.UI((({data:e})=>e)),r.c2);var i,o})),x.map((t=>({kind:"searchResults",actions:t,filterPredicate:e.filterPredicate}))))))):"showActionsStore"===e.kind?U.view((0,s.ls)(B.F_,x.map((t=>({kind:"actionsStore",actions:t,filterPredicate:e.filterPredicate}))))):"close"===e.kind?y.of(x.none):(0,S.L0)(e))),b.O(x.none)),T,P]).pipe(h.U((([e,t,i])=>(0,s.zG)(e,x.filter((()=>!_._.isUnavailable(t))),x.map((e=>Object.assign(Object.assign({},e),{promptMenuContainer:i})))))))).subscribe(m.wW(this._state))),this._subs.add(this._promptOrMenuFocused.pipe(l.b(100),c.h((e=>!e))).subscribe((()=>this._promptMenuActions.next({kind:"close"})))),this._subs.add(this.state.pipe(p.G(),c.h((([e,t])=>x.isNone(e)&&x.isSome(t))),h.U((([e,t])=>t)),g.oA).subscribe((e=>{"actionsStore"===e.kind?this._trackingService.trackActionsOpenStore():"searchResults"===e.kind&&this._trackingService.trackPromptSearch()}))),this._subs.add(this._promptMenuActions.pipe(c.h((e=>"close"===e.kind))).subscribe((()=>this._invalidateActionBricks()))),this._subs.add(e.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case w.i.Kind.mount:return void(e.name===E.e.promptMenuContent?this._promptMenuContentContainer=x.some(e.element):e.name===E.e.promptInputAndMenuContainer&&this._promptMenuContainer.set(x.some(e.element)));case w.i.Kind.unmount:return void(e.name===E.e.promptInputAndMenuContainer&&this._promptMenuContainer.set(x.none));case w.i.Kind.promptMenuKeyPressArrowDown:return this._onPromptMenuKeyPressArrowDown();case w.i.Kind.promptMenuKeyPressArrowUp:return this._onPromptMenuKeyPressArrowUp();case w.i.Kind.promptFieldKeyPressArrowUp:return this._focusLastBrick();case w.i.Kind.promptFieldKeyPressArrowDown:return this._focusFirstBrick();case w.i.Kind.promptFieldTextChange:return this._invalidateActionBricks(),this._userTyped.next(e.text);case w.i.Kind.collapsePromptMenuButtonClick:case w.i.Kind.promptSubmitButtonClick:return this._promptMenuActions.next({kind:"close"});case w.i.Kind.promptFieldKeyPressEnter:return void(e.text.trim().length>0&&this._promptMenuActions.next({kind:"close"}));case w.i.Kind.actionBrickClick:return"allResults"===e.action.kind?this._promptMenuActions.next({kind:"showActionsStore",filterPredicate:e.action.filterPredicate}):this._promptMenuActions.next({kind:"close"});case w.i.Kind.promptFieldAndMenuFocusChange:return this._promptOrMenuFocused.next(e.focused);default:return}}_invalidateActionBricks(){this._cachedActionBricks=x.none}_getActionBricks(){return(0,s.zG)(this._cachedActionBricks,x.getOrElse((()=>{const e=(0,s.zG)(this._promptMenuContentContainer,x.fold((()=>[]),(e=>n.nI(Array.from(e.querySelectorAll(T.K)).filter(A.Re)))));return this._cachedActionBricks=x.some(e),e})))}_onPromptMenuKeyPressArrowDown(){var e;const t=this._getActionBricks(),i=(0,A.vY)((null===(e=x.toNullable(this._promptMenuContentContainer))||void 0===e?void 0:e.ownerDocument)||document);return(0,s.zG)(x.fromNullable(t.findIndex((e=>e===i))),k.bw((e=>{var i;e+1>=t.length?this._focusPromptField():null===(i=t[e+1])||void 0===i||i.focus()})))}_onPromptMenuKeyPressArrowUp(){var e;const t=this._getActionBricks(),i=(0,A.vY)((null===(e=x.toNullable(this._promptMenuContentContainer))||void 0===e?void 0:e.ownerDocument)||document);return(0,s.zG)(x.fromNullable(t.findIndex((e=>e===i))),k.bw((e=>{var i;e-1<0?this._focusPromptField():null===(i=t[e-1])||void 0===i||i.focus()})))}_focusFirstBrick(){var e;null===(e=this._getActionBricks()[0])||void 0===e||e.focus()}_focusLastBrick(){var e;const t=this._getActionBricks();null===(e=t[t.length-1])||void 0===e||e.focus()}}},3299:(e,t,i)=>{i.d(t,{s:()=>n});var n,r=i(5114);!function(e){let t;!function(e){e.create=e=>e}(t=e.Id||(e.Id={})),e.create=function(t){return Object.assign(Object.assign({},t),{id:e.Id.create(t.id),url:r.fromNullable(t.url),contextText:r.none})}}(n||(n={}))},28577:(e,t,i)=>{i.d(t,{v:()=>se,h:()=>ge});var n=i(64681),r=i(32952),s=i(5114),o=i(13853),a=i(57050),l=i(14601),c=i(2844),u=i(77176),d=i(2834),m=i(85321),p=i(12126),h=i(23063),g=i(49143),f=i(91224),v=i(76974),y=i(38194),b=i(19751),x=i(66310),k=i(93508),S=i(85985),C=i(16118),w=i(60797),_=i(24209),I=i(73975),E=i(38983),A=i(98370),O=i(2735);const R=I.MW({visibleAlerts:o.Eh(I.yv),emphasizedAlerts:o.Eh(I.yv)});class U{constructor(e){this._params=e,this._subs=new l.w,this._feedMounted=E.h.create(!1),this._subs.add((0,a.zG)(function(e,t){const i=e.pipe(y.B()),n=i.pipe(u.U(s.chain((e=>e.focusedItemId))),b.skipBy(s.getEq(I.yv))).pipe(x.w((()=>t.pipe(k.O(null)))));return c.aj([i,n]).pipe(u.U((([e,t])=>(0,a.zG)(e,s.map((({items:e,focusedItemId:i})=>({visibleAlerts:new Set(Array.from(e.values()).flatMap((e=>e.alertIds))),emphasizedAlerts:new Set(null!=t?t:(0,a.zG)(i,s.chain((t=>{var i;return s.fromNullable(null===(i=e.get(t))||void 0===i?void 0:i.alertIds)})),s.getOrElse((()=>[]))))})))))),b.skipBy(s.getEq(R)))}(c.aj([this._params.feedState,this._feedMounted]).pipe(u.U((([e,t])=>t?e:s.none))),this._params.resetEmphasizedAlerts),T,d.b((e=>{var t;return null===(t=this._params.logger)||void 0===t?void 0:t.debug("AlertVisibilityChanges",e)})),m.zg((({changes:e,isReset:t})=>t?p.D(this._params.alertService.setAlertsVisibility(e)).pipe(h.q(1),g.l(),f.K((t=>v.of({kind:"error",source:"revision",name:"setAlertsVisibilityFailed",data:{alertsVisibilityInfo:e,rawError:(0,O.N)(t)}})))):p.D(this._params.alertService.updateAlertsVisibility(e)).pipe(h.q(1),g.l(),f.K((t=>v.of({kind:"error",source:"revision",name:"updateAlertsVisibilityFailed",data:{alertsVisibilityInfo:e,rawError:(0,O.N)(t)}}))))))).subscribe((e=>this._params.monitoringService.notify((0,A.L)(e)))))}notifyFeedMount(){this._feedMounted.set(!0)}notifyFeedUnmount(){this._feedMounted.set(!1)}dispose(){this._subs.unsubscribe()}}function T(e){return e.pipe(b.skipBy(s.getEq(R)),y.B(),(e=>{const t=e.pipe(S.h(s.isNone),u.U((()=>({isReset:!0,changes:[]})))),i=e.pipe(k.O(s.none),C.G(),S.h((([e,t])=>s.isNone(e)&&s.isSome(t))),u.U((([e,t])=>t)),w.oA,u.U((e=>({isReset:!0,changes:(0,a.zG)(Array.from(e.visibleAlerts).filter((t=>!e.emphasizedAlerts.has(t))).map((e=>({alertId:e,visibility:"visible"}))).concat(Array.from(e.emphasizedAlerts).map((e=>({alertId:e,visibility:"emphasized"})))))})))),n=e.pipe(k.O(s.none),C.G(),S.h((([e,t])=>s.isNone(e)&&s.isSome(t))),x.w((([t,i])=>e.pipe(k.O(i),w.oA,C.G(),u.U((([e,t])=>{const i=o.e5(I.yv)(o.Lf(I.yv).concat(t.visibleAlerts,t.emphasizedAlerts))(o.Lf(I.yv).concat(e.visibleAlerts,e.emphasizedAlerts)),n=o.e5(I.yv)(e.emphasizedAlerts)(t.emphasizedAlerts),r=o.e5(I.yv)(t.emphasizedAlerts)(e.emphasizedAlerts),s=o.Lf(I.yv).concat(o.e5(I.yv)(e.visibleAlerts)(t.visibleAlerts),(0,a.zG)(r,o.hX((e=>t.visibleAlerts.has(e)))));return{isReset:!1,changes:[...Array.from(i).map((e=>({alertId:e,visibility:"hidden"}))),...Array.from(s).map((e=>({alertId:e,visibility:"visible"}))),...Array.from(n).map((e=>({alertId:e,visibility:"emphasized"})))]}}))))));return _.T(t,i,n)}))}var B=i(95195),P=i(45701),N=i(64015),z=i(48044),G=i(41398),j=i(67434),F=i(98403),D=i(2768),M=i(83078),V=i(92843),L=i(31442),H=i(21038),K=i(28811),$=i(63346);function W(e){return null!=e}var Z=i(44212),q=i(17160),Y=i(78929),X=i(26393),Q=i(24055),J=i(71078),ee=i(19125);class te{constructor(e=new $.W(te.name)){this._logger=e,this._alertIds=new Set}hasAlert(e){return this._alertIds.has(e)}processChanges(e){for(const t of e)(0,J.BG)(t)?this._alertIds.add(t.alertId):(0,J.nq)(t)?this._alertIds.delete(t.alertId):(0,J.Jg)(t)&&this._alertIds.clear();e.length>0&&this._logger.debug("Alert collection change",new Set(this._alertIds))}}class ie{constructor(e){var t;this._params=e,this._subs=new l.w,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new $.W(ie.name),this._sduiEvents=new r.xQ,this._alertCollection=new te(this._params.logger),this._sduiManager=new Y.G(this._sduiEvents.asObservable(),s.fromPredicate((e=>this._alertCollection.hasAlert(e)))),this.state=this._sduiManager.state,this.onAlertsRefEmpty=this._sduiManager.onAlertsRefEmpty,this.pushRemovedRoot=e=>this._sduiManager.pushRemovedRoot(e),this.pushRemovedAlerts=([e,t])=>this._sduiManager.pushRemovedAlerts([e,t]),this.pushSwitchView=e=>this._sduiManager.pushSwitchView(e),this._subs.add(this._processAlertChanges()),this._subs.add(this._processInboundSDUIMessages()),this._subs.add(this._sduiManagerLifecycleOnAlertsRefEmpty()),this._subs.add(this._sduiEvents.subscribe((e=>this._logger.debug("sdui event",e))))}dispose(){this._subs.unsubscribe(),this._sduiManager.dispose()}_processInboundSDUIMessages(){const e=e=>(0,a.zG)(e.sdui,X.ab.dslRootParser,B.bimap((t=>(this._params.monitoringService.notify((0,A.L)({kind:"error",source:"revision",name:"sduiDSLParseFailed",data:{sduiRootId:e.sduiRootId,rawError:(0,O.N)(t)}})),t)),a.yR),s.fromEither);return p.D(this._params.sduiService.sduiItemCollectionChanges).pipe(Z.u(),u.U((t=>(0,ee.tC)(t)?(0,a.zG)(t,e,s.map((e=>({kind:Q.e.SduiEventKind.Add,sdui:e,sduiRootId:Q.e.RawSduiItem.Id.create(t.sduiRootId),rev:0})))):(0,ee.Y9)(t)?(0,a.zG)(t,e,s.map((e=>({kind:Q.e.SduiEventKind.Update,sdui:e,sduiRootId:Q.e.RawSduiItem.Id.create(t.sduiRootId),rev:0})))):(0,ee.zi)(t)?s.some({kind:Q.e.SduiEventKind.Remove,sduiRootId:Q.e.RawSduiItem.Id.create(t.sduiRootId),rev:0}):(0,ee.H$)(t)?s.none:(0,a.Rz)(t))),w.oA).subscribe(this._sduiEvents)}_sduiManagerLifecycleOnAlertsRefEmpty(){return this._sduiManager.onAlertsRefEmpty.subscribe(this._params.onAlertsRefEmpty)}_processAlertChanges(){return p.D(this._params.alertService.alertCollectionChanges).pipe(q.e(0),Z.u()).subscribe((e=>{this._alertCollection.processChanges(e);const t=e.reduce(((e,t)=>{var i;return(0,J.nq)(t)&&"textChange"===t.reason&&e.set("textChange",(null!==(i=e.get("textChange"))&&void 0!==i?i:[]).concat(H.j.AlertId.from(t.alertId))),e}),new Map);e.length>0&&(this._sduiManager.notifyAlertsChanged(),t.size>0&&this._logger.debug("optimistically removing alerts",t),t.forEach(((e,t)=>this.pushRemovedAlerts([e,t]))))}))}}class ne{constructor(e){var t;this._params=e,this._sub=new l.w,this._disposed=new r.xQ,this._logger=null!==(t=this._params.logger)&&void 0!==t?t:new $.W(ne.name),this._sduiManagerProxy=new ie({sduiService:this._params.sduiService,alertService:this._params.alertService,monitoringService:this._params.monitoringService,onAlertsRefEmpty:e=>this._onSDUIManagerProxyAlertsRefEmpty(e)}),this._sduiFeedManager=new L._(this._sduiManagerProxy.state),this.feedState=this._getFeedState(),this._sduiFeedManagerLifecycleOnSelectedAlertIdChanged(),this._sduiFeedManagerLifecycleOnFeedEmpty(),this._sduiFeedManagerLifecycleOnFeedRemoved(),this._sduiFeedManagerLifecycleOnInitialFeedReady(),this._sub.add(this.feedState.subscribe((e=>this._logger.debug("feed state updated",e))))}_onSDUIManagerProxyAlertsRefEmpty(e){(0,a.zG)(this.feedState.get(),s.chain((e=>e.focusedItemId)),s.filter((t=>t===e.sduiRootId)),M.bw((()=>this._processActions(e.emptyStrongAlertRef.onEmpty,e.sduiId,e.emptyStrongAlertRef.alertIds,e.sduiId))))}_sduiFeedManagerLifecycleOnSelectedAlertIdChanged(){this._sub.add(p.D(this._params.alertService.selectedAlertId).pipe(S.h(W),u.U((e=>(0,a.zG)(this.feedState.get(),s.chain((t=>{var i;return s.fromNullable(null===(i=Array.from(t.items.values()).find((t=>t.alertIds.includes(H.j.AlertId.from(e)))))||void 0===i?void 0:i.id)}))))),w.oA,G.M(this.feedState.view(s.chain((e=>e.focusedItemId)))),S.h((([e,t])=>e!==s.toNullable(t)))).subscribe((([e])=>this._sduiFeedManager.focusCard(e))))}_sduiFeedManagerLifecycleOnFeedEmpty(){this._sub.add(this._sduiFeedManager.onFeedEmpty.subscribe((e=>{var t;"assistantFeed"===e.content.type?this._processActions(null!==(t=e.content.onEmpty)&&void 0!==t?t:[],e.id,[],e.id):this._params.monitoringService.notify((0,A.L)({kind:"warn",source:"revision",name:"sduiFeedOnEmptyDSLActionsSkipped",data:null}))})))}_sduiFeedManagerLifecycleOnFeedRemoved(){this._sub.add(this._sduiFeedManager.onFeedRemove.subscribe((e=>{"assistantFeed"===e.content.type?this._processActions(e.content.onRemove,e.id,[],e.id):this._params.monitoringService.notify((0,A.L)({kind:"warn",source:"revision",name:"sduiFeedOnRemoveDSLActionsSkipped",data:null}))})))}_getFeedState(){const e=E.h.create(s.none);return this._sub.add(this._sduiFeedManager.feed.pipe(j.R(((e,{feedId:t,feedOrd:i,cards:n,itemIdToSelect:r})=>{const o=new Set,l=(0,a.zG)(n,V.v.reduce(e.items,((e,t,i)=>(o.add(i),e)),((e,t,i)=>(0,a.zG)(e,z.ZQ(H.j.Item.Id.eq)(i.id,i))),((e,t,i)=>(0,a.zG)(e,z.ZQ(H.j.Item.Id.eq)(i,t))))),c=(0,a.zG)(Array.from(l.values()),N.DY(P.contramap((e=>e.content))(i)),N.UI((e=>e.id))),u=Array.from(o.keys()).reduce(((e,t)=>(0,a.zG)(e,z.EG(H.j.Item.Id.eq)(t))),l),d=c.filter((e=>!o.has(e)));return{feedId:t,items:u,orderedItemIds:d,focusedItemId:(0,a.zG)(r,s.fold((()=>(0,a.zG)(e.focusedItemId,s.fold((()=>d.length>0&&0===e.orderedItemIds.length?s.some(d[0]):s.none),(e=>o.has(e)?function(e,t,i){const n=t.findIndex((t=>t===e));if(n<0)return s.none;for(let e=n+1;e<t.length;++e)if(!i.has(t[e]))return s.some(t[e]);for(let e=n-1;e>=0;--e)if(!i.has(t[e]))return s.some(t[e]);return s.none}(e,c,o):s.some(e))))),(0,a.ls)(s.fromNullable,s.fold((()=>s.fromNullable(d[0])),(e=>d.includes(H.j.Item.Id.from(e))?s.some(H.j.Item.Id.from(e)):s.fromNullable(d[0]))))))}}),{feedId:H.j.Item.Id.from(""),items:new Map,orderedItemIds:[],focusedItemId:s.none}),u.U(s.some)).subscribe(F.wW(e))),e.view()}_sduiFeedManagerLifecycleOnInitialFeedReady(){var e;const t=null!==(e=this._params.sduiService.initialFeed)&&void 0!==e?e:{feedId:"default-feed",cardId:null};this._sub.add(this._sduiManagerProxy.state.pipe(S.h((e=>s.isSome(K.a.find((e=>e.id===t.feedId))(e))&&(!t.cardId||s.isSome(K.a.find((e=>e.id===t.cardId))(e))))),h.q(1)).subscribe((()=>{var e;return this._processActions([{type:"pushAssistantFeed",feedId:t.feedId,cardId:null!==(e=t.cardId)&&void 0!==e?e:void 0}],H.j.Item.Id.from("CheetahWeb:FeedService"),[],"CheetahWeb:FeedService")})))}_switchViewWithinFocusedItem(e){(0,a.zG)(this.feedState.get(),s.chain((e=>e.focusedItemId)),s.filter((t=>e.sduiRootId!==t)),M.bw((t=>this._sduiManagerProxy.pushSwitchView(Object.assign(Object.assign({},e),{sduiRootId:t})))))}_switchViewWithinCurrentFeed(e){(0,a.zG)(this._sduiFeedManager.currentFeed,s.filter((({feedId:t})=>e.sduiRootId!==t)),M.bw((({feedId:t})=>this._sduiManagerProxy.pushSwitchView(Object.assign(Object.assign({},e),{sduiRootId:t})))))}_processActions(e,t,i,n){this._logger.debug("_processActions()",{actions:e,itemId:t,alertIdsInScope:i,sourceId:n}),e.forEach((r=>{var o;switch(r.type){case"notify":{const e=null!==(o=r.sourceId)&&void 0!==o?o:n;p.D(this._params.capiService.user_action({userAction:r.userAction,componentId:e})()).pipe(h.q(1),D.R(this._disposed)).subscribe(a.Q1,(t=>this._params.monitoringService.notify((0,A.L)({kind:"error",source:"revision",name:"sduiUserActionFailed",data:{componentId:e,userAction:r.userAction,rawError:(0,O.N)(t)}}))));break}case"applyAlerts":{const e=i.map((e=>({alertId:e,alternativeIndex:r.alternativeIndex})));p.D(this._params.alertService.applyAlerts(e)).pipe(h.q(1),D.R(this._disposed)).subscribe(a.Q1,(t=>this._params.monitoringService.notify((0,A.L)({kind:"error",source:"revision",name:"applyAlertsFailed",data:{applyAlertsInfo:e,rawError:(0,O.N)(t)}}))));break}case"removeAlerts":{const t=e.some((e=>"applyAlerts"===e.type)),n=i.map((e=>({alertId:e,removalReason:t?"alertApplied":"other"})));p.D(this._params.alertService.removeAlerts(n)).pipe(h.q(1),D.R(this._disposed)).subscribe((()=>this._sduiManagerProxy.pushRemovedAlerts([i.map(H.j.AlertId.from),"removeAlerts"])),(e=>this._params.monitoringService.notify((0,A.L)({kind:"error",source:"revision",name:"removeAlertsFailed",data:{removeAlertsInfo:n,rawError:(0,O.N)(e)}}))));break}case"highlightAlert":return this._params.setEmphasizedAlerts([i[0]]);case"removeRoot":this._sduiManagerProxy.pushRemovedRoot([t,"removeRoot"]);break;case"pushAssistantFeed":(0,a.zG)(this._sduiFeedManager.pushFeed(H.j.Item.Id.from(r.feedId),r.cardId),B.bimap((e=>this._params.monitoringService.notify((0,A.L)({kind:"error",source:"revision",name:"sduiPushAssistantFeedFailed",data:{reason:e,feedId:r.feedId,cardId:r.cardId}}))),a.Q1));break;case"popAssistantFeed":this._sduiFeedManager.popFeed(s.fromNullable(r.fallbackFeed));break;case"focusAssistantCard":this._sduiFeedManager.focusCard(r.cardId);break;case"prevCard":(0,a.zG)(this.feedState.get(),s.chain((e=>(0,a.zG)(e.focusedItemId,s.map((t=>e.orderedItemIds.findIndex((e=>e===t)))),s.chain((t=>s.fromNullable(e.orderedItemIds[t-1])))))),M.bw((e=>this._sduiFeedManager.focusCard(e))));break;case"nextCard":(0,a.zG)(this.feedState.get(),s.chain((e=>(0,a.zG)(e.focusedItemId,s.map((t=>e.orderedItemIds.findIndex((e=>e===t)))),s.chain((t=>s.fromNullable(e.orderedItemIds[t+1])))))),M.bw((e=>this._sduiFeedManager.focusCard(e))));break;case"openLink":case"upgradeToPremium":case"nativeOpenAssistant":case"openCreateSnippetModal":case"newRevision":case"copyToClipboard":case"interactPopover":case"closePopover":case"hideHighlights":case"showHighlights":case"closeCard":case"openGrammarlyGo":case"openToneDetector":case"selectAlternative":case"stopApplyingAlerts":case"transition":case"openSettings":case"openFeedback":case"enablePlagiarismCheck":case"disablePlagiarismCheck":case"openLearnMore":break;case"switchView":{const e={where:r.where,selected:r.selected,sduiRootId:t};this._sduiManagerProxy.pushSwitchView(e),this._switchViewWithinFocusedItem(e),this._switchViewWithinCurrentFeed(e);break}default:(0,a.Rz)(r)}}))}processActions(e,t,i,n){this._processActions(e,t.id,null!=i?i:t.alertIds,null!=n?n:t.id)}onItemFocused(e,t){this._sduiFeedManager.notifyCardFocused(e.id),t&&this.processActions(t,e)}dispose(){this._disposed.next(void 0),this._sub.unsubscribe(),this._sduiManagerProxy.dispose(),this._sduiFeedManager.dispose()}}class re{constructor(e){this._feedService=e,this.state=this._feedService.feedState.view((0,a.ls)(s.fold((()=>0),(e=>e.items.size)),(e=>({suggestionsCount:e}))))}}var se,oe=i(80900),ae=i(40151),le=i(8125),ce=i(40330),ue=i(79880),de=i(85682);class me{constructor(e){this._params=e,this._subs=new l.w,this._transitions=E.h.create([]),this._internalFeedState=E.h.combine(this._params.feedService.feedState,this._transitions,((e,t)=>(0,a.zG)(e,s.chain((e=>(0,a.zG)(e.focusedItemId,s.chain((t=>s.fromNullable(e.items.get(t)))),s.map((i=>{const n=e.orderedItemIds.findIndex((e=>e===i.id)),r=0===n,o=n===e.orderedItemIds.length-1;return{kind:"nonEmptyState",focused:Object.assign(Object.assign({},i),{content:(0,a.zG)(pe(i.content,r,o),s.chain(he),s.getOrElse((()=>i.content)))}),transitions:t,isFirst:r,isLast:o}})))))))).view(),this._state=E.h.create({kind:"loadingState"}),this.state=this._state.view(),this._subs.add(this._handleNonEmptyState()),this._subs.add(this._resetLoadingAndSuccessStates()),this._subs.add(this._handleSuccessState())}processActions(e,t,i,n){e.find((e=>"prevCard"===e.type||"nextCard"===e.type))&&this._transitions.set(e.filter(ce.zx.Action.isTransitionAction)),this._params.feedService.processActions(e.map((e=>{switch(e.type){case"positionedClick":case"hoverStateChanged":return;default:return e}})).filter(le.$K),t,i.alertRefs,n)}onItemMount(e){var t;this._params.feedService.onItemFocused(e,null===(t=s.toUndefined(function(e){if("assistantCard"===e.content.type)return s.some(e.content);if("strongAlertRef"===e.content.type&&"assistantCard"===e.content.child.type)return s.some(e.content.child);return s.none}(e)))||void 0===t?void 0:t.onFocus)}onFeedMount(){const e=de.q.registerFeedUnmountHandler((()=>{de.q.unregisterFeedUnmountHandler(e),this._params.alertVisibilityManager.notifyFeedUnmount()}));this._params.alertVisibilityManager.notifyFeedMount()}onAnimationEnd(){this._transitions.set([])}dispose(){this._subs.unsubscribe()}_handleNonEmptyState(){return this._internalFeedState.pipe(k.O(s.none),C.G(),u.U((([e,t])=>(0,a.zG)(t,s.map((t=>Object.assign(Object.assign({},t),{prevFocusedItem:(0,a.zG)(e,s.map((e=>e.focused)))})))))),w.oA).subscribe(F.wW(this._state))}_handleSuccessState(){return this._internalFeedState.pipe(C.G(),S.h((([e,t])=>s.isSome(e)&&s.isNone(t))),u.U((()=>({kind:"successState"})))).subscribe(F.wW(this._state))}_resetLoadingAndSuccessStates(){return this._state.view("kind").pipe(x.w((e=>"loadingState"===e||"successState"===e?oe.H(1e3).pipe(u.U((()=>({kind:"emptyState"})))):ae.E))).subscribe(F.wW(this._state))}}function pe(e,t,i){return X.ab.map(e,(e=>{if("button"===e.type&&e.name.value===String(ue.MU.ButtonPrev)){const i=t?ue.BN.Disabled:ue.BN.Enabled;return Object.assign(Object.assign({},e),{state:i})}if("button"===e.type&&e.name.value===String(ue.MU.ButtonNext)){const t=i?ue.BN.Disabled:ue.BN.Enabled;return Object.assign(Object.assign({},e),{state:t})}return e}))}function he(e){return X.ab.map(e,(e=>"button"===e.type&&"learn-more"===e.name.value?Object.assign(Object.assign({},e),{state:ue.BN.Hidden}):e))}function ge(e){const t=new r.xQ,i=new ne({capiService:e.capiService,alertService:e.alertService,sduiService:e.sduiService,monitoringService:e.monitoringService,setEmphasizedAlerts:e=>t.next(new Set(e)),logger:e.logger}),n=new U({feedState:i.feedState,resetEmphasizedAlerts:t,alertService:e.alertService,monitoringService:e.monitoringService,logger:e.logger}),s=new me({feedService:i,alertVisibilityManager:n}),o=new re(i);return{revisionEngine:se.wrap({shortFormFeedViewModel:s,expandFeedButtonViewModel:o}),dispose:()=>{s.dispose(),n.dispose(),i.dispose()}}}!function(e){const t=n.k4();e.wrap=function(e){return t.wrap(e)},e.unwrap=function(e){return t.unwrap(e)}}(se||(se={}))},71078:(e,t,i)=>{function n(e){return"alertAdded"===e.kind}function r(e){return{kind:"alertAdded",alertId:e}}function s(e){return"alertRemoved"===e.kind}function o(e,t){return{kind:"alertRemoved",alertId:e,reason:t}}function a(e){return"alertCollectionReset"===e.kind}function l(){return{kind:"alertCollectionReset"}}i.d(t,{BG:()=>n,Jg:()=>a,Tm:()=>r,cT:()=>l,nq:()=>s,qQ:()=>o})},19125:(e,t,i)=>{function n(e){return"sduiItemAdd"===e.kind}function r(e,t){return{kind:"sduiItemAdd",sduiRootId:e,sdui:t}}function s(e){return"sduiItemUpdate"===e.kind}function o(e,t){return{kind:"sduiItemUpdate",sduiRootId:e,sdui:t}}function a(e){return"sduiItemRemove"===e.kind}function l(e){return{kind:"sduiItemRemove",sduiRootId:e}}function c(e){return"sduiItemCollectionReset"===e.kind}function u(){return{kind:"sduiItemCollectionReset"}}i.d(t,{FE:()=>o,H$:()=>c,K5:()=>r,Ul:()=>l,Y9:()=>s,Zw:()=>d,ex:()=>u,tC:()=>n,zi:()=>a});const d=(0,i(8125).Kg)(n,s,a,c)},85682:(e,t,i)=>{var n;i.d(t,{q:()=>n}),function(e){const t=[];e.notifyFeedUnmount=function(){t.forEach((e=>e()))},e.registerFeedUnmountHandler=function(e){return t.push(e),e},e.unregisterFeedUnmountHandler=function(e){const i=t.findIndex((t=>t===e));i>=0&&t.splice(i,1)}}(n||(n={}))},41866:(e,t,i)=>{function n(e){return{kind:"error",source:"skill",name:"getSkillsFailed",data:e}}function r(e){return{kind:"error",source:"skill",name:"initSkillFailed",data:e}}function s(e){return{kind:"error",source:"skill",name:"terminateSkillFailed",data:e}}i.d(t,{YC:()=>n,go:()=>s,iJ:()=>r})},31705:(e,t,i)=>{i.d(t,{x:()=>n});var n,r=i(80800),s=i(22232);!function(e){let t;!function(e){let t;!function(e){e.Rating="rating",e.Feedback="feedback",e.Completed="completed",e.Closed="closed"}(t=e.Type||(e.Type={})),e.isOpen=e=>e!==t.Closed,e.toCAPIStage=e=>{switch(e){case t.Rating:return r.v0.Survey.Data.OpenAnswerScoreSurvey.scoreStage;case t.Feedback:case t.Closed:case t.Completed:return r.v0.Survey.Data.OpenAnswerScoreSurvey.submitStage;default:(0,s.L0)(e)}}}(t=e.Stage||(e.Stage={}))}(n||(n={}))},36847:(e,t,i)=>{i.d(t,{p:()=>g});var n=i(5114),r=i(57050),s=i(80800),o=i(9922),a=i(85985),l=i(38983),c=i(33148),u=i(98370),d=i(14047),m=i(26320);function p(e){return{source:"userSurvey",kind:"error",name:"submitSurveyFailed",data:e}}var h=i(31705);class g{constructor(e){this._params=e,this._subs=new o.w.Keeper,this._activeSurvey=l.h.create(n.none),this.activeSurvey=this._activeSurvey.view(),this._init()}dispose(){this._subs.dispose()}submitSurveyResult(e){(0,m.t)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:e.rating,stage:h.x.Stage.toCAPIStage(e.stage),open_answer:n.getOrElse((()=>""))(e.openAnswer),detailed_placement:e.detailedPlacement,type:e.type}),void 0,void 0,(()=>this._params.monitoringService.notify((0,u.L)(p({surveyType:e.type,surveyPlacement:e.placement,surveyDetailedPlacement:e.detailedPlacement})))))}dismissSurvey(e){(0,m.t)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:"declined",stage:h.x.Stage.toCAPIStage(e.stage),detailed_placement:e.detailedPlacement,type:e.type}),void 0,void 0,(()=>this._params.monitoringService.notify((0,u.L)(p({surveyType:e.type,surveyPlacement:e.placement,surveyDetailedPlacement:e.detailedPlacement})))))}_init(){this._subs.push(this._params.capiService.relevantInboundCAPIMessages.pipe(a.h(c.JS.ShowSurvey.is)).subscribe((e=>this._handleShowSurvey(e))))}_handleShowSurvey(e){(0,r.zG)(e.survey,n.fromPredicate((e=>e.placement===s.v0.Survey.Data.BaseSurvey.Placement.ggo)),n.chain((e=>"open_answer_score"===e.type?n.some(e):n.none)),n.chain((e=>{var t;return"string"==typeof e.detailed_placement&&2===(null===(t=e.detailed_placement)||void 0===t?void 0:t.split(":").length)?n.some({survey:e,detailedPlacement:e.detailed_placement}):n.none})),n.chain((({survey:e,detailedPlacement:t})=>{const[i,r]=t.split(":"),s=Math.abs(Number.parseInt(r,10));return Number.isNaN(s)?n.none:n.some({survey:e,detailedPlacement:t,sessionId:i,resultId:d.x.Id.create(s)})})),n.fold((()=>this._params.monitoringService.notify((0,u.L)({source:"userSurvey",kind:"warn",name:"unexpectedSurveyFormatReceived",data:{surveyType:e.survey.type,surveyPlacement:e.survey.placement,surveyDetailedPlacement:e.survey.detailed_placement}}))),(({survey:e,detailedPlacement:t,resultId:i})=>{this._activeSurvey.modify((()=>n.some({placement:e.placement,title:e.title,detailedPlacement:t,type:s.v0.Survey.Data.OpenAnswerScoreSurvey.type,resultId:i,maxScore:e.max_score,boxText:n.fromNullable(e.box_text),ratingLabels:e.score_labels,acknowledgmentTitle:n.fromNullable(e.acknowledgment_title),acknowledgment:n.fromNullable(e.acknowledgment),skipOpenAnswerFrom:e.skip_open_answer_from,openAnswer:n.fromNullable({placeholder:e.open_answer.placeholder,maxLen:e.open_answer.max_len,minLen:n.fromNullable(e.open_answer.min_len)})})))})))}}},33305:(e,t,i)=>{i.d(t,{L:()=>n,b:()=>r});var n,r,s=i(73975),o=i(5114),a=i(64015),l=i(48044),c=i(13853),u=i(22232);!function(e){let t,i,n,r,d,m;!function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(t=e.Tone||(e.Tone={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(i=e.Style||(e.Style={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=s.yv}(t=e.Id||(e.Id={}))}(n=e.Role||(e.Role={})),function(e){function t(e){switch(e){case"american":return"American English";case"australian":return"Australian English";case"british":return"British English";case"canadian":return"Canadian English";case"indian":return"Indian English";default:return(0,u.L0)(e)}}function i(e){switch(e){case"american":return"https://assets.grammarly.com/emoji/v1/1f1fa-1f1f8.svg";case"australian":return"https://assets.grammarly.com/emoji/v1/1f1e6-1f1fa.svg";case"british":return"https://assets.grammarly.com/emoji/v1/1f1ec-1f1e7.svg";case"canadian":return"https://assets.grammarly.com/emoji/v1/1f1e8-1f1e6.svg";case"indian":return"https://assets.grammarly.com/emoji/v1/1f1ee-1f1f3.svg";default:return(0,u.L0)(e)}}let n;!function(e){e.create=function(e){return e},e.eq=s.yv}(n=e.Id||(e.Id={})),e.american={id:n.create("american"),label:t("american"),iconUrl:i("american")},e.australian={id:n.create("australian"),label:t("australian"),iconUrl:i("australian")},e.british={id:n.create("british"),label:t("british"),iconUrl:i("british")},e.canadian={id:n.create("canadian"),label:t("canadian"),iconUrl:i("canadian")},e.indian={id:n.create("indian"),label:t("indian"),iconUrl:i("indian")},e.all=function(){return[e.american,e.australian,e.british,e.canadian,e.indian]}}(r=e.Dialect||(e.Dialect={})),function(e){e.eq=s.MW({selectedStyle:i.Id.eq,selectedTonesPerStyle:l.Eh(i.Id.eq,c.Eh(t.Id.eq)),selectedRole:o.getEq(n.Id.eq),selectedDialect:r.Id.eq})}(d=e.Selections||(e.Selections={})),e.toLegacyVoiceProfile=function(e){return"legacyVoiceProfile"===e.kind?o.some(e):o.none},function(e){const t=s.MW({name:s.yv,state:s.yv}),i=s.MW({name:s.yv,tags:a.Eh(t)}),l=s.MW({name:s.yv,summary:s.yv,selected:s.vD,sections:a.Eh(i)}),c=a.Eh(l);e.eqByRoleDialectProfileAndIsEnabledByDefault=s.MW({profiles:c,selectedRole:o.getEq(n.Id.eq),selectedDialect:r.Id.eq,isEnabledByDefault:s.vD})}(m=e.NewSelections||(e.NewSelections={})),e.toNewVoiceProfile=function(e){return"newVoiceProfile"===e.kind?o.some(e):o.none}}(n||(n={})),function(e){e.createId=({tagName:e,sectionName:t,profileName:i})=>`${t}-${e}-${i}`}(r||(r={}))},21790:(e,t,i)=>{i.d(t,{X:()=>h});var n=i(27378),r=i(62172),s=i(9546),o=i(13578),a=i(88392),l=i(89894),c=i(12187),u=i(93986),d=i(17430),m=i(31278);const p=e=>n.createElement(m.a1,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),n.createElement("rect",{width:"16",height:"16",rx:"2"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.7072 5.41421L6.50008 12.6213L2.29297 8.41421L3.70718 7L6.50008 9.79289L12.293 4L13.7072 5.41421Z",fill:"white"})),h=({isMyVoice:e,isAnimated:t=!1,isBadge:i=!1,label:r="Use my style",inactiveLabel:s=r,onClick:o})=>n.createElement(u.z.Tertiary,{name:"toggleVoice",onClick:o,size:"small",role:"checkbox","aria-checked":e,compact:!0,style:g(e,t,i)},n.createElement(p,Object.assign({width:16,height:16},(0,c.Sh)(f,e?v:y))),e?r:s);function g(e,t,i){return{base:{display:"flex",alignItems:"center",height:l.ux.rem(1.25),lineHeight:l.ux.rem(1.125),color:e?r.Green80:r.BlueGray60,backgroundColor:e?r.Green0:r.BlueGray0,padding:`0 ${l.ux.rem(s.F2)}`,transition:t?l.ux.seconds(.25):void 0,transitionProperty:t?"color, background-color":void 0},icon:{marginRight:l.ux.rem(s.x),minWidth:l.ux.rem(1),minHeight:l.ux.rem(1)},hovered:{backgroundColor:e?l.ux.color(d.Z.Green10).mix(l.ux.color(d.Z.BlueGray5)).toRGBA().toString():r.BlueGray10,color:e?r.Green80:r.BlueGray60},active:{backgroundColor:e?l.ux.color(d.Z.Green10).mix(l.ux.color(d.Z.BlueGray5)).toRGBA().toString():r.BlueGray10,color:e?r.Green80:r.BlueGray60},disabled:i?{opacity:1,cursor:"default"}:void 0}}const f=l.ux.style({marginRight:l.ux.rem(s.x),minWidth:l.ux.rem(1),minHeight:l.ux.rem(1),borderWidth:l.ux.px(1),borderStyle:"solid",borderColor:o.XY.Content.Secondary.Default,borderRadius:l.ux.rem(a.xB),overflow:"hidden",transitionProperty:"background border-color",transitionDuration:l.ux.seconds(.25),$nest:{svg:{stroke:"none"}}}),v=l.ux.style({background:r.Green60,borderColor:r.Green60,$nest:{path:{fill:r.White}}}),y=l.ux.style({background:r.White,borderColor:o.XY.Content.Secondary.Default,$nest:{path:{fill:"transparent"}}})},71761:(e,t,i)=>{i.r(t),i.d(t,{ActionArg:()=>f,ActionArgDef:()=>v,ActionArgDefRadioButtonGroup:()=>k,ActionArgDefRadioButtonGroupHint:()=>x,ActionArgDefString:()=>b,ActionArgDefStringHint:()=>y,ActionDef:()=>C,ActionDefGeneratesTextType:()=>S,ActionInfo:()=>w,AvailableVoiceProfile:()=>A,AvailableVoiceProfileSection:()=>E,AvailableVoiceProfileSectionTag:()=>I,AvailableVoiceProfileSectionTagState:()=>_,AvailableVoiceProfiles:()=>O,ClientMessage:()=>c,ClientMessageImplementations:()=>Ae,Context:()=>R,DocumentOverview:()=>U,Error:()=>B,ErrorKind:()=>T,GeneratedText:()=>P,GenerationMode:()=>N,Message:()=>z,MessageAction:()=>F,MessageChunk:()=>q,MessageError:()=>$,MessageGetContext:()=>G,MessageGetHistory:()=>K,MessageGetUserState:()=>L,MessageInterrupt:()=>V,MessageInvalidateContext:()=>j,MessageResult:()=>X,MessageResultChangesSummary:()=>Y,MessageSearchReferences:()=>H,MessageSearchReferencesResult:()=>Z,MessageSetContext:()=>W,MessageSetHistory:()=>ne,MessageSetHistoryCard:()=>ie,MessageSetHistoryCardTitle:()=>J,MessageSetHistoryCardTitleAction:()=>te,MessageSetHistoryCardTitleUserPrompt:()=>ee,MessageSetUserState:()=>Q,MessageSetVoice:()=>D,MessageSetVoiceProfile:()=>M,Metadata:()=>re,OuterContext:()=>oe,OuterContextItem:()=>se,PreviousText:()=>ae,PreviousTextHistory:()=>ce,PreviousTextRegular:()=>le,PreviousTextWriterExpert:()=>ue,ProtocolMessage:()=>u,Reference:()=>de,ReferencePrivacyLevel:()=>me,ReferencePrivacyLevelPublic:()=>pe,ReferencePrivacyLevelRestricted:()=>he,Root:()=>g,ServerMessage:()=>d,ServerMessageImplementations:()=>Oe,SpecialView:()=>ge,SpecialViewAiUsageAlert:()=>fe,StartMessage:()=>m,StartedMessage:()=>p,Style:()=>ve,Text:()=>ye,TextLike:()=>h,TextRange:()=>be,Toggle:()=>xe,UrlReference:()=>ke,Usage:()=>Se,UserState:()=>we,UserStateSettings:()=>Ce,Voice:()=>_e,VoiceProfileSettings:()=>Ee,VoiceProfileSettingsMyVoiceIsEnabledByDefault:()=>Ie,encoderSchemable:()=>Ne,extend:()=>Pe,interpreter:()=>Be,make:()=>Te});var n=i(59312),r=i(50687),s=i(83257),o=i(18164),a=i(73915),l=i(57050),c=Te((function(e){return Ue(u(e),e.struct({}))(e)})),u=Te((function(e){return e.struct({id:e.number})})),d=Te((function(e){return Ue(u(e),e.struct({}))(e)})),m=Te((function(e){return e.intersect(e.partial({docIdIsTransient:e.boolean}))(e.struct({}))})),p=Te((function(e){return e.struct({cheetahState:we(e)})})),h=Te((function(e){return e.struct({plain:e.sensitiveString,delta:e.sensitiveDelta})})),g=Te((function(e){return z(e)})),f=Te((function(e){return e.struct({name:e.string,value:e.sensitiveString})})),v=Te((function(e){var t;return e.sum("valueType")(((t={}).string=b(e),t.radioButtonGroup=k(e),t))})),y=Te((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),b=Te((function(e){return e.intersect(e.partial({hint:y(e)}))(e.struct({valueType:e.literal("string"),label:e.string,name:e.string}))})),x=Te((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),k=Te((function(e){return e.intersect(e.partial({hint:x(e)}))(e.struct({valueType:e.literal("radioButtonGroup"),label:e.string,name:e.string,radioButtonGroupValues:e.readonly(e.array(e.string))}))})),S=Re(r.cX),C=Te((function(e){return e.intersect(e.partial({generatesTextType:S(e)}))(e.struct({id:e.string,iconUrl:e.string,group:e.string,label:e.string,searchTags:e.readonly(e.array(e.string)),args:e.readonly(e.array(v(e)))}))})),w=Te((function(e){return e.intersect(e.partial({useReferences:e.readonly(e.array(ke(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.struct({contextId:e.string,triggerContextId:e.string,actionId:e.string,args:e.readonly(e.array(f(e)))})))})),_=Re(r.ES),I=Te((function(e){return e.struct({name:e.string,state:_(e)})})),E=Te((function(e){return e.struct({name:e.string,tags:e.readonly(e.array(I(e)))})})),A=Te((function(e){return e.struct({name:e.string,summary:e.string,selected:e.boolean,sections:e.readonly(e.array(E(e)))})})),O=Te((function(e){return e.readonly(e.array(A(e)))})),R=Te((function(e){return e.intersect(e.partial({voiceProfileSettings:Ee(e)}))(e.intersect(e.partial({intent:e.sensitiveString}))(e.intersect(e.partial({documentOverview:U(e)}))(e.intersect(e.partial({specialView:ge(e)}))(e.intersect(e.partial({textScope:be(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({id:e.string,voice:_e(e),availableActions:e.readonly(e.array(C(e))),parentAction:w(e),stateBlob:e.string,promptAction:C(e),quickRewriteAction:C(e)})))))))})),U=Te((function(e){return e.struct({title:e.string,summary:e.string})})),T=Re(r.oS),B=Te((function(e){return e.struct({kind:T(e),title:e.string,text:e.string})})),P=Te((function(e){return Ue(h(e),e.struct({plain:e.sensitiveString,interrupted:e.boolean,renderDiff:e.boolean,delta:e.sensitiveDelta}))(e)})),N=Re(r.s2),z=Te((function(e){var t;return Ue(u(e),e.sum("action")(((t={})["cheetah:getContext"]=G(e),t["cheetah:invalidateContext"]=j(e),t["cheetah:action"]=F(e),t["cheetah:setVoice"]=D(e),t["cheetah:setVoiceProfile"]=M(e),t["cheetah:interrupt"]=V(e),t["cheetah:getUserState"]=L(e),t["cheetah:searchReferences"]=H(e),t["cheetah:getHistory"]=K(e),t["cheetah:error"]=$(e),t["cheetah:setContext"]=W(e),t["cheetah:searchReferencesResult"]=Z(e),t["cheetah:chunk"]=q(e),t["cheetah:result"]=X(e),t["cheetah:setUserState"]=Q(e),t["cheetah:setHistory"]=ne(e),t)))(e)})),G=Te((function(e){return Ue(c(e),e.intersect(e.partial({outerContext:oe(e)}))(e.intersect(e.partial({selectedRange:be(e)}))(e.intersect(e.partial({stateBlob:e.string}))(e.intersect(e.partial({previousText:ae(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:getContext"),rev:e.number,generationMode:N(e)})))))))(e)})),j=Te((function(e){return Ue(d(e),e.struct({action:e.literal("cheetah:invalidateContext")}))(e)})),F=Te((function(e){return Ue(c(e),e.intersect(e.partial({useReferences:e.readonly(e.array(ke(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.intersect(e.partial({previousText:ae(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:action"),rev:e.number,contextId:e.string,triggerContextId:e.string,actionId:e.string,stateBlob:e.string,args:e.readonly(e.array(f(e)))}))))))(e)})),D=Te((function(e){return Ue(c(e),e.struct({action:e.literal("cheetah:setVoice"),voice:_e(e)}))(e)})),M=Te((function(e){return Ue(c(e),e.intersect(e.partial({role:e.string}))(e.intersect(e.partial({isEnabledByDefault:e.boolean}))(e.intersect(e.partial({profiles:O(e)}))(e.struct({action:e.literal("cheetah:setVoiceProfile")})))))(e)})),V=Te((function(e){return Ue(c(e),e.struct({action:e.literal("cheetah:interrupt"),promptId:e.number}))(e)})),L=Te((function(e){return Ue(c(e),e.struct({action:e.literal("cheetah:getUserState")}))(e)})),H=Te((function(e){return Ue(c(e),e.intersect(e.partial({url:e.string}))(e.struct({action:e.literal("cheetah:searchReferences")})))(e)})),K=Te((function(e){return Ue(c(e),e.struct({action:e.literal("cheetah:getHistory")}))(e)})),$=Te((function(e){return Ue(d(e),e.struct({action:e.literal("cheetah:error"),promptId:e.number,error:B(e)}))(e)})),W=Te((function(e){return Ue(d(e),e.intersect(e.partial({progressMessage:e.string}))(e.struct({action:e.literal("cheetah:setContext"),promptId:e.number,context:R(e),usage:Se(e)})))(e)})),Z=Te((function(e){return Ue(d(e),e.struct({action:e.literal("cheetah:searchReferencesResult"),promptId:e.number,references:e.readonly(e.array(de(e)))}))(e)})),q=Te((function(e){return Ue(d(e),e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:chunk"),promptId:e.number,token:e.sensitiveString})))(e)})),Y=Te((function(e){return e.struct({title:e.string,description:e.readonly(e.array(e.string))})})),X=Te((function(e){return Ue(d(e),e.intersect(e.partial({metadata:re(e)}))(e.intersect(e.partial({context:R(e)}))(e.intersect(e.partial({error:B(e)}))(e.intersect(e.partial({text:P(e)}))(e.intersect(e.partial({withVoiceText:P(e)}))(e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.intersect(e.partial({references:e.readonly(e.array(de(e)))}))(e.intersect(e.partial({changesSummary:Y(e)}))(e.struct({action:e.literal("cheetah:result"),promptId:e.number,usage:Se(e)}))))))))))(e)})),Q=Te((function(e){return Ue(d(e),e.struct({action:e.literal("cheetah:setUserState"),state:we(e)}))(e)})),J=Te((function(e){var t;return e.sum("kind")(((t={}).userPrompt=ee(e),t.action=te(e),t))})),ee=Te((function(e){return e.struct({kind:e.literal("userPrompt"),text:e.string})})),te=Te((function(e){return e.struct({kind:e.literal("action"),iconUrl:e.string,label:e.string})})),ie=Te((function(e){return e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.struct({id:e.string,text:ye(e),withVoiceText:ye(e),title:J(e),references:e.readonly(e.array(de(e)))}))})),ne=Te((function(e){return Ue(d(e),e.struct({action:e.literal("cheetah:setHistory"),cards:e.readonly(e.array(ie(e)))}))(e)})),re=Te((function(e){return e.any})),se=Te((function(e){return e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.struct({text:e.sensitiveString})))})),oe=Te((function(e){return e.intersect(e.partial({pageIdHash:e.string}))(e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.intersect(e.partial({items:e.readonly(e.array(se(e)))}))(e.struct({})))))})),ae=Te((function(e){var t;return e.sum("kind")(((t={}).regular=le(e),t.history=ce(e),t.writerExpert=ue(e),t))})),le=Te((function(e){return e.struct({kind:e.literal("regular"),text:e.string})})),ce=Te((function(e){return e.struct({kind:e.literal("history"),text:e.string})})),ue=Te((function(e){return e.struct({kind:e.literal("writerExpert"),text:e.string,suggestionId:e.string,pname:e.string})})),de=Te((function(e){return e.intersect(e.partial({url:e.string}))(e.struct({id:e.string,privacyLevel:me(e),title:e.string,iconUrl:e.string}))})),me=Te((function(e){var t;return e.sum("kind")(((t={}).public=pe(e),t.restricted=he(e),t))})),pe=Te((function(e){return e.struct({kind:e.literal("public")})})),he=Te((function(e){return e.struct({kind:e.literal("restricted")})})),ge=Te((function(e){var t;return e.sum("kind")(((t={}).aiUsageAlert=fe(e),t))})),fe=Te((function(e){return e.struct({kind:e.literal("aiUsageAlert")})})),ve=Te((function(e){return e.struct({button:xe(e),tones:e.readonly(e.array(xe(e))),maxTones:e.number})})),ye=Te((function(e){return Ue(h(e),e.struct({}))(e)})),be=Te((function(e){return e.struct({start:e.number,end:e.number})})),xe=Te((function(e){return e.struct({iconUrl:e.string,label:e.string,description:e.string})})),ke=Te((function(e){return e.struct({url:e.string,referenceId:e.string})})),Se=Te((function(e){return e.struct({promptsRemaining:e.number,promptsAllocated:e.number,refillDate:e.string})})),Ce=Te((function(e){return e.struct({inlineQuickReplyEnabled:e.boolean,inlineRewriteEnabled:e.boolean})})),we=Te((function(e){return e.intersect(e.partial({historyItems:e.number}))(e.struct({settings:Ce(e),usage:Se(e)}))})),_e=Te((function(e){return e.intersect(e.partial({styles:e.readonly(e.array(ve(e)))}))(e.intersect(e.partial({selectedRole:e.string}))(e.intersect(e.partial({roles:e.readonly(e.array(e.string))}))(e.struct({selectedStyle:e.string,selectedTones:e.readonly(e.array(e.string)),needSetup:e.boolean}))))})),Ie=Te((function(e){return e.struct({state:e.boolean,label:e.string})})),Ee=Te((function(e){return e.struct({userName:e.string,myVoiceIsEnabledByDefault:Ie(e),title:e.string,subTitle:e.string,profiles:O(e)})})),Ae=Te((function(e){var t;return e.sum("action")(((t={})["cheetah:getContext"]=G(e),t["cheetah:action"]=F(e),t["cheetah:setVoice"]=D(e),t["cheetah:setVoiceProfile"]=M(e),t["cheetah:interrupt"]=V(e),t["cheetah:getUserState"]=L(e),t["cheetah:searchReferences"]=H(e),t["cheetah:getHistory"]=K(e),t))})),Oe=Te((function(e){var t;return e.sum("action")(((t={})["cheetah:invalidateContext"]=j(e),t["cheetah:error"]=$(e),t["cheetah:setContext"]=W(e),t["cheetah:searchReferencesResult"]=Z(e),t["cheetah:chunk"]=q(e),t["cheetah:result"]=X(e),t["cheetah:setUserState"]=Q(e),t["cheetah:setHistory"]=ne(e),t))}));function Re(e){var t=Object.keys(e).map((function(t){return e[t]})),i=t[0],r=t.slice(1);return Te((function(e){return e.literal.apply(e,(0,n.__spreadArray)([i],r,!1))}))}function Ue(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Te((function(t){return e.reduce((function(e,i){return t.intersect(i)(e)}))}))}function Te(e){return o.H(e)}var Be=(0,l.MZ)(a.n);function Pe(e){return function(t){return(0,n.__assign)((0,n.__assign)({},e),t)}}var Ne={URI:s.ov,literal:function(){return s.id()},string:s.id(),number:s.id(),boolean:s.id(),nullable:s.AG,type:s.dt,struct:s.n_,partial:s.r$,record:s.IM,array:s.IX,tuple:s.bc,intersect:s.wf,sum:s.Sm,lazy:function(e,t){return s.Vo(t)},readonly:s.OT}},50687:(e,t,i)=>{var n,r,s,o;i.d(t,{ES:()=>r,cX:()=>n,oS:()=>s,s2:()=>o}),function(e){e.Insertable="insertable",e.NonInsertable="non_insertable"}(n||(n={})),function(e){e.Active="active",e.Snoozed="snoozed"}(r||(r={})),function(e){e.Generic="generic",e.Overflow="overflow",e.PromptsLimitExceeded="promptsLimitExceeded",e.SensitiveContent="sensitiveContent",e.ServerOverloaded="serverOverloaded",e.UnsupportedLanguage="unsupportedLanguage"}(s||(s={})),function(e){e.Ideation="ideation",e.PushRewrite="pushRewrite",e.QuickReply="quickReply",e.QuickRewrite="quickRewrite",e.Rewrite="rewrite"}(o||(o={}))},45930:(e,t,i)=>{i.d(t,{X:()=>r});var n=i(22232),r=function(){function e(e,t,i){void 0===t&&(t=0),void 0===i&&(i=!0),this._capacity=e,this._start=t,this._allowOverflow=i,this._nextId=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._nextId},enumerable:!1,configurable:!0}),e.prototype.newId=function(){var e=this._nextId;if(e>this._capacity){if(!this._allowOverflow)throw new n.ej("ids limit reached: "+this._capacity);this._nextId=e=0}return this._nextId++,e},e.prototype.reset=function(){this._nextId=this._start},e}()},56377:(e,t,i)=>{i.d(t,{L:()=>l});var n,r=i(59312),s=i(27378),o=i(12187),a=i(89894),l=function(e){var t=e.double,i=e.triple,n=e.small;return s.createElement("div",(0,r.__assign)({},(0,o.Sh)(d,!0===t&&p,!0===i&&g,!0===n&&f)))},c=.875,u="spacer",d=a.ux.joinClasses([u,a.ux.style({margin:0,minHeight:a.ux.rem(c),maxHeight:a.ux.rem(1),width:a.ux.percent(100),height:a.ux.rem(1)})]),m="spacerDouble",p=a.ux.joinClasses([m,a.ux.style({minHeight:a.ux.rem(1.75),maxHeight:a.ux.rem(2),height:a.ux.rem(2)})]),h="spacerTriple",g=a.ux.joinClasses([h,a.ux.style({minHeight:a.ux.rem(2.625),maxHeight:a.ux.rem(3),height:a.ux.rem(3)})]),f=a.ux.style({$nest:(n={},n["&.".concat(u)]={minHeight:a.ux.rem(.4375),maxHeight:a.ux.rem(.5),height:a.ux.rem(.5)},n["&.".concat(m)]={minHeight:a.ux.rem(c),maxHeight:a.ux.rem(1),height:a.ux.rem(1)},n["&.".concat(h)]={minHeight:a.ux.rem(1.3125),maxHeight:a.ux.rem(1.5),height:a.ux.rem(1.5)},n)})},24782:(e,t)=>{t.byteLength=function(e){var t=l(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,s=l(e),o=s[0],a=s[1],c=new r(function(e,t,i){return 3*(t+i)/4-i}(0,o,a)),u=0,d=a>0?o-4:o;for(i=0;i<d;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===a&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,c[u++]=255&t);1===a&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s=[],o=16383,a=0,l=n-r;a<l;a+=o)s.push(c(e,a,a+o>l?l:a+o));1===r?(t=e[n-1],s.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],s.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return s.join("")};for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)i[o]=s[o],n[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function c(e,t,n){for(var r,s,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},30816:(e,t,i)=>{var n=i(24782),r=i(78898),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.INSPECT_MAX_BYTES=50;var o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,i){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return c(e,t,i)}function c(e,t,i){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var i=0|g(e,t),n=a(i),r=n.write(e,t);r!==i&&(n=n.slice(0,r));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(M(e,Uint8Array)){var t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(M(e,ArrayBuffer)||e&&M(e.buffer,ArrayBuffer))return p(e,t,i);if("undefined"!=typeof SharedArrayBuffer&&(M(e,SharedArrayBuffer)||e&&M(e.buffer,SharedArrayBuffer)))return p(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,i);var r=function(e){if(l.isBuffer(e)){var t=0|h(e.length),i=a(t);return 0===i.length||e.copy(i,0,0,t),i}if(void 0!==e.length)return"number"!=typeof e.length||V(e.length)?a(0):m(e);if("Buffer"===e.type&&Array.isArray(e.data))return m(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return u(e),a(e<0?0:0|h(e))}function m(e){for(var t=e.length<0?0:0|h(e.length),i=a(t),n=0;n<t;n+=1)i[n]=255&e[n];return i}function p(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),Object.setPrototypeOf(n,l.prototype),n}function h(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function g(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||M(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return F(e).length;default:if(r)return n?-1:j(e).length;t=(""+t).toLowerCase(),r=!0}}function f(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,i);case"utf8":case"utf-8":return I(this,t,i);case"ascii":return A(this,t,i);case"latin1":case"binary":return O(this,t,i);case"base64":return _(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function y(e,t,i,n,r){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),V(i=+i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:b(e,t,i,n,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):b(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,i,n,r){var s,o=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,i/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var u=-1;for(s=i;s<a;s++)if(c(e,s)===c(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(i+l>a&&(i=a-l),s=i;s>=0;s--){for(var d=!0,m=0;m<l;m++)if(c(e,s+m)!==c(t,m)){d=!1;break}if(d)return s}return-1}function x(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;var s=t.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(t.substr(2*o,2),16);if(V(a))return o;e[i+o]=a}return o}function k(e,t,i,n){return D(j(t,e.length-i),e,i,n)}function S(e,t,i,n){return D(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function C(e,t,i,n){return D(F(t),e,i,n)}function w(e,t,i,n){return D(function(e,t){for(var i,n,r,s=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(i=e.charCodeAt(o))>>8,r=i%256,s.push(r),s.push(n);return s}(t,e.length-i),e,i,n)}function _(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function I(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var s,o,a,l,c=e[r],u=null,d=c>239?4:c>223?3:c>191?2:1;if(r+d<=i)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(s=e[r+1]))&&(l=(31&c)<<6|63&s)>127&&(u=l);break;case 3:s=e[r+1],o=e[r+2],128==(192&s)&&128==(192&o)&&(l=(15&c)<<12|(63&s)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:s=e[r+1],o=e[r+2],a=e[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(l=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),r+=d}return function(e){var t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);var i="",n=0;for(;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=E));return i}(n)}l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,i){return c(e,t,i)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,i){return function(e,t,i){return u(e),e<=0?a(e):void 0!==t?"string"==typeof i?a(e).fill(t,i):a(e).fill(t):a(e)}(e,t,i)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(M(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),M(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,r=0,s=Math.min(i,n);r<s;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=l.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var s=e[i];if(M(s,Uint8Array))r+s.length>n.length?l.from(s).copy(n,r):Uint8Array.prototype.set.call(n,s,r);else{if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r)}r+=s.length}return n},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):f.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(e,t,i,n,r){if(M(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return-1;if(t>=i)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(n>>>=0),o=(i>>>=0)-(t>>>=0),a=Math.min(s,o),c=this.slice(n,r),u=e.slice(t,i),d=0;d<a;++d)if(c[d]!==u[d]){s=c[d],o=u[d];break}return s<o?-1:o<s?1:0},l.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},l.prototype.indexOf=function(e,t,i){return y(this,e,t,i,!0)},l.prototype.lastIndexOf=function(e,t,i){return y(this,e,t,i,!1)},l.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return x(this,e,t,i);case"utf8":case"utf-8":return k(this,e,t,i);case"ascii":case"latin1":case"binary":return S(this,e,t,i);case"base64":return C(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function A(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function O(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function R(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var r="",s=t;s<i;++s)r+=L[e[s]];return r}function U(e,t,i){for(var n=e.slice(t,i),r="",s=0;s<n.length-1;s+=2)r+=String.fromCharCode(n[s]+256*n[s+1]);return r}function T(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,i,n,r,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function P(e,t,i,n,r,s){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function N(e,t,i,n,s){return t=+t,i>>>=0,s||P(e,0,i,4),r.write(e,t,i,n,23,4),i+4}function z(e,t,i,n,s){return t=+t,i>>>=0,s||P(e,0,i,8),r.write(e,t,i,n,52,8),i+8}l.prototype.slice=function(e,t){var i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||T(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||T(e,t,this.length);for(var n=this[e+--t],r=1;t>0&&(r*=256);)n+=this[e+--t]*r;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||T(e,t,this.length);for(var n=this[e],r=1,s=0;++s<t&&(r*=256);)n+=this[e+s]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||T(e,t,this.length);for(var n=t,r=1,s=this[e+--n];n>0&&(r*=256);)s+=this[e+--n]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,i,n){(e=+e,t>>>=0,i>>>=0,n)||B(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,s=0;for(this[t]=255&e;++s<i&&(r*=256);)this[t+s]=e/r&255;return t+i},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,i,n){(e=+e,t>>>=0,i>>>=0,n)||B(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+i},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);B(this,e,t,i,r-1,-r)}var s=0,o=1,a=0;for(this[t]=255&e;++s<i&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i},l.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);B(this,e,t,i,r-1,-r)}var s=i-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i},l.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,i){return N(this,e,t,!0,i)},l.prototype.writeFloatBE=function(e,t,i){return N(this,e,t,!1,i)},l.prototype.writeDoubleLE=function(e,t,i){return z(this,e,t,!0,i)},l.prototype.writeDoubleBE=function(e,t,i){return z(this,e,t,!1,i)},l.prototype.copy=function(e,t,i,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r=n-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),r},l.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var r=e.charCodeAt(0);("utf8"===n&&r<128||"latin1"===n)&&(e=r)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var s;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{var o=l.isBuffer(e)?e:l.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var G=/[^+/0-9A-Za-z-_]/g;function j(e,t){var i;t=t||1/0;for(var n=e.length,r=null,s=[],o=0;o<n;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}r=i;continue}if(i<56320){(t-=3)>-1&&s.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function F(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function D(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}function M(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function V(e){return e!=e}var L=function(){for(var e="0123456789abcdef",t=new Array(256),i=0;i<16;++i)for(var n=16*i,r=0;r<16;++r)t[n+r]=e[i]+e[r];return t}()},13853:(e,t,i)=>{i.d(t,{$T:()=>_,AO:()=>a,DZ:()=>R,Eh:()=>l,G:()=>c,G0:()=>f,KX:()=>p,Lf:()=>x,Lx:()=>C,Od:()=>I,UI:()=>u,ZN:()=>s,e5:()=>b,hX:()=>h,jV:()=>v,nI:()=>E,oA:()=>A,oP:()=>k,ri:()=>w,t9:()=>g,tS:()=>m,tV:()=>y,u4:()=>S,xu:()=>O,yW:()=>d});var n=i(73975),r=i(57050);function s(e){return{show:function(t){var i="";return t.forEach((function(t){i+=e.show(t)+", "})),""!==i&&(i=i.substring(0,i.length-2)),"new Set(["+i+"])"}}}var o=new Set;function a(e){return function(t){var i=[];return t.forEach((function(e){return i.push(e)})),i.sort(e.compare)}}function l(e){var t=p(e);return(0,n.f7)((function(e,i){return t(e,i)&&t(i,e)}))}function c(e){return function(t){for(var i,n=t.values(),r=!1;!r&&!(i=n.next()).done;)r=e(i.value);return r}}function u(e){var t=g(e);return function(e){return function(i){var n=new Set;return i.forEach((function(i){var r=e(i);t(r,n)||n.add(r)})),n}}}function d(e){return(0,r.ff)(c((0,r.ff)(e)))}function m(e){var t=g(e);return function(e){return function(i){var n=new Set;return i.forEach((function(i){e(i).forEach((function(e){t(e,n)||n.add(e)}))})),n}}}function p(e){var t=g(e);return function(i,n){if(void 0===n){var r=p(e);return function(e){return r(e,i)}}return d((function(e){return t(e,n)}))(i)}}function h(e){return function(t){for(var i,n=t.values(),r=new Set;!(i=n.next()).done;){var s=i.value;e(s)&&r.add(s)}return r}}function g(e){return function(t,i){if(void 0===i){var n=g(e);return function(e){return n(t,e)}}for(var r,s=i.values(),o=!1;!o&&!(r=s.next()).done;)o=e.equals(t,r.value);return o}}function f(e){var t=g(e);return function(i,n){if(void 0===n){var r=f(e);return function(e){return r(i,e)}}if(i===o)return n;if(n===o)return i;var s=new Set(i);return n.forEach((function(e){t(e,s)||s.add(e)})),s}}function v(e){var t=g(e);return function(i,n){if(void 0===n){var r=v(e);return function(e){return r(e,i)}}if(i===o||n===o)return o;var s=new Set;return i.forEach((function(e){t(e,n)&&s.add(e)})),s}}function y(e,t){return function(i){return function(n){for(var r,s=n.values(),o=new Set,a=new Set,l=g(e),c=g(t);!(r=s.next()).done;){var u=i(r.value);switch(u._tag){case"Left":l(u.left,o)||o.add(u.left);break;case"Right":c(u.right,a)||a.add(u.right)}}return{left:o,right:a}}}}function b(e){var t=g(e);return function(i,n){if(void 0===n){var r=b(e);return function(e){return r(e,i)}}return h((function(e){return!t(e,n)}))(i)}}function x(e){return{concat:f(e),empty:o}}function k(e){return{concat:v(e)}}function S(e){var t=a(e);return function(e,i){return function(n){return t(n).reduce(i,e)}}}function C(e,t){var i=a(e);return function(e){return function(n){return i(n).reduce((function(i,n){return t.concat(i,e(n))}),t.empty)}}}function w(e){return new Set([e])}function _(e){var t=g(e);return function(e){return function(i){if(t(e)(i))return i;var n=new Set(i);return n.add(e),n}}}function I(e){return function(t){return function(i){return h((function(i){return!e.equals(t,i)}))(i)}}}function E(e){return function(t){for(var i=t.length,n=new Set,r=g(e),s=0;s<i;s++){var o=t[s];r(o,n)||n.add(o)}return n}}function A(e){return R(e)(r.yR)}function O(e,t){return function(i){var n=g(e),r=g(t),s=new Set,o=new Set;return i.forEach((function(e){switch(e._tag){case"Left":n(e.left,s)||s.add(e.left);break;case"Right":r(e.right,o)||o.add(e.right)}})),{left:s,right:o}}}function R(e){var t=g(e);return function(e){return function(i){var n=new Set;return i.forEach((function(i){var r=e(i);"Some"!==r._tag||t(r.value,n)||n.add(r.value)})),n}}}},78898:(e,t)=>{t.read=function(e,t,i,n,r){var s,o,a=8*r-n-1,l=(1<<a)-1,c=l>>1,u=-7,d=i?r-1:0,m=i?-1:1,p=e[t+d];for(d+=m,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+e[t+d],d+=m,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+d],d+=m,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=c}return(p?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,i,n,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,d=u>>1,m=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?m/l:m*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(t*l-1)*Math.pow(2,r),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;e[i+p]=255&a,p+=h,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[i+p]=255&o,p+=h,o/=256,c-=8);e[i+p-h]|=128*g}}}]);