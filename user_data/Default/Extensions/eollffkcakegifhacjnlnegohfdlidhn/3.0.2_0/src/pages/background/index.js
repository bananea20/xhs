async function a(){let s=(await chrome.storage.local.get("clientId")).clientId;return s||(s=self.crypto.randomUUID(),await chrome.storage.local.set({clientId:s})),s}const c=30;async function r(){let{sessionData:e}=await chrome.storage.session.get("sessionData");const s=Date.now();return e&&e.timestamp&&((s-e.timestamp)/6e4>c?e=null:(e.timestamp=s,await chrome.storage.session.set({sessionData:e}))),e||(e={session_id:s.toString(),timestamp:s.toString()},await chrome.storage.session.set({sessionData:e})),e.session_id}const m="https://www.google-analytics.com/mp/collect",d="G-67EVHBE3DC",l="bXxiMdAmTDOHvtvFKxxjRg",g=100;async function u(e){var s;try{const t=await a(),i=await r(),o=(s=e==null?void 0:e.params)!=null?s:{},n={...e,params:{...o,client_id:t,session_id:i,engagement_time_msec:g}};await fetch(`${m}?measurement_id=${d}&api_secret=${l}`,{method:"POST",body:JSON.stringify({client_id:t,events:[n]})}),console.log("Track GA:",t.substr(0,4),n)}catch(t){console.error(t)}}console.log("background loaded");chrome.runtime.onMessage.addListener((e,s,t)=>{e.gaEvent&&(u(e.gaEvent),t({message:"Message received"}))});
