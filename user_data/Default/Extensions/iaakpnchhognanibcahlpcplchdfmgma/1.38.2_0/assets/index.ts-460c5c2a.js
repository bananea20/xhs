import{B as t}from"./browser-polyfill-5e752e65.js";import{p as o,q as l,A as p}from"./user-config-09eb902a.js";const d="https://plausible.midway.run";async function m(a,n){await o(`${d}/api/event`,{method:"POST",body:{domain:"chathub.gg",name:a,url:location.href,props:n},mode:"no-cors"})}async function h(){const{source:a}=await o("https://chathub.gg/api/user/source",{credentials:"include"});m("install",{source:a,language:navigator.language})}async function r(){const a=await t.tabs.query({}),n=t.runtime.getURL("app.html"),e=a.find(u=>{var i;return(i=u.url)==null?void 0:i.startsWith(n)});if(e){await t.tabs.update(e.id,{active:!0});return}const{startupPage:s}=await l(),c=s===p?"":`#/chat/${s}`;await t.tabs.create({url:`app.html${c}`})}t.action.onClicked.addListener(()=>{r()});t.runtime.onInstalled.addListener(a=>{a.reason==="install"&&(t.tabs.create({url:"app.html#/setting"}),h())});t.commands.onCommand.addListener(async a=>{a==="open-app"&&r()});
