"use strict";(self.webpackChunkbrowser_extension=self.webpackChunkbrowser_extension||[]).push([[704],{40048:(e,t,n)=>{n.d(t,{$o:()=>c});n(71372),n(43108),n(36728);var s=n(88120),a=n(99853),l=n(41215),r=n(50251),i=n.n(r),o=n(74875);const c=!0,u={id:a.gu.BaiDu,name:"百度文字识别",points:!0,secretKeys:{get:()=>i().storage.local.get({baiDuOCRKey:[]}).then((({baiDuOCRKey:e})=>(Array.isArray(e)?e:[e]).map((e=>({id:e.key,key:e.secret}))))),set:e=>i().storage.local.set({baiDuOCRKey:e.map((e=>({key:e.id,secret:e.key})))}),isComplete:e=>(0,o.dz)(e,["id"])},pointsEnable:{get:()=>i().storage.local.get({bdOcrPoints:c}).then((({bdOcrPoints:e})=>e)),set:e=>i().storage.local.set({bdOcrPoints:e})}};class d extends s.E{constructor(){super(u,!0)}callBySecretKey(e,t){return new l.w(e).ocr(t.image)}transform(e){if(!e.paragraphs_result)throw new Error("百度文字识别服务配置有误，请确认你领取过免费资源包，且密钥填写无误。");return e.paragraphs_result.reduce(((t,{words_result_idx:n})=>(t.push(n.reduce(((t,n)=>t+e.words_result[n].words),"")),t)),[]).join("\n")}}new d},72481:(e,t,n)=>{n.d(t,{Lx:()=>m,Xn:()=>d,wm:()=>c,zr:()=>h});n(77950),n(85940),n(73439),n(71372),n(36728);var s=n(25130),a=n.n(s),l=n(99853),r=n(65366);const i=a()("web-speech"),o=window.SpeechRecognition||window.webkitSpeechRecognition,c=!!o;var u=function(e){return e.zh="cnm-Hans-CN",e.enUS="en-US",e.ja="ja-JP",e.ko="ko-KR",e.fr="fr-FR",e.de="de-DE",e.ru="ru-RU",e}(u||{});const d={[u.zh]:"中文(简体)",[u.enUS]:"英语(美国)",[u.ja]:"日语",[u.ko]:"韩语",[u.fr]:"法语",[u.de]:"德语",[u.ru]:"俄语"},v={"audio-capture":"你的电脑没有连接麦克风。","no-speech":"没有检测到语音。","not-allowed":"请在浏览器询问是否允许使用麦克风时选择“允许”。如果你之前选择过“禁止”，请点击浏览器地址栏左侧的锁或感叹号图标，然后将“麦克风”改为“允许”。如果浏览器从未询问过，则说明当前页面由于未知的原因不允许使用麦克风。","service-not-allowed":"你的浏览器当前不允许使用划词翻译的内置语音识别服务。",network:"网络出错，请检查你的网络连接。注意：划词翻译内置的语音转文字服务需要能连接外网才可使用。","language-not-supported":"你的浏览器不支持识别此语种。",aborted:"识别过程被中断了。","bad-grammar":"语法错误。"},x=/\S/;const m={id:l.of.WebSpeech,name:"划词翻译内置语音转文字",realtime:!0,defaultLang:u.zh};class p extends r.Z{constructor(){super(m)}async microphone(e){const{lang:t,options:n}=e;if(!c)throw new Error("划词翻译的内置语音转文字服务不支持在 Firefox 上使用，请选用腾讯云语音转文字服务。");let s=!1,a=!1;const l=new o;l.lang=t,l.interimResults=!!n.onInterim,l.continuous=!n.stopOnFirstSentence,l.addEventListener("error",(e=>{var t;i("error 事件",e),"aborted"===e.error&&s||(s=!0,null===(t=n.onError)||void 0===t||t.call(n,new Error(`${v[e.error]||e.error+". "}${e.message||""}`)))}));const r=[];return l.addEventListener("result",(e=>{const t=e.results[e.resultIndex],s=t[0].transcript;if(t.isFinal){var a;const e=s.replace(x,(function(e){return e.toUpperCase()}));i("识别到一句完整的话：",e),null===(a=n.onSentence)||void 0===a||a.call(n,e),r.push(e)}else{var l;i("识别到一句话的临时结果：",s),null===(l=n.onInterim)||void 0===l||l.call(n,s)}})),l.addEventListener("nomatch",(e=>{var t;i("nomatch 事件",e),a=!0,null===(t=n.onError)||void 0===t||t.call(n,new Error(`${this.service.name}无法准确识别你的语音，请确保在安静的环境中，并吐字清晰。`))})),l.addEventListener("end",(e=>{var t;i("end 事件",e,"识别出来的文本：",r,`是否已经中断：${s}`,`是否已经 nomatch：${a}`),s||a||null===(t=n.onStop)||void 0===t||t.call(n,r)})),l.start(),{stop:()=>{i("调用 stop 方法"),l.stop()},abort:()=>{i("调用 abort 方法"),s=!0,l.abort()}}}mediaStream(e){return Promise.reject(new Error("划词翻译的内置语音转文字服务只支持通过麦克风使用。"))}}const h=new p},66012:(e,t,n)=>{n.d(t,{k:()=>k});n(15735),n(6886),n(36728);var s=n(2784),a=n(41752),l=n(75578),r=n(91942),i=n(4253),o=n(34809),c=n(36215),u=n(60265),d=n(60279),v=n(26777),x=n(18435),m=n(72481),p=n(80432),h=n(17419),g=n(99853),f=n(71786),j=n(52322);const w=3,y=new u.P("sttLimit",w),C=(0,v.Z)(d.qI,["tipForSTTClosed"]);function k(e){const{isLarge:t,isSmall:n,iconSize:u,onSelect:d,portalContainer:v}=e,[k,b]=(0,x.Z)(C),[I,S]=(0,s.useState)(!1),[z,R]=(0,s.useState)(g.of.WebSpeech),[Z,L]=(0,s.useState)(""),[T,P]=(0,s.useState)(""),[F,N]=(0,s.useState)(""),{serviceImplement:U,langMap:A}=(0,s.useMemo)((()=>{switch(z){case g.of.TencentRealtime:return{serviceImplement:p.Uz,langMap:p.PK};case g.of.WebSpeech:return{serviceImplement:m.zr,langMap:m.Xn}}}),[z]);return(0,s.useEffect)((()=>{switch(z){case g.of.TencentRealtime:L(p.Ty.defaultLang);break;case g.of.WebSpeech:L(m.Lx.defaultLang)}}),[z]),(0,s.useEffect)((()=>{if(!I)return;const e=[];let t,n=!1;const s=e=>{window.alert((0,h.DR)(e).message),S(!1)};return U.microphone({lang:Z,options:{stopOnFirstSentence:!0,onError:s,onSentence:t=>{e.push(t),P(e.join(""))},onInterim:t=>{N(e.join("")+t)},onStop:e=>{e.length?(y.addOne(),d(e.join(""))):window.alert("未识别出任何文本，请重试。"),S(!1)}}}).then((e=>{n?null==e||e.abort():t=e}),s),()=>{var e;n=!0,null===(e=t)||void 0===e||e.abort(),P(""),N("")}}),[I,Z,d,U]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.z,{icon:(0,j.jsx)(c.R,{iconSize:u}),small:n,large:t,minimal:!0,title:"语音翻译",onClick:m.wm?()=>{k&&!k.tipForSTTClosed&&(window.alert("语音翻译功能目前只有在你的电脑能访问外网的情况下才能使用。未来的版本中会改善此情况，届时会另行通知。"),b({tipForSTTClosed:!0})),y.isOver().then((e=>{e?window.alert(`非会员用户每天只能使用 ${w} 次语音翻译功能，成为会员即可解除此限制。`):S(!0)}))}:()=>{window.alert("Firefox 暂时不支持语音翻译功能，请在其它浏览器上使用。未来的版本中会添加对 Firefox 浏览器的支持，届时会另行通知。")}}),(0,j.jsxs)(l.V,{isOpen:I,enforceFocus:!1,portalContainer:v,children:[(0,j.jsxs)("div",{className:r.TmF,children:[(0,j.jsxs)("div",{style:{marginBottom:10},children:["选择服务：",(0,j.jsx)(i.L,{onChange:e=>{R(e.currentTarget.value)},large:t,value:z,children:f.pB.map((e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id)))}),"切换语种：",(0,j.jsx)(i.L,{onChange:e=>{L(e.currentTarget.value)},large:t,value:Z,children:Object.keys(A).map((e=>(0,j.jsx)("option",{value:e,children:A[e]||e},e)))})]}),(0,j.jsx)(o.B,{value:T||F,readOnly:!0,placeholder:"请讲，我正在听……"})]}),(0,j.jsx)("div",{className:r.Alt,children:(0,j.jsx)("div",{className:r.e$L,children:(0,j.jsx)(a.z,{large:t,onClick:()=>{S(!1)},children:"取消"})})})]})]})}},10586:(e,t,n)=>{n.d(t,{j:()=>f});n(73439),n(15735),n(6886);var s=n(50251),a=n.n(s),l=n(2784),r=n(41752),i=n(24400),o=n(75578),c=n(91942),u=n(77473),d=n(52322);function v(e){const{fileInputProps:t,initialText:n="请选择",onInputChange:s}=e,[a,r]=(0,l.useState)(!1),[i,o]=(0,l.useState)(n);return(0,d.jsx)(u.S,{text:i,hasSelection:a,buttonText:"浏览",onInputChange:e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];a?(r(!0),o(a.name)):(r(!1),o(n)),null==s||s(e)},...t})}var x=n(61064),m=n(26777),p=n(60279),h=n(18435);const g=(0,m.Z)(p.qI,["localOCR","ocrService"]);function f(e){var t;const{isLarge:n,isSmall:s,iconSize:u,onSelect:m,portalContainer:p}=e,[f,j]=(0,h.Z)(g),[w,y]=(0,l.useState)(""),[C,k]=(0,l.useState)(!1),b="tesseractocr"===(null==f?void 0:f.ocrService),[I,S]=(0,l.useState)(!1),z=()=>{S(!1),y(""),k(!1)};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.z,{icon:(0,d.jsx)(i.I,{icon:"media",size:u}),small:s,large:n,minimal:!0,title:"图片翻译",onClick:()=>{S(!0)}}),(0,d.jsx)(o.V,{isOpen:I,enforceFocus:!1,portalContainer:p,children:(0,d.jsxs)("form",{children:[(0,d.jsxs)("div",{className:c.TmF,children:[(0,d.jsx)("p",{children:(0,d.jsx)(v,{initialText:"选择图片",onInputChange:e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&function(e){return new Promise(((t,n)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=()=>n(s.error),s.readAsDataURL(e)}))}(n).then((e=>{b?(y(e),k(!1)):(z(),m(e))}),(e=>{window.alert(`读取图片失败，错误消息：${e.message}`)}))},fileInputProps:{inputProps:{accept:"image/*",required:!0},fill:!0,large:n}})}),(0,d.jsxs)("p",{children:["或者"," ",(0,d.jsx)(r.z,{small:s,large:n,onClick:()=>{a().runtime.sendMessage({action:"read clipboard image"}).then((e=>{e?b?(y(e),k(!0)):(z(),m(e)):window.alert("剪切板内没有图片。")}))},children:"读取剪切板内的图片"}),C&&(0,d.jsx)("span",{style:{marginLeft:5},children:"已读取"})]}),b&&w&&(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{children:["选择语种：",(0,d.jsx)(x.U,{value:(null==f||null===(t=f.localOCR)||void 0===t?void 0:t.lang)||g.localOCR.lang,onChange:e=>{j((t=>{t.localOCR.lang=e}))},isLarge:n,isSmall:s,portalContainer:p})]}),(0,d.jsx)(r.z,{small:s,large:n,intent:"primary",onClick:()=>{z(),m(w)},children:"确定"})]})]}),(0,d.jsx)("div",{className:c.Alt,children:(0,d.jsx)("div",{className:c.e$L,children:(0,d.jsx)(r.z,{small:s,large:n,type:"reset",onClick:z,children:"取消"})})})]})})]})}},64526:(e,t,n)=>{n.d(t,{H:()=>p,Z:()=>g});n(1951);var s=n(50251),a=n.n(s),l=n(97276),r=n(23351),i=n(24400),o=n(59069),c=n(89458),u=n(91942),d=n(69961),v=n(89933),x=n(52322);const m={small:12,middle:16,large:20};function p(){a().runtime.sendMessage({action:"open options page",suffix:"?vip"}).catch((e=>{window.alert("打开设置页时发生了一个错误。错误消息：："+(null==e?void 0:e.message))}))}function h(e){a().runtime.sendMessage({action:"open options page",suffix:e}).catch((e=>{window.alert("打开设置页时发生了一个错误。错误消息：："+(null==e?void 0:e.message))}))}function g(e){const{source:t,setSource:n,options:s,setOptions:a,user:g,children:f,size:j,portalContainer:w}=e;if(!s)return null;const y="large"===j,C=(e,t)=>{a((n=>{const s=n[t],a=s.indexOf(e);a>=0?s.splice(a,1):4===s.length&&s.pop(),s.unshift(e)}))};return(0,x.jsxs)(r.Z,{className:"quick-settings",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)(l.Z,{lang:t,setLang:e=>{n(e),C(e,"recentUseLangFrom")},addAuto:!0,recentUse:s.recentUseLangFrom,size:j,portalContainer:w}),(0,x.jsx)(i.I,{icon:"arrow-right",size:m[j],style:{margin:"0 10px"}}),(0,x.jsx)(l.Z,{lang:s.destination,setLang:e=>{a({destination:e}),C(e,"recentUseLangTo")},recentUse:s.recentUseLangTo,size:j,portalContainer:w})]}),(0,x.jsx)("div",{children:(0,x.jsx)(v.f,{useShortName:!0,selectedAPIs:s.selectedAPIs,onChange:e=>{a({selectedAPIs:e})}})}),(0,x.jsxs)("div",{children:[(0,x.jsx)(o.XZ,{inline:!0,label:"自动朗读",large:y,checked:s.autoPlay,onChange:e=>{a({autoPlay:e.target.checked})}}),(0,x.jsx)(c.u,{interactionKind:"hover",hoverCloseDelay:300,enforceFocus:!1,portalContainer:w,disabled:(null==g?void 0:g.vipActivated)||!1,content:(0,x.jsxs)(x.Fragment,{children:["这是一个会员功能，请在",(0,x.jsx)("a",{onClick:p,children:"开通会员"}),"后使用。"]}),children:(0,x.jsx)(o.XZ,{inline:!0,label:"自动复制",disabled:!(null!=g&&g.vipActivated),checked:s.autoCopy,onChange:e=>{a({autoCopy:e.target.checked})}})})]}),(0,x.jsx)(d.l,{value:s.panelSize,onChange:e=>{a({panelSize:e})}}),f&&(0,x.jsx)("div",{children:f}),(0,x.jsx)("a",{onClick:()=>h(),className:u.Tio,children:"打开完整设置"}),!(null!=g&&g.vipActivated)&&(0,x.jsxs)("a",{onClick:()=>h("?vip"),className:u.Tio,style:{marginLeft:15},children:[(0,x.jsx)(i.I,{icon:"crown",size:14,style:{position:"relative",top:-1}})," ","开通会员"]})]})}},51035:(e,t,n)=>{n.d(t,{Z:()=>u});n(15735),n(6886),n(36728),n(39529);var s=n(49629),a=n(18435),l=n(26777),r=n(60279),i=n(51813),o=n(52322);const c=(0,l.Z)(r.qI,"selectedAPIs");function u(){const[e,t]=(0,a.Z)(c);return(0,o.jsx)(o.Fragment,{children:i.Y.map((n=>(0,o.jsx)(s.s,{text:n.name,onClick:()=>(e=>{const n=e.id;t((e=>{const t=e.selectedAPIs;t.indexOf(n)<0&&t.push(n)}))})(n),disabled:!e||e.selectedAPIs.includes(n.id)},n.id)))})}},39279:(e,t,n)=>{n.d(t,{Z:()=>N,h:()=>I});n(73439),n(36728),n(15735),n(6886),n(77950),n(96920);var s=n(50251),a=n.n(s),l=n(2784),r=n(41752),i=n(24400),o=n(23351),c=n(39421),u=n(83524),d=n(8560),v=n(91942),x=n(72779),m=n.n(x),p=n(26777),h=n(22168),g=n(60279),f=n(97276),j=n(29671),w=n(51813),y=n(853),C=n(48655),k=n(18435),b=n(52322);async function I(e){a().runtime.sendMessage({action:"audio",url:e}).catch((e=>{window.alert("朗读时出错："+(null==e?void 0:e.message))}))}function S(e){const t=e.uri,n=e.size,s=e.style;return(0,b.jsx)(r.z,{style:s,icon:(0,b.jsx)(i.I,{icon:"volume-up",size:T[n]}),small:"small"===n,large:"large"===n,minimal:!0,disabled:!t,onClick:t?()=>I(t):void 0,title:t?"朗读":"不支持此语种"})}function z(e,t){const n="GoogleWeb"===t,s=[];return!e.phonetic||n&&!e.dict||s.push(e.phonetic.map((e=>`${e.name?e.name+" ":""}/${e.value}/`))),e.dict?s.push(...e.dict.map((e=>`${e.pos?e.pos+(n?": ":" "):""}${e.terms.join(", ")}`))):e.result&&s.push(...e.result),a().runtime.sendMessage({action:"write to clipboard",text:s.join("\n")})}function R(e){e.stopPropagation()}const Z=/\b[A-Z\s\-'a-z]+\b/g;function L(e,t){const n=Array.from(e.matchAll(Z)),s=e.split(Z);return(0,b.jsx)(b.Fragment,{children:s.map(((e,s)=>{const a=n[s];return(0,b.jsxs)(l.Fragment,{children:[e,a?(0,b.jsx)("a",{onClick:()=>t(a[0]),children:a[0]}):""]},s)}))})}const T={small:12,middle:16,large:20};function P(e){switch(e){case"美":return"英语(美国)";case"英":return"英语(英国)";default:return}}const F={...(0,p.Z)(g.qI,"googleHidePhonetic"),...(0,p.Z)(g.d6,["tipForGoogleTranslateClosed","tipForDeepLLimitClosed"])};function N(e){var t;const{apiId:n,result:{loading:s,result:a}={loading:!1,result:null},queryResult:x,autoCopy:p=!1,autoPlay:g=!1,wordClickable:Z=!0,setQuery:N=h.Z,size:U="small",collapse:A,onCollapseChange:E,portalContainer:$}=e,[O,_]=(0,k.Z)(F),D=T[U],M="small"===U,q="large"===U,[K,H]=(0,l.useState)("duplicate"),[W,G]=(0,l.useState)(),B=w.Y.find((e=>e.id===n))||{name:n,id:n},J="GoogleWeb"===n&&!(null==O||!O.googleHidePhonetic),V=()=>{H("tick"),G("success"),window.setTimeout((()=>{H("duplicate"),G(void 0)}),1e3)};(0,l.useEffect)((()=>{var e;a&&(g&&a.text.length<30&&I({apiId:n,source:a.from,text:a.text,ttsURI:(null===(e=a.phonetic)||void 0===e?void 0:e[0].ttsURI)||a.ttsURI}))}),[n,g,a]),(0,l.useEffect)((()=>{a&&p&&z(a,n).then((e=>{e?V():window.alert("自动复制翻译结果失败，请稍后重试。")}),(e=>{window.alert(`自动复制翻译结果时发生了一个错误：${null==e?void 0:e.message}`)}))}),[a,p,n]);const X=y.q[n];return(0,b.jsxs)(o.Z,{className:"result-block",onClick:R,children:["GoogleWeb"===n&&!(null!=O&&O.tipForGoogleTranslateClosed)&&(0,b.jsxs)(c.U,{intent:"warning",icon:null,children:[(0,b.jsx)("p",{children:"谷歌翻译可能需要额外配置才能使用。"}),(0,b.jsx)(r.A,{small:!0,style:{visibility:"visible"},intent:"primary",href:"https://hcfy.app/blog/2022/09/28/ggg",target:"_blank",children:"查看详情"}),(0,b.jsx)("a",{style:{marginLeft:15},onClick:()=>{_({tipForGoogleTranslateClosed:!0})},children:"不再提示"})]}),"DeepLWeb"===n&&!(null!=O&&O.tipForDeepLLimitClosed)&&(0,b.jsxs)(c.U,{intent:"warning",icon:null,children:[(0,b.jsx)("p",{children:"DeepL 首次翻译速度较慢，请耐心等待。若遇到问题（报错、翻译结果不全等）请点击下方按钮。"}),(0,b.jsx)(r.A,{small:!0,style:{visibility:"visible"},intent:"primary",href:"https://hcfy.app/docs/services/free/#deepl",target:"_blank",children:"查看解决方案"}),(0,b.jsx)("a",{style:{marginLeft:15},onClick:()=>{_({tipForDeepLLimitClosed:!0})},children:"不再提示"})]}),(0,b.jsxs)("div",{className:"legend",children:[(0,b.jsxs)("div",{className:"legend-left",children:[(0,b.jsx)("span",{className:"api-ico",style:X?{backgroundImage:`url(${X})`}:void 0}),(0,b.jsx)(u.H6,{children:B.name}),a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Z,{lang:a.from,setLang:x,size:"small",maxHeight:212,portalContainer:$,children:(0,b.jsxs)("span",{className:"source",children:[(0,b.jsx)("span",{className:"source-text",children:a.from}),(0,b.jsx)(i.I,{icon:"caret-down",size:12})]})}),(0,b.jsx)(S,{uri:{apiId:n,source:a.from,text:a.text,ttsURI:(null===(t=a.phonetic)||void 0===t?void 0:t[0].ttsURI)||a.ttsURI},size:U})]})]}),(0,b.jsxs)("div",{style:{flexShrink:0},children:[void 0!==A&&(0,b.jsx)(r.z,{minimal:!0,small:M,large:q,title:A?"展开":"收起",onClick:()=>{E&&E(!A)},icon:(0,b.jsx)(i.I,{icon:A?"chevron-down":"chevron-up",size:D+2})}),(0,b.jsx)(r.z,{onClick:()=>{a&&z(a,n).then((e=>{e?V():window.alert("复制翻译结果失败，请稍后重试。")}),(e=>{window.alert(`复制翻译结果时发生了一个错误：${null==e?void 0:e.message}`)}))},disabled:!a||!!a.error,icon:(0,b.jsx)(i.I,{icon:K,size:D}),minimal:!0,small:M,large:q,intent:W,title:"复制翻译结果"}),(0,b.jsx)(r.A,{disabled:!(null!=a&&a.link),target:"_blank",href:(null==a?void 0:a.link)||"",icon:(0,b.jsx)(i.I,{icon:"share",size:D}),minimal:!0,small:M,large:q,title:"查看详细结果"})]})]}),(0,b.jsxs)(d.U,{isOpen:!A,children:[(0,b.jsxs)("div",{style:{display:s?"block":"none"},children:[(0,b.jsx)("p",{className:m()({[v.Ms1]:s}),children:"1"}),(0,b.jsx)("p",{className:m()({[v.Ms1]:s}),style:{width:"150px"},children:"1"})]}),(null==a?void 0:a.error)&&(0,b.jsx)("div",{className:"error",children:(0,b.jsx)(C.i,{error:a.error,onRetry:()=>x()})}),(null==a?void 0:a.phonetic)&&!J&&(0,b.jsx)("div",{className:"phonetic",children:a.phonetic.map(((e,t)=>(0,b.jsxs)("div",{className:"phonetic-item",style:{maxWidth:"100%"},children:[e.name&&(0,b.jsx)("span",{style:{flexShrink:0,marginRight:5},children:e.name}),e.value&&(0,b.jsxs)(j.Z,{children:["/",e.value,"/"]}),e.ttsURI&&(0,b.jsx)(S,{style:{flexShrink:0},uri:{apiId:n,source:P(e.name)||a.from,text:a.text,ttsURI:e.ttsURI},size:U})]},t)))}),a&&(0,b.jsxs)("div",{className:"common-result",children:[a.dict&&(0,b.jsx)("div",{className:"dict",children:a.dict.map(((e,t)=>{const s=e.terms.join(", ");return(0,b.jsxs)("p",{children:[e.pos&&(0,b.jsxs)("span",{className:"dict-pos",children:[e.pos,"GoogleWeb"===n?": ":""]}),Z?L(s,N):s]},t)}))}),!a.dict&&a.result&&(0,b.jsx)("div",{className:"general-result",children:a.result.map(((e,t)=>(0,b.jsxs)("p",{children:[e,(0,b.jsx)(S,{uri:{text:e,apiId:n,source:null==a?void 0:a.to},size:U})]},t)))})]})]})]})}},42165:(e,t,n)=>{n.d(t,{H:()=>w});n(15735),n(6886);var s=n(12244),a=n(39421),l=n(41752),r=n(24400),i=n(2784),o=n(81139),c=n(76397),u=n(55773),d=n(26777),v=n(60279),x=n(18435),m=n(50251),p=n.n(m),h=n(52322);const g=location.href.startsWith(p().runtime.getURL("/panel.html")),f=u.oJ.ctrl,j={...(0,d.Z)(v.qI,["textAreaShortKey","autoPaste"]),...(0,d.Z)(v.d6,["tipForPasteTranslateClosed"])},w=(0,i.forwardRef)((function(e,t){const{isSmall:n,isLarge:u,value:d,onChange:m,onTranslate:w,iconSize:y,hideBtn:C,auto:k}=e,[b,I]=(0,x.Z)(j),S=(null==b?void 0:b.textAreaShortKey)||j.textAreaShortKey,z=(0,i.useRef)(null),[R,Z]=(0,i.useState)(!1),{msg:L,textareaPlaceholder:T}=(0,i.useMemo)((()=>{const e=(S===v.VH.ctrlEnter?"Ctrl / ⌘ + ":"")+"Enter";return{msg:`翻译文本框内的文本(${e})`,textareaPlaceholder:`按下 ${e} 也可以翻译文本框内的文本`}}),[S]),P=(0,c.j)(),F=(0,o.H)(z.current);return(0,i.useEffect)((()=>{if(!k)return;const e=setTimeout(w,1e3);return()=>{clearTimeout(e)}}),[k,w]),(0,i.useImperativeHandle)(t,(()=>({select(){var e;null===(e=z.current)||void 0===e||e.select()}})),[]),(0,h.jsxs)("div",{className:"query-text",children:[(0,h.jsx)(s.K,{fill:!0,small:n,large:u,inputRef:z,value:d,placeholder:T,onChange:e=>{m(e.target.value)},onKeyDown:e=>{g||e.stopPropagation(),(S!==v.VH.ctrlEnter||e[f])&&13===e.keyCode&&(e.preventDefault(),w())},onPaste:null!=b&&b.autoPaste?e=>{e.clipboardData.getData("text").trim()&&(Z(!0),setTimeout((()=>{w(e.target.value)})))}:void 0}),!(null!=b&&b.tipForPasteTranslateClosed)&&R&&(0,h.jsxs)(a.U,{title:"自 v8.6.5 起，在文本框中粘贴文本后会立刻触发翻译。",children:["你可以在",(0,h.jsx)("a",{onClick:()=>{p().runtime.sendMessage({action:"open options page",suffix:"#/panel"})},children:"“设置” - “翻译面板”"})," ","- “文本框”中关闭此功能。",(0,h.jsx)("a",{onClick:()=>{I({tipForPasteTranslateClosed:!0})},children:"不再提示"})]}),(0,h.jsx)(l.z,{className:"translate-btn",style:{display:C?"none":void 0,right:18+(F.v&&P||0),bottom:8+(F.h&&P||0)},title:L,icon:(0,h.jsx)(r.I,{icon:"search",size:y}),small:n,large:u,intent:"primary",onClick:()=>{var e;w(),null===(e=z.current)||void 0===e||e.focus()}}),(0,h.jsx)(l.z,{className:"clear-btn",style:{position:"absolute",display:d?void 0:"none",right:11+(F.v&&P||0),top:11},minimal:!0,title:"清空文本",icon:(0,h.jsx)(r.I,{icon:"cross",size:y}),small:n,large:u,onClick:()=>{var e;m(""),null===(e=z.current)||void 0===e||e.focus()}})]})}))},61974:(e,t,n)=>{n.d(t,{Z:()=>r});n(15735),n(6886);var s=n(50251),a=n.n(s),l=n(2784);function r(e,t,n){const[s,r]=(0,l.useState)(!1);(0,l.useEffect)((()=>{a().runtime.sendMessage({action:"is text in favorites",text:e}).then(r)}),[e]);const i=(0,l.useCallback)((()=>{a().runtime.sendMessage({action:"delete record in favorites",text:e}).catch((e=>{window.alert(`从收藏夹中删除时发生了一个错误：${null==e?void 0:e.message}`)})),r(!1)}),[e]),o=(0,l.useCallback)((()=>{e&&n&&(t({type:"save favorites",text:e,selectedAPIs:n}),r(!0))}),[t,n,e]);return{isInFavorites:s,saveOrDelete:s?i:o}}},4307:(e,t,n)=>{n.d(t,{n:()=>m});n(15735),n(6886),n(73439);var s=n(50251),a=n.n(s),l=n(2784),r=(n(39529),n(67067)),i=n(25513),o=n(83736);const c={results:{}},u=(e,t)=>(0,r.Uy)(e,(e=>{switch(t.type){case"set loading":return void(t.value?e.results[t.apiId]={loading:!0,result:null}:(0,i.Z)(e.results,[t.apiId,"loading"],!1));case"set result":return void(0,i.Z)(e.results,[t.apiId,"result"],t.result);case"clear results":return void(e.results={});case"save favorites":const n=t.selectedAPIs,s={};return(0,o.Z)(e.results,((e,t)=>{if(!e||e.loading)return;const a=e.result;a&&n.includes(t)&&(s[t]=(0,r.Js)(a))})),void a().runtime.sendMessage({action:"save favorite",record:{text:t.text,results:s}}).catch((e=>{window.alert(`保存到收藏夹时发生了一个错误：${null==e?void 0:e.message}`)}))}}));var d=n(76539),v=n(23882),x=n(44773);function m(e,t,n,s,r){const i=(0,l.useRef)(""),[o,m]=(0,l.useReducer)(u,c),p=(0,l.useRef)();p.current=r;const h=(0,d.Z)(e),g=(0,d.Z)(n),f=(0,d.Z)(t),j=(0,d.Z)(s),w=async(e,t,n,s=(()=>!1))=>{let l;m({type:"set loading",apiId:t,value:!0});try{l=await a().runtime.sendMessage({action:"translate",data:{apiCode:t,text:e,source:n}})}catch(n){if(s())return;return m({type:"set loading",apiId:t,value:!1}),void m({type:"set result",apiId:t,result:{text:e,error:{message:(null==n?void 0:n.message)||"未知错误"}}})}if(!s()&&(m({type:"set loading",apiId:t,value:!1}),l)){if("GoogleWeb"===t){const e=l.from;e&&"中文(简体)"!==e&&a().storage.local.set({latestSource:e})}m({type:"set result",apiId:t,result:l})}};return(0,l.useEffect)((()=>{var a;if(!s)return;if(e===h&&n===g&&s===j)return;m({type:"clear results"});const l=(0,v.Z)();if(i.current=l,!e)return;null===(a=p.current)||void 0===a||a.call(p);const r=()=>l!==i.current;null==t||t.forEach((t=>{w(e,t,n,r)}))}),[s,e,t,n]),(0,l.useEffect)((()=>{if(!f||!t)return;const s=(0,x.Z)(t,f);if(!s.length)return;const a=i.current,l=()=>a!==i.current;s.forEach((t=>{o.results[t]||w(e,t,n,l)}))}),[e,o.results,t,n]),{results:o,queryResult:w,dispatchResults:m}}},25456:(e,t,n)=>{n.d(t,{Z:()=>d});var s=n(50251),a=n.n(s),l=n(67067),r=n(23882),i=n(2784);let o="";const c=document.querySelector('link[rel=icon],link[rel="shortcut icon"]');o=c?c.href:window.location.origin+"/favicon.ico";const u=(0,l.Uy)(((e,t)=>{if("save translate record"===t.type){const n=Date.now(),s=(0,r.Z)(n+"-");return e.translateId=s,void a().runtime.sendMessage({action:"save history record",record:{text:t.text,date:n,url:window.location.href,title:document.title,favicon:o}}).catch((e=>{window.alert(`保存历史记录时发生了一个错误：${null==e?void 0:e.message}`)}))}}));function d(){return(0,i.useReducer)(u,{translateId:""})}},86388:(e,t,n)=>{n.d(t,{_:()=>m});n(73439),n(39529);var s=n(50251),a=n.n(s),l=n(26777),r=n(60279),i=n(91942),o=n(41752),c=n(2784),u=n(64526),d=n(52322);const v=(0,l.Z)(r.qI,["ocrService"]);function x(){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{children:"正在从截图中提取文本，请稍候……"}),(0,d.jsx)("div",{className:`${i.kjJ} ${i.Tio}`,children:(0,d.jsx)("div",{style:{marginTop:4},children:(0,d.jsx)("a",{href:"https://hcfy.app/docs/guides/screenshot#slow",target:"_blank",rel:"noreferrer",children:"为什么还没有提取成功？"})})})]})}function m(e){return(0,c.useCallback)((async t=>{const{ocrService:n}=await a().storage.local.get(v),s="tesseractocr"===n,l=null==e?void 0:e.show({message:s?(0,d.jsx)(x,{}):"正在从截图中提取文本，请稍候……",timeout:0});return a().runtime.sendMessage({action:"ocr",dataURI:t}).then((t=>(l&&(null==e||e.dismiss(l)),t)),(t=>(null==e||e.show({message:null!=t&&t.message.includes("会员")?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{children:t.message}),(0,d.jsx)(o.z,{onClick:u.H,small:!0,children:"开通会员"})]}):`从图片中提取文字时发生了一个错误：${null==t?void 0:t.message}`,intent:"warning",timeout:0},l),Promise.reject(t))))}),[e])}},61064:(e,t,n)=>{n.d(t,{U:()=>u});var s=n(8636),a=n(49629),l=n(41752);n(43108),n(36728);const r=[],i=[{text:"中文(简体)",value:"chi_sim"},{text:"中文(繁体)",value:"chi_tra"},{text:"英语",value:"eng"},{text:"日语",value:"jpn"},{text:"法语",value:"fra"},{text:"韩语",value:"kor"},{text:"德语",value:"deu"},{text:"俄语",value:"rus"},{text:"泰语",value:"tha"},{text:"南非语",value:"afr"},{text:"阿姆哈拉语",value:"amh"},{text:"阿拉伯语",value:"ara"},{text:"阿萨姆语",value:"asm"},{text:"阿塞拜疆语",value:"aze"},{text:"阿塞拜疆语(西里尔)",value:"aze_cyrl"},{text:"白俄罗斯语",value:"bel"},{text:"孟加拉语",value:"ben"},{text:"藏语",value:"bod"},{text:"波斯尼亚语",value:"bos"},{text:"保加利亚语",value:"bul"},{text:"加泰罗尼亚语(瓦伦西亚)",value:"cat"},{text:"宿务语",value:"ceb"},{text:"捷克语",value:"ces"},{text:"切罗基语",value:"chr"},{text:"威尔士语",value:"cym"},{text:"丹麦语",value:"dan"},{text:"宗喀语",value:"dzo"},{text:"希腊语(现代)",value:"ell"},{text:"中古英语",value:"enm"},{text:"世界语",value:"epo"},{text:"爱沙尼亚语",value:"est"},{text:"巴斯克语",value:"eus"},{text:"波斯语",value:"fas"},{text:"芬兰语",value:"fin"},{text:"德文尖角体",value:"frk"},{text:"中古法语",value:"frm"},{text:"爱尔兰语",value:"gle"},{text:"希腊语(古代)",value:"grc"},{text:"古吉拉特语",value:"guj"},{text:"海地克里奥尔语",value:"hat"},{text:"希伯来语",value:"heb"},{text:"印地语",value:"hin"},{text:"克罗地亚语",value:"hrv"},{text:"匈牙利语",value:"hun"},{text:"因纽特语",value:"iku"},{text:"印度尼西亚语",value:"ind"},{text:"冰岛语",value:"isl"},{text:"意大利语",value:"ita"},{text:"意大利语(古代)",value:"ita_old"},{text:"爪哇语",value:"jav"},{text:"坎纳达语",value:"kan"},{text:"格鲁吉亚语",value:"kat"},{text:"格鲁吉亚语(古代)",value:"kat_old"},{text:"哈萨克语",value:"kaz"},{text:"高棉语",value:"khm"},{text:"吉尔吉斯语",value:"kir"},{text:"库尔德语",value:"kur"},{text:"老挝语",value:"lao"},{text:"拉丁语",value:"lat"},{text:"拉脱维亚语",value:"lav"},{text:"立陶宛语",value:"lit"},{text:"马拉雅拉姆语",value:"mal"},{text:"马拉地语",value:"mar"},{text:"马其顿语",value:"mkd"},{text:"马耳他语",value:"mlt"},{text:"马来语",value:"msa"},{text:"缅甸语",value:"mya"},{text:"尼泊尔语",value:"nep"},{text:"荷兰语(弗拉芒)",value:"nld"},{text:"挪威语",value:"nor"},{text:"奥里亚语",value:"ori"},{text:"旁遮普语",value:"pan"},{text:"波兰语",value:"pol"},{text:"葡萄牙语",value:"por"},{text:"普什图语",value:"pus"},{text:"罗马尼亚语",value:"ron"},{text:"梵语",value:"san"},{text:"僧伽罗语",value:"sin"},{text:"斯洛伐克语",value:"slk"},{text:"斯洛维尼亚语",value:"slv"},{text:"西班牙语",value:"spa"},{text:"西班牙语(古代)",value:"spa_old"},{text:"阿尔巴尼亚语",value:"sqi"},{text:"塞尔维亚语",value:"srq"},{text:"塞尔维亚语(拉丁)",value:"srq_latn"},{text:"斯瓦希里语",value:"swa"},{text:"瑞典语",value:"swe"},{text:"叙利亚语",value:"syr"},{text:"泰米尔语",value:"tam"},{text:"泰卢固语",value:"tel"},{text:"塔吉克",value:"tgk"},{text:"他加禄语",value:"tgl"},{text:"提格里尼亚",value:"tir"},{text:"土耳其语",value:"tur"},{text:"维吾尔语",value:"uig"},{text:"乌克兰语",value:"ukr"},{text:"乌尔都语",value:"urd"},{text:"乌兹别克语",value:"uzb"},{text:"乌兹别克语(西里尔)",value:"uzb_cyrl"},{text:"越南语",value:"vie"},{text:"意第绪语",value:"yid"}].reduce(((e,t)=>(r.push(t.value),e[t.value]=t.text,e)),{});var o=n(52322);const c=(e,{handleClick:t,modifiers:n})=>n.matchesPredicate?(0,o.jsx)(a.s,{onClick:t,active:n.active,text:i[e]},e):null;function u(e){const{value:t,onChange:n,isSmall:a,isLarge:u,portalContainer:d}=e;return(0,o.jsx)(s.P,{filterable:!1,activeItem:t,items:r,itemRenderer:c,onItemSelect:n,popoverProps:{portalContainer:d,targetTagName:"span"},children:(0,o.jsx)(l.z,{rightIcon:"caret-down",small:a,large:u,children:i[t]})})}},47909:(e,t,n)=>{n.d(t,{L:()=>l});n(77950),n(85940),n(43108),n(17368),n(24471),n(90103);const s=/^[A-Z]?[a-z]+([A-Z][a-z]*)+$/,a=/^([A-Za-z]+_)+[A-Za-z]+$/;function l(e,t){let n=e.trim();return t&&(t.sourceTransformNoBr&&(n=n.replace(/\r?\n/g," ")),t.sourceTransformNoComment&&(n=n.replace(/\/\//g," ")),t.sourceTransformRegExps&&(n=t.sourceTransformRegExps.reduce(((e,t)=>{let n;try{n=new RegExp(t.pattern,t.flags)}catch(t){return e}return e.replace(n,t.replaceTo||"")}),n)),t.sourceTransformNCaml&&(s.test(n)?n=n.replace(/[A-Z]/g,((e,t)=>0===t?e.toLowerCase():" "+e.toLowerCase())):a.test(n)&&(n=n.replace(/_/g," ")))),n}}}]);