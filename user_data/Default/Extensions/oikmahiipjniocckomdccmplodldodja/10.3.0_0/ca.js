(()=>{"use strict";var e,t={40048:(e,t,n)=>{n.d(t,{$o:()=>c});n(71372),n(43108),n(36728);var o=n(88120),r=n(99853),i=n(41215),s=n(50251),a=n.n(s),l=n(74875);const c=!0,u={id:r.gu.BaiDu,name:"百度文字识别",points:!0,secretKeys:{get:()=>a().storage.local.get({baiDuOCRKey:[]}).then((({baiDuOCRKey:e})=>(Array.isArray(e)?e:[e]).map((e=>({id:e.key,key:e.secret}))))),set:e=>a().storage.local.set({baiDuOCRKey:e.map((e=>({key:e.id,secret:e.key})))}),isComplete:e=>(0,l.dz)(e,["id"])},pointsEnable:{get:()=>a().storage.local.get({bdOcrPoints:c}).then((({bdOcrPoints:e})=>e)),set:e=>a().storage.local.set({bdOcrPoints:e})}};class d extends o.E{constructor(){super(u,!0)}callBySecretKey(e,t){return new i.w(e).ocr(t.image)}transform(e){if(!e.paragraphs_result)throw new Error("百度文字识别服务配置有误，请确认你领取过免费资源包，且密钥填写无误。");return e.paragraphs_result.reduce(((t,{words_result_idx:n})=>(t.push(n.reduce(((t,n)=>t+e.words_result[n].words),"")),t)),[]).join("\n")}}new d},51813:(e,t,n)=>{n.d(t,{L:()=>g});var o=n(98269),r=n(59250),i=n(88311),s=n(66331),a=n(62259),l=n(47288),c=n(49350),u=n(52768),d=n(81523),p=n(13429),f=n(99344),m=n(53657);const g=[c.w,u.EH,f.K,m.B,r.pe,r.gG,a.ym,i.Xi,o.Wx,o.Il,l.Rw,p.I$,d.L,s.r].filter((e=>e!==d.L))},99853:(e,t,n)=>{n.d(t,{gu:()=>r,nV:()=>o});let o=function(e){return e.Yandex="Yandex",e.ChatGPT="ChatGPT",e.BaiDu="BaiDuWeb",e.BaiDuPro="BaiDuDomain",e.HuoShan="HuoShan",e.QQ="QQOfficial",e.CaiYun="CaiYunOfficial",e.ALi="ALiOfficial",e.ALiPro="ALiOfficialDomain",e.SouGou="SoGouOfficial",e.YouDao="YouDaoWeb",e.Google="GoogleWeb",e.DeepL="DeepLWeb",e.BingDict="BingDictWeb",e}({}),r=function(e){return e.Tesseract="tesseractocr",e.BaiDu="bdocr",e}({})},84609:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(13474);const r=document.caretPositionFromPoint?function(e,t){const n=document.caretPositionFromPoint(e,t);return n&&{offsetNode:n.offsetNode,offset:n.offset}}:document.caretRangeFromPoint?function(e,t){const n=document.caretRangeFromPoint(e,t);return n&&{offsetNode:n.startContainer,offset:n.startOffset}}:void 0;class i{constructor(e,t=1e3,n,i=document.body){this.destroyed=!1,this.context=i,this.onMouseMove=(0,o.Z)((t=>{n&&!t[n]||(!function(e,t){if(!r)return null;const n=window.getSelection();if(!n)return null;const o=r(e,t);if(!o)return null;const{offset:i,offsetNode:s}=o;if(s.nodeType!==Node.TEXT_NODE)return null;const a=n.rangeCount>0?n.getRangeAt(0):void 0;n.removeAllRanges();const l=document.createRange();l.setStart(s,i),l.setEnd(s,i),n.addRange(l),n.modify("move","backward","word"),n.modify("extend","forward","word");const c=n.getRangeAt(0).getBoundingClientRect();(c.left>e||c.left+c.width<e||c.top>t||c.top+c.height<t)&&(n.removeAllRanges(),a&&n.addRange(a))}(t.clientX,t.clientY),e(t))}),t),i.addEventListener("pointermove",this.onMouseMove)}destroy(){this.destroyed=!0,this.context.removeEventListener("pointermove",this.onMouseMove)}}},55773:(e,t,n)=>{n.d(t,{dD:()=>a});n(15735),n(6886),n(39529);var o=n(8721),r=n(25130);const i=n.n(r)()("hotkeys"),s=(o.eE,{ctrl:o.eE?o.vU?[224]:[91,93]:[17],alt:[18],shift:[16]});function a(e,t,n,o){const r=new Set;let a=!1;function l(){r.clear(),a?(a=!1,i("辅助键处于激活状态，执行中断回调"),o()):i("辅助键未处于激活状态")}function c(){i("页面失去了焦点，执行中断操作"),l()}function u(n){const o=n.keyCode,c=r.size;if(!e.some((e=>{if(s[e].includes(o))return r.add(e),!0})))return i("按下了不是辅助键的其它键，执行中断操作"),void l();c!==r.size&&(i("按下了新的辅助键，当前已经按下的辅助键：",[...r]),r.size===e.length&&(i("全部辅助键已按下，将辅助键改为激活状态，并执行辅助键按下回调"),a=!0,t()))}function d(t){const o=t.keyCode,l=r.size;if(!l)return;e.some((e=>{if(s[e].includes(o))return r.delete(e),!0}))&&l!==r.size&&(i("松开了新的辅助键，当前已经按下的辅助键：",[...r]),a=!1,e.length-r.size==1&&(i("一个辅助键已松开，执行辅助键松开回调"),n()))}return window.addEventListener("keydown",u),window.addEventListener("blur",c),window.addEventListener("keyup",d),()=>{window.removeEventListener("keydown",u),window.removeEventListener("blur",c),window.removeEventListener("keyup",d)}}},8721:(e,t,n)=>{n.d(t,{eE:()=>s,vU:()=>a});n(39529);var o=n(50251),r=n.n(o);const i=window.navigator.userAgent,s=i.includes("Mac"),a=(i.includes("Chrome"),i.includes("Edg"),i.includes("Firefox"));function l(e){return e.split(".").map((e=>Number(e)))}l(r().runtime.getManifest().version)},60279:(e,t,n)=>{n.d(t,{d6:()=>g,qI:()=>m});n(634);var o=n(80471),r=n(51813),i=n(32728),s=n(47288),a=n(98269),l=n(88311),c=n(59250),u=n(40048),d=n(62259),p=n(13429),f=n(52768);const m={button:!0,buttonAutoClose:!0,buttonOffsetTop:0,buttonOffsetLeft:0,charsLimit:0,disableInTextarea:!1,domainBlackList:[],domainWhiteList:[],textList:[{name:"忽略中文",readonly:!0,enabled:!1,value:"[\\u4e00-\\u9fa5]",description:"如果划选的文本当中包含中文，则不显示翻译按钮或翻译结果。"},{name:"忽略字符",readonly:!0,enabled:!0,value:"^[\\s.\\-0-9()•+]+$",description:"如果划选的文本全部都是由数字、点、括号、空格、横线、加号和圆点（即 •，多用于密码框）组成的，则不显示翻译按钮或翻译结果。"}],placement:"bottom",pin:!1,pinAfterDrag:!1,pinPos:null,pinEnhance:!0,pinIgnoreDomainList:!0,darkMode:"system",pdfAuto:!1,pdfSnifferEnable:!0,pdfStandalone:!1,width:290,source:"",destination:"中文(简体)",secondDestination:"英语",secondDestinationLatestSource:!1,showTextArea:!1,textAreaAuto:!1,textAreaShortKey:function(e){return e.ctrlEnter="ctrl-enter",e.enter="enter",e}({}).enter,selectedAPIs:["GoogleWeb","DeepLWeb","Yandex","BingDictWeb"],collapsedAPIs:[],selectedExternalLinks:[],autoClipboard:null,autoClipboardImage:null,autoPlay:!1,autoCopy:!1,autoPaste:!0,recentUseLangFrom:[""],recentUseLangTo:["中文(简体)"],tipPanelSettingsClosed:!1,tipBlockedPDFClosed:!1,tipIncognitoPDFClosed:!1,tipOcrChangeClosed:!0,tipForeverVIPClosed:!0,tipQuickLinksClosed:!1,tipNewProfessionalClosed:!1,tipTextareaBtnClosed:!0,tipForSTTClosed:!1,tipForPinAfterDragClosed:!0,tipForPageTrsNoLoadingClosed:!0,tipForSlowDeepLPageTrsClosed:!1,tipForPageTrsClosed:!1,panelPos:{width:270,height:500,left:100,top:100},panelFocus:!0,panelSize:"small",panelButtons:["media","microphone"],panelCustomStyle:"",notifySyncOptions:!0,sourceTransformNoBr:!1,sourceTransformNCaml:!1,sourceTransformNoComment:!1,sourceTransformRegExps:[],historyEnabled:!1,favoritesEnabled:!0,modifierKeys:[],modifierKeyPressedAction:"",modifierKeyTranslate:!1,modifierKeyLink:!1,audioVolume:100,audioRate:1,systemTTS:"aid",systemTTSAccent:{},systemTTSVoice:{},localOCR:{lang:"eng"},pageTrsApi:"GoogleWeb",pageTrsHighlight:!0,pageTrsResultStyleId:"STYLE_LINE",pageTrsResultStyleMainColor:null,pageTrsResultStyleTextColor:null,pageTrsResultStyleTextSize:null,pageTrsResultStyleTextWeight:null,pageTrsResultStyleCustom:"",pageTrsApiOptions:r.L.map((e=>e.id)),pageTrsJumpTwo:!1,pageTrsEditable:!0,googleRegion:"com",googleType:"fast",googleMirror:"",googleHidePhonetic:!1,quickLinks:[{name:"谷歌搜索",link:"https://www.google.com/search?q=%s",menu:!0,panel:!0},{name:"维基百科",link:"https://zh.wikipedia.org/w/index.php?search=%s",menu:!0,panel:!0},{name:"剑桥词典",link:"https://dictionary.cambridge.org/dictionary/english-chinese-simplified/%s",menu:!0,panel:!0}],noticesRead:[],customAPI:"",customAPINames:[],pointsEnabled:[],baiduDomain:null,aliDomain:null,ocrService:"tesseractocr",contextMenus:i.n,popupAction:"show-popup",pageTrsSource:"",pageTrsDest:["中文(简体)"],pageTrsPanelPos:"bottom-right",chatGPTPrompt:"",chatGPTEndpoint:"",chatGPTModel:"gpt-3.5-turbo"},g={chatGPTConversationInfo:null,hoverTranslate:!1,latestSource:"",pageTrsAuto:!1,pageTrsType:o.U.both,tipForShortKeyForPageTrsTypeClosed:!1,tipForFullTextClosed:!1,tipForDeepLLimitClosed:!1,user:null,optionsSyncAt:null,disabledNofiByBrowserUI:!1,favoritesSyncAt:null,historiesSyncAt:null,deeplKey:[],deeplPoints:f.VY,baiDuAppKey:[],bdPoints:c.Fi,bdProPoints:c.ZX,baiDuOCRKey:[],bdOcrPoints:u.$o,youDaoAppKey:[],ydPoints:s.eT,aLiApiKey:[],aliPoints:a.Kl,aliProPoints:a.YU,qqApiKey:[],qqPoints:d.xu,hsApiKey:[],hsPoints:p.p7,soGouApiKey:[],cyApiToken:[],cyPoints:l.HK,chatGPTKey:[],ocrLimit:{date:0,times:0},pdfLimit:{date:0,times:0},pageTranslateLimit:{date:0,times:0},sttLimit:{date:0,times:0},videoLimit:{date:0,times:0},panelTranslateLimit:{date:0,times:0},pdfZoom:"",noticesUnreadNum:0,noticesFiltered:[],tipForFirstExportClosed:!1,tipForPasteTranslateClosed:!1,tipForDropTranslateClosed:!1,tipForAddJumpTwoClosed:!0,tipForServicesUpdateClosed:!0,tipForGoogleTranslateClosed:!1,tipForSaveSourceSelectClosed:!0}},34054:(e,t,n)=>{var o=n(52779),r=n(53027),i=n(25130),s=n.n(i),a=(n(73439),n(77950),n(85940),n(52665)),l=n(68454);const c=['[data-testid="translator-source-input"]','[dl-test="translator-source-input"]'],u=['[data-testid="translator-source-clear-button"]','[dl-test="translator-source-clear-button"]'],d=['[data-testid="translator-source-lang-btn"]','[dl-test="translator-source-lang-btn"]'],p=d.map((e=>e+" .lmt__language_select__active__title")),f=['[data-testid="translator-source-lang-list"]','[dl-test="translator-source-lang-list"]'],m=['[data-testid="translator-target-lang-btn"]','[dl-test="translator-target-lang-btn"]'],g=(m.map((e=>e+" .lmt__language_select__active__title")),['[data-testid="translator-target-lang-list"]','[dl-test="translator-target-lang-list"]']),v=e=>[`[data-testid="translator-lang-option-${e}"]`,`[dl-test="translator-lang-option-${e}"]`],h='[data-testid="translator-target-input"]',y=[h+" + div ul button span:first-child",".lmt__translations_as_text .lmt__translations_as_text__item:not(:first-child) > button"],w=i("@hcfy/automation-deepl"),b={捷克语:"cs",乌克兰语:"uk",爱沙尼亚语:"et",拉脱维亚语:"lv",西班牙语:"es",保加利亚语:"bg",立陶宛语:"lt",希腊语:"el",波兰语:"pl",罗马尼亚语:"ro",匈牙利语:"hu",丹麦语:"da",葡萄牙语:"pt","葡萄牙语（巴西）":"pt",意大利语:"it",德语:"de",日语:"ja",印尼语:"id",俄语:"ru",瑞典语:"sv",英语:"en","英语（美式）":"en","英语（英式）":"en",法语:"fr",挪威语:"nb",中文:"zh","中文（简体）":"zh",芬兰语:"fi",斯洛伐克语:"sk",韩语:"ko",斯洛文尼亚语:"sl",荷兰语:"nl"};async function T(){var e;const t=null===(e=(await(0,l.$A)(p)).textContent)||void 0===e?void 0:e.replace("（自动检测）","").trim();return t&&function(e){return b[e]}(t)}async function P(){const e=await async function(){const e=(await(0,l.$A)(c)).lang.trim();if(!e)return;const t=e.indexOf("-");return t>0?e.slice(0,t):e}();return e||T()}async function C(e,t){w("语种类型：%s；语种值：%s",e,t);(await(0,l.$A)("source"===e?d:m,{message:`找不到切换 ${e} 语种的按钮。`})).click(),w("展开了语种选择列表");const n=await(0,l.$A)("source"===e?f:g,{message:`找不到 ${e} 的语种下拉框。`,timeout:15e3});(await(0,l.$A)(v(t),{context:n,message:`在 ${e} 语种选择下拉框中找不到语种 ${t} 的选项。`})).click(),w("点击了语种")}const A={en:"en-US",pt:"pt-PT"};n(15735),n(6886),n(71372),n(634);var L=n(30686),E=n(23059),S=n(18149);function k(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function _(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,O(e,t,"set"),n),n}function D(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,O(e,t,"get"))}function O(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var R=new WeakMap,F=new WeakMap;class K extends L.Z{constructor(){super(),x(this,R,{writable:!0,value:void 0}),x(this,F,{writable:!0,value:void 0}),k(this,"interval",void 0),this.interval=100}get running(){return null!=D(this,F)}start(){return this.running?(w("已经在轮询翻译结果了，忽略此次 start() 调用"),!1):(w("开始轮询翻译结果"),_(this,F,setInterval((()=>{const e=D(this,R),t=function(){const e=document.querySelector(h);if(!e)return;const t=(0,a.M_)(Array.from(e.querySelectorAll("p")).map((e=>e.innerText)).join("\n"));if(!t)return;const n=(0,l.cw)(y,{all:!0}),o=n?Array.from(n).map((e=>{var t;return(null===(t=e.textContent)||void 0===t?void 0:t.trim())||""})).filter(E):[];return w("检测到翻译结果变化了，调用 callback"),{result:t,otherResults:o}}();S(e,t)||(w("监测到翻译结果有变化"),_(this,R,t),t&&P().then((e=>{this.emit("result",{...t,from:e})})))}),this.interval)),!0)}stop(){this.running&&(w("停止轮询翻译结果"),clearInterval(D(this,F)),_(this,R,void 0),_(this,F,void 0))}}let $;async function B(e,t,n="auto"){var o;return await async function(){(await(0,l.$A)(c)).value&&(await(0,l.$A)(u)).click()}(),await(o=n,w("开始设置源语种为 %s",o),C("source",o)),await function(e){return w("开始设置目标语种为 %s",e),C("target",A[e]||e)}(t),await async function(e){w("开始填写待翻译的文本：%s",e);const t=await(0,l.$A)(c,{message:"找不到文本输入框。"});t.value=e;try{var n;const o=await(0,l.$A)('[role="textbox"]',{context:t,message:"找不到文本输入框里的文本输入 div。"});null!==(n=o.textContent)&&void 0!==n&&n.trim()||(w("没有正常写入 contenteditable div 中，将直接写入"),o.textContent=e)}catch(e){w("找不到 contenteditable div")}await(0,a._v)(0)}(e),new Promise(((e,t)=>{const n=($||($=new K),$);n.once("result",(t=>{n.stop(),e(t)})),n.start(),async function(){w("触发翻译事件"),(await(0,l.$A)(c,{message:"找不到文本输入框。"})).dispatchEvent(new Event("input"))}().catch(t)}))}n(25269),n(6710);var M=n(81321),N=n(74930),I=n(3613),G=n(30647),W=n(31620);const j=i("@hcfyapp/browser-automation/clients/iframe");let q;const z=s()("DeepLInAutomationTab");function U(){!function(e){if(!q)throw(0,G.KP)("需要先调用 isCreatedBy() 确认 iframe 是由 Pool 创建的。");q.addEventListener("message",(t=>{const n=(0,W.k)(t.data);if(!n)return;const o=(0,M.kW)(n);o&&"request"===o.type&&e(o.payload,(e=>{q.postMessage(JSON.stringify((0,M.rO)(o.id,e)))}))}))}(((e,t)=>{const n=e;z("收到背景页传过来的翻译任务：",n),B(n.text,n.destination,n.source).then((e=>{z("翻译结果：",e),t(e)}),(e=>{z("翻译时报错了：",e.message),t({__error__:{message:e.message}})}))})),new Promise(((e,t)=>{if(!q)return void t((0,G.KP)("需要先调用 isCreatedBy() 确认 iframe 是由 Pool 创建的。"));const n=N(),o=t=>{const r=(0,W.k)(t.data);if(!r)return;const i=(0,M.kW)(r);i&&"response"===i.type&&i.id===n&&(j("收到了背景页对 ready 消息的响应。"),q.removeEventListener("message",o),e(i.payload))};q.addEventListener("message",o),j("向背景页发送了 ready 消息。"),q.postMessage(JSON.stringify((0,M.hG)(n,I.m)))}))}r.j||new o.U,"https://www.deepl.com/translator"===window.location.href&&new Promise((e=>{if(!top||top===self)return void e(!1);const t=N(),{port1:n,port2:o}=new MessageChannel,r=o=>{const i=(0,W.k)(o.data);if(!i)return;const s=(0,M.kW)(i);s&&"response"===s.type&&s.id===t&&(j("收到了背景页对 is create by 消息的响应，结果为 %o。",s.payload),n.removeEventListener("message",r),q=n,e(s.payload))};n.addEventListener("message",r),n.start(),j("向背景页发送了 is create by 消息。"),top.postMessage(JSON.stringify((0,M.hG)(t,I._)),"*",[o])})).then((e=>{e?(z("当前 DeepL 网站由划词翻译创建，开始初始化"),U()):z("当前 DeepL 网站并非由划词翻译创建，所以不做任何处理")}))},32728:(e,t,n)=>{n.d(t,{n:()=>o});const o=[{value:"translate",label:"翻译这段文本"},{value:"open-link-in-viewer",label:"在划词翻译中打开此 PDF"},{value:"screen-translate",label:"截图翻译"},{value:"page-translate",label:"网页全文翻译"},{value:"video-translate",label:"音视频翻译"}].map((e=>e.value))},48194:(e,t,n)=>{n.d(t,{R:()=>l});n(15735),n(6886),n(14121),n(60523),n(43673),n(40753),n(28399),n(39529);var o=n(1327),r=n(40448),i=n(21591),s=n(69548);const a={401:"登录状态已失效，请重新登录。"};function l(e){if(o.Z.isAxiosError(e)){const t=function(e={}){var t;const{url:n,baseURL:o}=e;let r;try{r=new URL(n||"",o)}catch(e){return"远程服务器"}const{host:i}=r;return null!==(t="https://hs-api.limingkai.cn/")&&t.includes(i)?"划词翻译服务器":"远程服务器"}(e.config),n="划词翻译服务器"===t;if(e.response){const o=e.response.status;return new r.m(n?a[o]||`划词翻译服务器内部产生了一个错误，请稍后重试。HTTP 响应码：${o}。`:`${t}返回了错误的 HTTP 响应码：${o}。`,{type:i.c.API_SERVER_ERROR})}return e.request?new r.m(`${t}没有响应。`,{type:i.c.NETWORK_ERROR,link:{name:"查看解决方案",url:"划词翻译服务器"===t?"https://hcfy.app/docs/faqs/server-no-response":"https://hcfy.app/docs/faqs/why-services-always-loading"}}):new r.m(`向${t}发起请求时发生了一个错误：“${e.message}”`,{type:null})}return(0,s.D)(e)}},64643:(e,t,n)=>{n(74584)}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=t,e=[],o.O=(t,n,r,i)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,r,i]=e[u],a=!0,l=0;l<n.length;l++)(!1&i||s>=i)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(a=!1,i<s&&(s=i));if(a){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,r,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={537:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[s,a,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(l)var u=l(o)}for(t&&t(n);c<s.length;c++)i=s[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(u)},n=self.webpackChunkbrowser_extension=self.webpackChunkbrowser_extension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=o.O(void 0,[917,251,805,361,426,523,204,68],(()=>o(34054)));r=o.O(r)})();