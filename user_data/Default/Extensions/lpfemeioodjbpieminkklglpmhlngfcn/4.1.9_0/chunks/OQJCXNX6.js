import{a as j}from"./OCQN6AQK.js";import{a as L,d as Y}from"./3IHGIM7R.js";import{K,U as Q,W as J,ba as Te,m as b,n as X,r as $}from"./MM2G4TVT.js";import{n as x,na as F,za as Z}from"./I77YJK47.js";import{a as _}from"./SZ3C6HJE.js";import{e as H,k as S}from"./EWET23YO.js";import{n as z}from"./WUMYY75E.js";import{a as O}from"./USLLVG5P.js";import{f as d}from"./UTGLRY7A.js";var we="Public";var _e=["Favorites","Own"],Ce="MaxAI.me",ge=z,Se=["#5D5FEF","#FF6154","#008000","#FFA500"];var ee="WEBCHATGPT_PROMPT_APP_SHADOW_ROOT",Ie="WEBCHATGPT_PROMPT_APP_WRAPPER",te="WEBCHATGPT_PROMPT_RUNNER_SHADOW_ROOT",Ae="WEBCHATGPT_PROMPT_RUNNER_WRAPPER",Oe={Favorites:"webchatgpt-favorites",Own:"webchatgpt-own",Public:"webchatgpt-public"},Le=[{name:"Live Crawling Target URL",hint:"Enter the URL you wish to extract text from",type:"livecrawling",isSystemVariable:!0},{name:"Live Crawling Crawled Text",hint:"This variable will be automatically updated with text extracted from the target URL",type:"livecrawling",isSystemVariable:!0},{name:"Web Search Query",hint:"Enter your search term",type:"websearch",isSystemVariable:!0},{name:"Web Search Results",hint:"This variable will be automatically updated with the search results",type:"websearch",isSystemVariable:!0},{name:"System Current Date",hint:"This variable will be automatically updated with the current date",type:"system",isSystemVariable:!0}],xe={livecrawling:"Live Crawling",websearch:"Web Search",system:"System",text:"Text"};var oe={PromptApp:ee,PromptRunner:te,WebAccessToolbar:"wcg-toolbar",GlobalSnackbar:"webchatgpt-snackbar"};function re(t){return t&&oe[t]&&document.querySelector(`#${oe[t]}`)?.shadowRoot?.querySelector("div:first-of-type")||document.body}function Ue(t){for(let e of t){let r=document.querySelector(e);if(r)return r}}var We=t=>{let{containerId:e,presetContainerElement:r,shadowContainerId:i,presetShadowContainerElement:p,webComponent:R=!0}=t,u="customElements"in window,c=document.createElement(u&&R?`webchatgpt-custom-element-${O()}`:"div");e&&(c.id=e),r&&r(c);let f=c.attachShadow({mode:"open"}),l=document.createElement("style");e&&(l.id=`${e}-emotion-style`);let a=document.createElement("div");return i&&(a.id=i),p&&p(a),f.appendChild(l),f.appendChild(a),{container:c,shadowContainer:a,emotionRoot:l}};function ke(t,e){e.parentNode.insertBefore(t,e.nextSibling)}function ne(t,e){return document.querySelector(`#${t}`)?.shadowRoot?.querySelector(e)}function Be(){return document.querySelectorAll("div[data-testid^=conversation-turn-]")}var n=d(_());var V=d(_()),E=d(x()),Re=t=>{let{src:e,alt:r,width:i,height:p,skeletonHeight:R}=t,[u,c]=V.default.useState(!1),[,f]=V.default.useState(!1);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("img",{src:e,alt:r,width:u?i:0,height:u?p:0,onLoad:()=>{c(!0)},onError:()=>{c(!0),f(!0)}}),!u&&(0,E.jsx)(Q,{variant:"rounded",height:R||p,width:i||"100%"})]})},ie=Re;var se=d(_());var ae=t=>(0,se.useMemo)(()=>{let e=Y(t);return{title:e.title,description:e.description,ctaButtonText:e.ctaButtonText,ctaButtonLink:e.ctaButtonLink,ctaButtonOnClick:e.ctaButtonOnClick,imageUrl:e.imageUrl,videoUrl:e.videoUrl,sceneType:t}},[t]);var h=d(_());var C=d(_());function ye(t){let e=(0,C.useRef)(),r=(0,C.useRef)(!1),i=(0,C.useRef)(!1);r.current&&(i.current=!0),(0,C.useEffect)(()=>{if(!r.current)return r.current=!0,e.current=t(),()=>{i.current&&e.current&&e.current()}},[])}var pe=ye;var ce=d(_()),le=t=>{(0,ce.useEffect)(()=>{let e=()=>{t()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[])};var me=(t=!0)=>{let[e,r]=(0,h.useState)(null),[i,p]=(0,h.useState)(!1),[R,u]=(0,h.useState)(!1);pe(()=>{u(!0),H().then(l=>{l&&r(l),p(!0),u(!1)}).catch(()=>{p(!0),u(!1)})}),le(()=>{t&&H().then(l=>{r(l)})});let c=(0,h.useMemo)(()=>!!e,[e]),f=(0,h.useMemo)(()=>e?S(e):"free",[e]);return{isLogin:c,userInfo:e,loaded:i,loading:R,currentUserPlan:f}};var s=d(x()),ue="MAXAI_PERMISSION_WRAPPER_TOGGLE_EVENT",M="MAXAI_PERMISSION_WRAPPER_CUSTOM_EVENT";var Ee=t=>{let{sceneType:e,allowedRoles:r,mountContainerName:i,onPermission:p,BoxProps:R,TooltipProps:u,children:c,id:f,preAuth:l}=t,a=ae(e),[v,G]=(0,n.useState)(void 0),m=(0,n.useMemo)(()=>v||a,[a,v]),{currentUserPlan:I,userInfo:U,isLogin:W}=me(),[de,w]=(0,n.useState)(!1),A=(0,n.useRef)(f??O());(0,n.useEffect)(()=>{let o=T=>{T.detail.id!==A.current&&w(T.detail.open)};return window.addEventListener(M,o),()=>{window.removeEventListener(M,o)}},[]),(0,n.useEffect)(()=>{let o=T=>{T.detail.id===A.current&&w(T.detail.open)};return window.addEventListener(ue,o),()=>{window.removeEventListener(ue,o)}},[]);let Pe=(0,n.useMemo)(()=>!!r.find(o=>o===I),[I,r]),q=(0,n.useCallback)(async()=>{if(U&&W)return S(U);if(!W&&l){let o=await l();if(o)return S(o)}return null},[W,l,U]),fe=(0,n.useMemo)(()=>i?Array.isArray(i)?ne(i[0],i[1]):re(i):document.body,[i]);return Pe?(0,s.jsx)(s.Fragment,{children:c}):(0,s.jsx)(J,{arrow:!0,open:de,PopperProps:{container:fe,sx:{"& > div":{maxWidth:320,p:1}}},title:(0,s.jsx)($.default,{mouseEvent:"onMouseDown",onClickAway:()=>{w(!1)},children:(0,s.jsxs)(Z,{spacing:1,component:"div",onClick:o=>{o.stopPropagation()},children:[m.videoUrl&&(0,s.jsx)(j,{borderRadius:4,youtubeLink:m.videoUrl}),m.imageUrl&&(0,s.jsx)(b,{sx:{width:"100%",height:"auto",borderRadius:"4px",overflow:"hidden","& img":{width:"100%",height:"auto"}},children:(0,s.jsx)(ie,{height:140,src:m.imageUrl,alt:`${m.title} img`})}),(0,s.jsx)(F,{variant:"custom",fontSize:"16px",fontWeight:600,textAlign:"left",color:"rgba(255,255,255,.87)",children:m.title}),(0,s.jsx)(F,{variant:"custom",fontSize:"14px",fontWeight:400,textAlign:"left",color:"rgba(255,255,255,.87)",children:m.description}),m.ctaButtonText&&(0,s.jsx)(K,{target:"_blank",href:m.ctaButtonLink,onClick:o=>{o.preventDefault(),window.open(m.ctaButtonLink,"_blank"),m.ctaButtonOnClick?.(o),w(!1),L("click",a.sceneType)},children:(0,s.jsx)(X,{fullWidth:!0,variant:"contained",children:m.ctaButtonText})})]})}),...u,children:(0,s.jsx)(b,{...R,children:(0,s.jsx)(b,{children:n.default.Children.map(c,o=>{if(n.default.isValidElement(o)){let T={...o.props,...o.props.onClick&&{onClick:async(P,...g)=>{let y=!1;P?.stopPropagation?.(),P?.preventDefault?.();let k=await q();if(p){let{success:N,cardSettings:D}=await p(k||I,a,[P,...g]);G({...a,...D}),y=N}let B=new CustomEvent(M,{detail:{id:A.current,open:!1}});window.dispatchEvent(B),w(!y),y?o.props?.onClick?.(P,...g):L("show",a.sceneType)}},...o.props.onChange&&{onChange:async(P,...g)=>{let y=!1;P?.stopPropagation?.(),P?.preventDefault?.();let k=await q();if(p){let{success:N,cardSettings:D}=await p(k||I,a,[P,...g]);G({...a,...D}),y=N}let B=new CustomEvent(M,{detail:{id:A.current,open:!1}});window.dispatchEvent(B),w(!y),y?o.props?.onChange?.(P,...g):L("show",a.sceneType)}}};return n.default.cloneElement(o,T)}return o})})})})},Pt=Ee;export{pe as a,me as b,we as c,_e as d,Ce as e,ge as f,Se as g,ee as h,Ie as i,te as j,Ae as k,Oe as l,Le as m,xe as n,Ue as o,We as p,ke as q,Be as r,Pt as s};
